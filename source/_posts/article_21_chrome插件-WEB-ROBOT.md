---
title: chrome插件 web_robot
catalog: true
date: 2020-06-09 19:31:43
subtitle: web_robot最新版教程
tags:
    - CHROME插件
    - 自动化
---

## 前言

-   2020-08-23 暂停频繁的更新，等待新的 idea 出现

这边是 web_robot 持续更新教程，

对于基本的安装，导入，基础使用，请参照[V1.0 版本教程](/article/article_18_chrome插件-网页自动化/)

对于 V1.0 版本以外的功能这边都会做提醒与说明,目前版本 1.8.2

![插件图](/img/mypost/robot_pic.jpg)

## 先看演示

### 演示流程事务

![演示1](/img/mypost/robot_demo1.gif)

### 演示源码事务

![演示2](/img/mypost/robot_demo2.gif)

### 演示受控事务

![演示3](/img/mypost/robot_demo3.gif)

## 事务模式

新建事务的时候可以选择三种事务

-   流程事务
-   源码事务
-   受控事务

### 流程事务

之前 V1.0 做的就是流程事务，使用 dom 元素定义一个事件流程然后按流程执行。

#### 定义事件

一个流程事务会包含很多事件，每个事件由 dom 元素，动作，延时等组成。

定义事件目前可以选择两种方式，

一种是在插件中进行，

这边包含两种筛选器，自由筛选器(V1.4.0)和标签筛选器

筛选元素时可以自动对页面元素进行定位(V1.3.1)
![robot](/img/mypost/robot_event.jpg)
![robot](/img/mypost/robot2.jpg)

点进一个事务里，选择页面添加  
然后在页面里点击任意位置，就会获取到 dom 节点并在右上角产生以下配置
(1.8.0) 支持可视化圈选定义事件
![robot](/img/mypost/keshihuaquanxuan.gif)

(1.7.1) 支持页面直接录制事件，支持点击事件和英文设值事件。

动作目前可选择的有

-   点击（click）
-   设值（value）
-   刷新（refresh）
-   当页跳转（pagejump）
-   取值 (getvalue) (v1.7.0)
-   鼠标移入 (mouseover) (v1.6.3)

设值支持参数配置(v1.4.0)，可以填写\${参数}，  
这样在运行事务的时候就会出现需要填写对应的参数

#### 运行事务

他包括以下四种运行模式

-   运行
-   轮播
-   受控运行
-   定时运行

运行采用将事件发送到浏览器后台，浏览器后台与当前页面交互运行，使用浏览器事件还原配置的流程事件

轮播采用在插件页面直接与当前打开的浏览器页面交互运行，运行完一次后立即进行下一次。

受控运行(V1.2)运行与本地客户端中，插件将事件发送到浏览器后台，浏览器后台运行每个事件发送到本地客户端，客户端使用键盘鼠标还原事件。

定时运行(V1.6.0)支持两种模式，定时运行需要浏览器在前台，且打开关注一个空白页。

-   15:00 按每天的 15:00 运行
-   10m 每 10 分钟运行一次

### 源码事务

源码事务是 V1.1 版本加的，功能为使用源码自行定义注入。

源码只支持直接运行。由插件将代码注入到页面。

![robot](/img/mypost/robot3.jpg)

### 受控事务

受控事务为 V1.3 版本加的，功能为使用本地客户端服务监听鼠标键盘事件，然后还原鼠标键盘事件。

受控事务可以配置一个受控地址

在进行录制操作的时候回新开 tab 打开受控地址，然后录制操作，按 ESC 结束录制

受控运行受控事务的时候同样也会打开受控地址，然后会还原刚刚录制的操作。

![robot](/img/mypost/robot4.jpg)

## 本地客户端的开启

**目前只在 mac 上做了配置，其他环境暂不知**

首选本地需要有 python3 环境，获取虚拟环境

py 文件下有需要的包文件 requirements.txt  
下载包

> pip install -r py/requirements.txt

开启 pythonweb

> python py/web.py

看到监听 12580 端口即开启成功。

所有受控运行，受控事务都需要依赖本地客户端的开启
