{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/img/icon_wechat.png","path":"img/icon_wechat.png","modified":0,"renderable":0},{"_id":"source/img/article/tag.png","path":"img/article/tag.png","modified":0,"renderable":0},{"_id":"source/img/avatar/avatar.jpg","path":"img/avatar/avatar.jpg","modified":0,"renderable":0},{"_id":"source/img/mypost/github.png","path":"img/mypost/github.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","path":"fonts/glyphicons-halflings-regular.eot","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","path":"fonts/glyphicons-halflings-regular.ttf","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","path":"fonts/glyphicons-halflings-regular.woff","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/archive.styl","path":"css/archive.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","path":"fonts/glyphicons-halflings-regular.woff2","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.css","path":"css/beantech.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.min.css","path":"css/beantech.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/donate.css","path":"css/donate.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/highlight.styl","path":"css/highlight.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","path":"css/hux-blog.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/rocket.styl","path":"css/rocket.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/signature.styl","path":"css/signature.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/toc.styl","path":"css/toc.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/widget.styl","path":"css/widget.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.js","path":"js/hux-blog.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","path":"js/hux-blog.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.nav.js","path":"js/jquery.nav.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","path":"js/jquery.tagcloud.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/toc.js","path":"js/toc.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/smoothscroll.js","path":"js/smoothscroll.js","modified":0,"renderable":1},{"_id":"source/img/header_img/tag.jpg","path":"img/header_img/tag.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","path":"fonts/glyphicons-halflings-regular.svg","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.js","path":"js/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"source/img/header_img/archives-widget.jpg","path":"img/header_img/archives-widget.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/images/rocket.png","path":"css/images/rocket.png","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/images/ironman.png","path":"css/images/ironman.png","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/bootstrap.css","path":"css/bootstrap.css","modified":0,"renderable":1},{"_id":"source/img/signature/BeanTechSign-white.png","path":"img/signature/BeanTechSign-white.png","modified":0,"renderable":0},{"_id":"source/img/avatar/ironman.png","path":"img/avatar/ironman.png","modified":0,"renderable":0},{"_id":"source/img/header_img/archive.jpg","path":"img/header_img/archive.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/home3.jpg","path":"img/header_img/home3.jpg","modified":0,"renderable":0},{"_id":"source/img/signature/BeanTechSign-black.png","path":"img/signature/BeanTechSign-black.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/js/jquery.js","path":"js/jquery.js","modified":0,"renderable":1},{"_id":"source/img/article_header/article_bg.jpg","path":"img/article_header/article_bg.jpg","modified":0,"renderable":0},{"_id":"source/img/article_header/header.jpg","path":"img/article_header/header.jpg","modified":0,"renderable":0},{"_id":"source/img/mypost/pynput.png","path":"img/mypost/pynput.png","modified":0,"renderable":0},{"_id":"source/img/header_img/tag.jpg.bak","path":"img/header_img/tag.jpg.bak","modified":0,"renderable":0},{"_id":"source/img/header_img/about.jpg","path":"img/header_img/about.jpg","modified":0,"renderable":0},{"_id":"source/img/article/huweihuang_blog.png","path":"img/article/huweihuang_blog.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home.jpg","path":"img/header_img/home.jpg","modified":0,"renderable":0},{"_id":"source/img/blog.jpg","path":"img/blog.jpg","modified":0,"renderable":0},{"_id":"source/img/article_header/article_header.png","path":"img/article_header/article_header.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home-bg-o.png","path":"img/header_img/home-bg-o.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home2.png","path":"img/header_img/home2.png","modified":0,"renderable":0},{"_id":"source/img/header_img/404.png","path":"img/header_img/404.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/.DS_Store","hash":"3f17174b6a74b1a2ad9f447ca505d758111cc36b","modified":1573717388607},{"_id":"source/CNAME","hash":"99afd3824e1a9ec198a413feae6c0def72f2d7e1","modified":1573709476643},{"_id":"source/404.md","hash":"8aa56af7bcd7cd23667cbf3eb5b5c9fa4533eb60","modified":1565959414000},{"_id":"themes/huweihuang/LICENSE","hash":"2b209f06bebeb2a8c2b7e187e436f3e1e1fbc8a7","modified":1565959414000},{"_id":"themes/huweihuang/_config.yml","hash":"e800e32847df32dacddb5202823a004557023bcd","modified":1565959414000},{"_id":"source/_posts/hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†.md","hash":"cd3c0e88b72964d35ab74575daf2cfd79a9946ae","modified":1585725985113},{"_id":"source/_posts/hiveserver2ä¸hiveSQLçš„æ‰§è¡Œ.md","hash":"63831effcabd6ed71fcfc1c62e5732c6ed03624f","modified":1585725982559},{"_id":"source/_posts/hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†.md","hash":"58073f4b42a648313e837b047ccb4bceef0e653d","modified":1586243885660},{"_id":"source/_posts/å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•.md","hash":"a8bc0f54d74dfecb9b54810fe4dc81ac80e16acc","modified":1585725959031},{"_id":"source/_posts/pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„ç›‘æ§ä¸è¿˜åŸ.md","hash":"49e6504f5a24f96edfe8cf3a6ac3d41bad01adbd","modified":1585803102290},{"_id":"source/_posts/åˆåŒå’å•å»ºåšå®¢.md","hash":"4c128c54d95256925372cfd3ee313ec4d170c2a9","modified":1585642545996},{"_id":"source/_posts/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-å…ƒæ•°æ®.md","hash":"85358d4078c08fe586abd9f09012a61db18061b3","modified":1585725970393},{"_id":"source/_posts/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-æ ¼å¼åŒ–.md","hash":"aebbb2d89bf4c5d8dcec99745fe57320e8b1a6ae","modified":1585725967227},{"_id":"source/_posts/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜.md","hash":"2b1a6de03c7f0d3bfb90776a59b6a05ab6d861a7","modified":1585725964274},{"_id":"source/_posts/åŸºäºantlr4å®ç°ä¸€ä¸ªè®¡ç®—å™¨.md","hash":"f1f62ba01c2c7811e62fef4285d183e136027dbd","modified":1585725961832},{"_id":"source/_posts/æ•´ç†æ™’æ™’è€åšå®¢.md","hash":"01b08e82243e81fd52eb5e0a82783f069a23ef41","modified":1585741886553},{"_id":"source/_posts/è®²è®²å…ƒæ•°æ®.md","hash":"2b0e73f614d68ca465f8ff3384fce80edf5b1050","modified":1585726384580},{"_id":"source/_posts/æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²-mac.md","hash":"25ef1abe015b028c66b571e379598b6e3b7c2126","modified":1585725955982},{"_id":"source/about/index.md","hash":"3d4cb0e6fa546c8b28fe1f176b4f59d410d90cb6","modified":1586251479017},{"_id":"source/archive/index.md","hash":"a93b0e38ac60cbbfd12998a14ffa5823f819cb52","modified":1573635762204},{"_id":"source/img/.DS_Store","hash":"f28952ddb98ce569ee5843bd5a50c36b59377648","modified":1573718348137},{"_id":"source/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1565959414000},{"_id":"source/tags/index.md","hash":"1f824dd5e3b3155cc5a7f2ce551c2e90c20bc46d","modified":1573436999687},{"_id":"themes/huweihuang/languages_to_be_added/de.yml","hash":"424a9c1e6ab69334d7873f6574da02ca960aa572","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/default.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/no.yml","hash":"8ca475a3b4f8efe6603030f0013aae39668230e1","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/en.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/es.yml","hash":"cb4eeca0ed3768a77e0cd216300f2b2549628b1b","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/pl.yml","hash":"de7eb5850ae65ba7638e907c805fea90617a988c","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/ru.yml","hash":"42df7afeb7a35dc46d272b7f4fb880a9d9ebcaa5","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/zh-CN.yml","hash":"7bfcb0b8e97d7e5edcfca8ab26d55d9da2573c1c","modified":1565959414000},{"_id":"themes/huweihuang/layout/404.ejs","hash":"40de38bd399f6f4aef0d6c63c7b13b02d74f1c56","modified":1565959414000},{"_id":"themes/huweihuang/languages_to_be_added/zh-TW.yml","hash":"9acac6cc4f8002c3fa53ff69fb8cf66c915bd016","modified":1565959414000},{"_id":"themes/huweihuang/layout/about.ejs","hash":"edcf8fa3bf7093c974d418ffef42ac89c19af128","modified":1573711106220},{"_id":"themes/huweihuang/layout/archive.ejs","hash":"c15726ab348cbf75291b88ffe5e5e50335b5cb0b","modified":1565959414000},{"_id":"themes/huweihuang/layout/index.ejs","hash":"e03f19ebc0164ecd657789edfccba707e8facc04","modified":1585724776686},{"_id":"themes/huweihuang/layout/keynote.ejs","hash":"f5689862281e34dbe8402b0e72f632902e53e88b","modified":1565959414000},{"_id":"themes/huweihuang/layout/layout.ejs","hash":"a5af5b99ac3456ab5da1a319455904b979b91601","modified":1565959414000},{"_id":"themes/huweihuang/layout/post.ejs","hash":"1e29985632a33883a8bcaef940cba224c70a16af","modified":1573782383618},{"_id":"themes/huweihuang/layout/page.ejs","hash":"292e18597c1b3d2fed080ac44e89ab93b56d1506","modified":1573712463698},{"_id":"themes/huweihuang/layout/tags.ejs","hash":"2c72eb2e89130658aa068d80d27b561b509c5dcd","modified":1565959414000},{"_id":"source/img/article/tag.png","hash":"c8632d64d9471009098b84f70273e63037a4e7b8","modified":1565959414000},{"_id":"source/img/article_header/.DS_Store","hash":"bebd7116aad19ba812b7e4793b3741b01d8bc826","modified":1573718348132},{"_id":"source/img/avatar/avatar.jpg","hash":"9b687fd63a0c1c74cde3d1b3128ca9f1a7b93541","modified":1573434816161},{"_id":"source/img/header_img/.DS_Store","hash":"89b6f04ed69798ff277621a0a7e83e62b5b77a26","modified":1573718348134},{"_id":"source/img/mypost/github.png","hash":"8a5c8b401c15bd52f2d5f85db35bb047904f581a","modified":1573643651388},{"_id":"themes/huweihuang/layout/_widget/friends-blog.ejs","hash":"734d3775017aedac185028924baf890a71a74548","modified":1565959414000},{"_id":"themes/huweihuang/layout/_widget/recent-posts.ejs","hash":"e08ab8ba60e31638006acf27f066b989a0a3c433","modified":1565959414000},{"_id":"themes/huweihuang/layout/_widget/archive.ejs","hash":"7594929d472806ca4c64d9906d9903a96de111a0","modified":1565959414000},{"_id":"themes/huweihuang/layout/_widget/category.ejs","hash":"1cf485def07dc06e870dc9613767c6c614bcf428","modified":1565959414000},{"_id":"themes/huweihuang/layout/_widget/featured-tags.ejs","hash":"0c9ce1942f1943dc8891a9302a922ef1ffe300c5","modified":1565959414000},{"_id":"themes/huweihuang/layout/_widget/short-about.ejs","hash":"315de02246f07c747c32495e107ad7b19cb3ff54","modified":1565959414000},{"_id":"themes/huweihuang/layout/_partial/head.ejs","hash":"720349195a5ea7b610a82ce3ce74298fb2bc7347","modified":1565959414000},{"_id":"themes/huweihuang/layout/_partial/footer.ejs","hash":"c065b8e3b48e55735be15b61ab99457e9b54fa90","modified":1573696613185},{"_id":"themes/huweihuang/layout/_partial/nav.ejs","hash":"4c905166c960852e9b9a3c9d5c680091e37b481f","modified":1565959414000},{"_id":"themes/huweihuang/layout/_partial/pagination.ejs","hash":"557d6bb069a1d48af49ae912994653f44b32a570","modified":1565959414000},{"_id":"themes/huweihuang/layout/_partial/header.ejs","hash":"460729508dbf2f7a9ab101e7cb0a5541a3ec043a","modified":1573697728848},{"_id":"themes/huweihuang/layout/_partial/toc.ejs","hash":"40e11b303df113c64a5ca35b79dd53c824010c09","modified":1565959414000},{"_id":"themes/huweihuang/layout/_partial/sidebar.ejs","hash":"2e4e528a555917b2a267da4db2440bcc4a7a65ab","modified":1565959414000},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1565959414000},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1565959414000},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1565959414000},{"_id":"themes/huweihuang/source/css/archive.styl","hash":"715bcbd085eb95ec26c9805c11c374919cde971c","modified":1565959414000},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1565959414000},{"_id":"themes/huweihuang/source/css/beantech.css","hash":"6b86d52f8448542cbcb2c118ec9084359f2f5ee8","modified":1585642430532},{"_id":"themes/huweihuang/source/css/beantech.min.css","hash":"d6b6442f9ea4765c1d6caa208235f5d7bc742722","modified":1585642430534},{"_id":"themes/huweihuang/source/css/donate.css","hash":"f65ac8363d8d215adb896158e7b45165db259a47","modified":1565959414000},{"_id":"themes/huweihuang/source/css/highlight.styl","hash":"e842080e6d580f0f70a7df71fbde3c4e49463c19","modified":1565959414000},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1565959414000},{"_id":"themes/huweihuang/source/css/rocket.styl","hash":"e15c51c8566ecd943112e57592888dd318b6fa6a","modified":1565959414000},{"_id":"themes/huweihuang/source/css/signature.styl","hash":"88159b31c59d59c01a0b534af57242662a2a3969","modified":1565959414000},{"_id":"themes/huweihuang/source/css/toc.styl","hash":"631e97f634d30f53314e2fec8bdde267c1c49f4c","modified":1565959414000},{"_id":"themes/huweihuang/source/css/widget.styl","hash":"7a9f735f5ef323dc2950fbd9d76daa16c9a0f1a9","modified":1565959414000},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1565959414000},{"_id":"themes/huweihuang/source/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1565959414000},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1565959414000},{"_id":"themes/huweihuang/source/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1565959414000},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1565959414000},{"_id":"themes/huweihuang/source/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1565959414000},{"_id":"themes/huweihuang/source/js/toc.js","hash":"41e52551731854224c249d53010c1bae5aa92ffa","modified":1565959414000},{"_id":"themes/huweihuang/source/js/smoothscroll.js","hash":"f3f61028516fd9ec3fec3b2a284253e711bb360a","modified":1573782787786},{"_id":"source/img/header_img/tag.jpg","hash":"8f5e8d39b7307bcf10fa3a7c2d71c1f4a66e0d71","modified":1573717140265},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1565959414000},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1565959414000},{"_id":"themes/huweihuang/source/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1565959414000},{"_id":"themes/huweihuang/source/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1565959414000},{"_id":"source/img/header_img/archives-widget.jpg","hash":"68f7d525269a94287e0ad18713ae232fb59dcf71","modified":1565959414000},{"_id":"themes/huweihuang/source/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1565959414000},{"_id":"themes/huweihuang/source/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1565959414000},{"_id":"themes/huweihuang/source/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1565959414000},{"_id":"source/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1565959414000},{"_id":"source/img/avatar/ironman.png","hash":"7d6a06b4b544ab146c3b3e8474edc33f14ac6e4d","modified":1565959414000},{"_id":"source/img/header_img/archive.jpg","hash":"66d9f5a44f8b7e95ce9c3f63579e8deb801de29f","modified":1573717157628},{"_id":"source/img/header_img/home3.jpg","hash":"8676ac460c6b7eb2b1513c157edd4e3d6c94eaa3","modified":1573717094913},{"_id":"source/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1565959414000},{"_id":"themes/huweihuang/source/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1565959414000},{"_id":"source/img/article_header/article_bg.jpg","hash":"6af63305c923899017e727b5ca968a2703bc08cf","modified":1565959414000},{"_id":"source/img/article_header/header.jpg","hash":"8488dc1d7055d8e7107be5cda42a5977812275fc","modified":1573717414429},{"_id":"source/img/mypost/pynput.png","hash":"2396def9b254d14bf21d04f7e7ed5ea935d69f67","modified":1584367195000},{"_id":"source/img/header_img/tag.jpg.bak","hash":"c2680f6d36f0ba1fcbf96a13a0a0516c6f9bd14b","modified":1573717129072},{"_id":"source/img/header_img/about.jpg","hash":"da78b9f1e92f03a4cb27f8a6c89b18ccffe59777","modified":1573716891230},{"_id":"source/img/article/huweihuang_blog.png","hash":"392cf8b33be6c752dd908e027fa3346a6ecd58ab","modified":1565959414000},{"_id":"source/img/header_img/home.jpg","hash":"8f1c440427a4aa86b623503a926c027e2e10cd66","modified":1565959414000},{"_id":"source/img/blog.jpg","hash":"a76af0b98dbe92ca2d21babcef13f094e409554b","modified":1565959414000},{"_id":"source/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1565959414000},{"_id":"source/img/header_img/home-bg-o.png","hash":"134ece4cb4c49c7ca1403a5afe7f46d0e2f9ecbb","modified":1565959414000},{"_id":"source/img/header_img/home2.png","hash":"da6a3d5ca787bdc25e69655abd879b4f821aeb30","modified":1565959414000},{"_id":"source/img/header_img/404.png","hash":"6bf9c224543ec54e250309db89cbdf46e0c4b5ba","modified":1565959414000},{"_id":"public/baidusitemap.xml","hash":"8fa49a9deaff976d54f4e1b9c9f45ae3c8219609","modified":1586251652738},{"_id":"public/post-sitemap.xml","hash":"a329c2f83274712b71367234fe44fe20662d64ee","modified":1586251652737},{"_id":"public/page-sitemap.xml","hash":"937dc8e02aab2e08a05e7d89363872b84506c905","modified":1586251652567},{"_id":"public/tag-sitemap.xml","hash":"fa0b4810ccb4dcb9fc533157974d99edcc28f987","modified":1586251652568},{"_id":"public/sitemap.xsl","hash":"4321fa69dc1b8811d32b7a1478e5603e038cea1a","modified":1586178005879},{"_id":"public/sitemap.xml","hash":"cea6ee180d6ba68160c5d57ccc53f82836921530","modified":1586251652568},{"_id":"public/404.html","hash":"dcae76cfc3eaa05f85ca7d8158f153cf164197ae","modified":1586178005895},{"_id":"public/tags/index.html","hash":"7ef71ca1bd64dc85a8f8b0ae17abad8842c9a6eb","modified":1586251652950},{"_id":"public/article/hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†/index.html","hash":"a6e19fcda2c29a3bc89b1689152d4bf2e4382b2e","modified":1586251652963},{"_id":"public/article/pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„ç›‘æ§ä¸è¿˜åŸ/index.html","hash":"fb75625ae0dcdc0ead8ae242ca7c73a55a65faef","modified":1586178005895},{"_id":"public/article/è®²è®²å…ƒæ•°æ®/index.html","hash":"247bb7ce0e45874e9bfa6765f9293cb5fc121fe5","modified":1586178005895},{"_id":"public/article/æ•´ç†æ™’æ™’è€åšå®¢/index.html","hash":"53f04c49541c8fcddd7d60fdc9847e671d11fb58","modified":1586178005895},{"_id":"public/article/åˆåŒå’å•å»ºåšå®¢/index.html","hash":"acd2d9acee1c6922156490a906e224341993bde8","modified":1586178005896},{"_id":"public/article/å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•/index.html","hash":"b6ba97270ab0b779f69694436f519c9fd47739de","modified":1586178005896},{"_id":"public/article/hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†/index.html","hash":"60296b1170979a7f7896249d5638724adf16ec2e","modified":1586251652950},{"_id":"public/article/hiveserver2ä¸hiveSQLçš„æ‰§è¡Œ/index.html","hash":"ed80c45f185b7dd388bd85930dac8979ea6153cd","modified":1586178005896},{"_id":"public/article/æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²-mac/index.html","hash":"350b941bc7a79a25d10dffb615628dfc4bfe69d1","modified":1586251652963},{"_id":"public/article/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜/index.html","hash":"0393c13e223b9398b78621b926241edb85f20f56","modified":1586178005896},{"_id":"public/article/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-æ ¼å¼åŒ–/index.html","hash":"a6767c647d1d646e5a24991daa053e7b4d123ac7","modified":1586178005896},{"_id":"public/article/åŸºäºantlr4å®ç°hiveSQLçš„è§£æ-å…ƒæ•°æ®/index.html","hash":"4e501e76045d43678f0bfeae76e4dd753a21e736","modified":1586178005896},{"_id":"public/article/åŸºäºantlr4å®ç°ä¸€ä¸ªè®¡ç®—å™¨/index.html","hash":"91e64a8c55f061679b53627a0d3e0a3ccf819057","modified":1586178005896},{"_id":"public/about/index.html","hash":"4d34221befec959f59f469c0b85c38e804012a25","modified":1586251652967},{"_id":"public/archive/index.html","hash":"c59540b25ba2ca9209a25c81ba82d53ab1491abc","modified":1586251652967},{"_id":"public/index.html","hash":"a63055ec502e168c16f805488258b355a805fcfe","modified":1586251652968},{"_id":"public/page/2/index.html","hash":"c36c4344cd6be82b99c92f98e969adcf7677182b","modified":1586251652968},{"_id":"public/archives/index.html","hash":"9f436a3ce662e2e70108bd2c14891d611049aa12","modified":1586251652968},{"_id":"public/archives/archives/2/index.html","hash":"21eea525f9ef27219526fc2ba007d704f8005f7a","modified":1586251652968},{"_id":"public/archives/2000/index.html","hash":"c961aa9eb69badff85f15a1ee638a83deb10635a","modified":1586251652969},{"_id":"public/archives/2000/03/index.html","hash":"ca6c74bf598a3f62e3d639d3b1f1984174550fb1","modified":1586251652968},{"_id":"public/archives/2019/index.html","hash":"5e041a776dddb38417618e818fc40a999ab1b9a2","modified":1586251652968},{"_id":"public/archives/2019/11/index.html","hash":"0959d40677efb23dd978063595bb50fb64469c40","modified":1586251652968},{"_id":"public/archives/2020/index.html","hash":"8fbb495aa3857b5cde9e7ba0b013437e19d87184","modified":1586251652968},{"_id":"public/archives/2020/02/index.html","hash":"04d30b3e2a52cce36f5fa4d2e753709cbde85b97","modified":1586251652968},{"_id":"public/archives/2020/03/index.html","hash":"280954ea54fef0d319f416a7ab767388b576a98f","modified":1586251652968},{"_id":"public/archives/2020/04/index.html","hash":"9cb375ab9047d10a9baf8cd4049169d62892797f","modified":1586251652969},{"_id":"public/tags/Python/index.html","hash":"e1a5bc7eda179c53b49c20e1b0ebe9ef5719956f","modified":1586251652969},{"_id":"public/tags/è„šæœ¬/index.html","hash":"9e06a43cb3627aa4ca3af16a72fb025a528f29cd","modified":1586251652969},{"_id":"public/tags/Other/index.html","hash":"acf33a8ab42a146f00bf4c54058875aa34dbc6d4","modified":1586251652969},{"_id":"public/tags/å…ƒæ•°æ®/index.html","hash":"5e7b8942f96e2f94aea2e085b39c819fba9460f4","modified":1586251652969},{"_id":"public/tags/å¤§æ•°æ®/index.html","hash":"268890039c2ae829f9bf984e6b180351c22dc140","modified":1586251652969},{"_id":"public/tags/Mysql/index.html","hash":"dc9ceb4fc1179e00444625a6bd90dc6bf3a79105","modified":1586251652969},{"_id":"public/CNAME","hash":"99afd3824e1a9ec198a413feae6c0def72f2d7e1","modified":1586178005913},{"_id":"public/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1586178005913},{"_id":"public/img/article/tag.png","hash":"c8632d64d9471009098b84f70273e63037a4e7b8","modified":1586178005913},{"_id":"public/img/avatar/avatar.jpg","hash":"9b687fd63a0c1c74cde3d1b3128ca9f1a7b93541","modified":1586178005913},{"_id":"public/img/mypost/github.png","hash":"8a5c8b401c15bd52f2d5f85db35bb047904f581a","modified":1586178005913},{"_id":"public/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1586178005913},{"_id":"public/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1586178005914},{"_id":"public/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1586178005914},{"_id":"public/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1586178005914},{"_id":"public/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1586178005914},{"_id":"public/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1586178005914},{"_id":"public/live2dw/assets/exp/f01.exp.json","hash":"84073a497ddb6e56c6cfc244a0fb217ba473abf9","modified":1586178005914},{"_id":"public/live2dw/assets/exp/f02.exp.json","hash":"241b6afafa2e25c6d7a54692a8b5aa060a137ab1","modified":1586178005914},{"_id":"public/live2dw/assets/exp/f04.exp.json","hash":"35e746ede62e7090e7dfb08561d77772f58b4153","modified":1586178005914},{"_id":"public/live2dw/assets/exp/f03.exp.json","hash":"fbf7729e504f14f83f976827fcf62301a6579a34","modified":1586178005914},{"_id":"public/live2dw/assets/mtn/flickHead_01.mtn","hash":"a1011d6bf397bcd3c3c968d9616f88fe1ffbc83c","modified":1586178005914},{"_id":"public/live2dw/assets/mtn/flickHead_00.mtn","hash":"f64c79c9171660db5c440bef229ac2e35a1597d5","modified":1586178005914},{"_id":"public/live2dw/assets/mtn/flickHead_02.mtn","hash":"d3c9c0acb4dc25a2274f3b9faa71e5ce60ad92e4","modified":1586178005914},{"_id":"public/live2dw/assets/mtn/idle_00.mtn","hash":"378b4577217c604c9d28ab4edf8b707c8d8c2fbb","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/idle_01.mtn","hash":"88c2494655dbb712b842f03232b619f381753d52","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchIn_00.mtn","hash":"70978b4c983f6a9fd6d3d9c24571586f7d6eac30","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/idle_02.mtn","hash":"7f5d2cf8706007c8659938eba132a68c470a4c26","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchIn_01.mtn","hash":"a5fefb45115695db72b9499e627a51b2b9394f2c","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchIn_02.mtn","hash":"aa0d66ca9b06c374577fd7e64e89756de1e1f2ae","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchOut_00.mtn","hash":"e07fe8fd8c2810e3c1d28b730bd49c8c25849bad","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchOut_01.mtn","hash":"e05df948d08b17f34c993a9c1f901190509d5db0","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/shake_00.mtn","hash":"5185d02c7ab9f0bec3d4a890b54b2378e553373d","modified":1586178005915},{"_id":"public/live2dw/assets/mtn/pinchOut_02.mtn","hash":"b323fd350d334b33bbdfb31194ae664089986c27","modified":1586178005916},{"_id":"public/live2dw/assets/mtn/shake_02.mtn","hash":"2702970805e07777974c383613e631730982bcff","modified":1586178005916},{"_id":"public/live2dw/assets/mtn/shake_01.mtn","hash":"e812985a56796e122018f9d57d1606a4866ff7d1","modified":1586178005916},{"_id":"public/live2dw/assets/mtn/tapBody_02.mtn","hash":"a75acb51c1191ce5050d3ee1af6f2dcc787c7c5e","modified":1586178005916},{"_id":"public/live2dw/assets/shizuku.model.json","hash":"19a05bd41b806a935cea42c2000626fc82da2536","modified":1586178005916},{"_id":"public/live2dw/assets/mtn/tapBody_00.mtn","hash":"835aa3d4a8fbd26c0bb66b164a19464fa3f17a99","modified":1586178005916},{"_id":"public/live2dw/assets/shizuku.physics.json","hash":"6484d646e79a44c83784c6ae434cf7349746c5c8","modified":1586178005916},{"_id":"public/live2dw/assets/mtn/tapBody_01.mtn","hash":"78fca17436ab5e065e27f419f135aa6c0a0b52ef","modified":1586178005916},{"_id":"public/live2dw/assets/snd/flickHead_00.mp3","hash":"356388d939006b03cf9e6158c603b58d4800bec1","modified":1586178005917},{"_id":"public/live2dw/assets/shizuku.pose.json","hash":"ac5505efbf80ba0a2e5783d67fe232bc5c6f1f80","modified":1586178005917},{"_id":"public/live2dw/assets/snd/flickHead_01.mp3","hash":"436d0bbccf6e7a2744447554947eee4563608970","modified":1586178005917},{"_id":"public/live2dw/assets/snd/flickHead_02.mp3","hash":"5f63477ce63f2073e24d68fea906fe136fe6349e","modified":1586178005917},{"_id":"public/live2dw/assets/snd/pinchIn_01.mp3","hash":"d5c8cc6f61b56222a83a5174f75006f83c3b88da","modified":1586178005917},{"_id":"public/live2dw/assets/snd/pinchIn_00.mp3","hash":"f9baa3b7cadec20b714135fc49cfab3ff6adeeb4","modified":1586178005917},{"_id":"public/live2dw/assets/snd/shake_00.mp3","hash":"f65dd58e7b44ec5c865d13c190316070b625b5fe","modified":1586178005917},{"_id":"public/live2dw/assets/snd/shake_01.mp3","hash":"c1e0e8a07ff268ee06c2b7825d1b645e193f21b9","modified":1586178005917},{"_id":"public/live2dw/assets/snd/shake_02.mp3","hash":"8882b94bce00f09232588b7301badb105fa8acab","modified":1586178005917},{"_id":"public/live2dw/assets/snd/tapBody_00.mp3","hash":"003e68a59a9c8392e230f34c91860efbd946277a","modified":1586178005917},{"_id":"public/live2dw/lib/L2Dwidget.min.js","hash":"5f1a807437cc723bcadc3791d37add5ceed566a2","modified":1586178005917},{"_id":"public/live2dw/assets/snd/tapBody_01.mp3","hash":"5314b50f153df71559e51e2586581c006df00722","modified":1586178005917},{"_id":"public/live2dw/assets/snd/tapBody_02.mp3","hash":"15e7815ed0a0e5164e18e0c53b97aedc742a134d","modified":1586178005918},{"_id":"public/img/header_img/tag.jpg","hash":"8f5e8d39b7307bcf10fa3a7c2d71c1f4a66e0d71","modified":1586178006177},{"_id":"public/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1586178006178},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_00.png","hash":"21bdb28b31783e23b26b3aa061e90be4088665aa","modified":1586178006182},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_03.png","hash":"07f568a2bb8045b6bdff7783fb4daf62c821f9ab","modified":1586178006182},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_05.png","hash":"0cd00007fb8bff62a2eb08e1d7c43abab8722224","modified":1586178006182},{"_id":"public/live2dw/assets/snd/pinchIn_02.mp3","hash":"5b63e02607571ac601c500995e836e6c861b1c62","modified":1586178006182},{"_id":"public/live2dw/assets/snd/pinchOut_00.mp3","hash":"0654f38f6e9fd623eaf8be11b5d58c9d12991949","modified":1586178006182},{"_id":"public/live2dw/assets/snd/pinchOut_01.mp3","hash":"8a081030fd53c07bffe3edd48f87a371ca77296b","modified":1586178006182},{"_id":"public/live2dw/assets/snd/pinchOut_02.mp3","hash":"554edb2f3838cbdc27d1a9c6b8a9cb6eb465cbdd","modified":1586178006183},{"_id":"public/live2dw/lib/L2Dwidget.min.js.map","hash":"3290fe2df45f065b51a1cd7b24ec325cbf9bb5ce","modified":1586178006183},{"_id":"public/css/archive.css","hash":"8db895ebaeff19ac145c961abcfd5d4a8d67a8ea","modified":1586178006192},{"_id":"public/css/donate.css","hash":"f65ac8363d8d215adb896158e7b45165db259a47","modified":1586178006193},{"_id":"public/css/highlight.css","hash":"c58b4569c086e477a00dcbf5a95a166fe5fecfb0","modified":1586178006193},{"_id":"public/css/rocket.css","hash":"9456fd92f729e09d6de8cda70f95d78e0d789c70","modified":1586178006193},{"_id":"public/css/signature.css","hash":"820fa4743cea34a61808cd8f7de528605c32d7e3","modified":1586178006193},{"_id":"public/css/toc.css","hash":"f756b9e1b2208d2e5b0f3d2ac5e4fea3b7da0e10","modified":1586178006193},{"_id":"public/css/widget.css","hash":"da95ad3f1938f24d20f1fa77d7a38f0c392b5ec8","modified":1586178006193},{"_id":"public/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1586178006193},{"_id":"public/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1586178006193},{"_id":"public/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1586178006193},{"_id":"public/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1586178006193},{"_id":"public/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1586178006193},{"_id":"public/js/toc.js","hash":"41e52551731854224c249d53010c1bae5aa92ffa","modified":1586178006193},{"_id":"public/js/smoothscroll.js","hash":"f3f61028516fd9ec3fec3b2a284253e711bb360a","modified":1586178006193},{"_id":"public/css/beantech.css","hash":"6b86d52f8448542cbcb2c118ec9084359f2f5ee8","modified":1586178006193},{"_id":"public/css/beantech.min.css","hash":"d6b6442f9ea4765c1d6caa208235f5d7bc742722","modified":1586178006193},{"_id":"public/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1586178006194},{"_id":"public/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1586178006194},{"_id":"public/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1586178006195},{"_id":"public/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1586178006195},{"_id":"public/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1586178006195},{"_id":"public/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1586178006195},{"_id":"public/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1586178006196},{"_id":"public/img/header_img/archives-widget.jpg","hash":"68f7d525269a94287e0ad18713ae232fb59dcf71","modified":1586178006196},{"_id":"public/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1586178006196},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_01.png","hash":"3d0e745f3e560071ee08beeecde186e5ea35d99e","modified":1586178006196},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_04.png","hash":"f764d594841905db8b2998dd61c329866125ad97","modified":1586178006197},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js","hash":"35bb5b588b6de25c9be2dd51d3fd331feafac02d","modified":1586178006197},{"_id":"public/live2dw/assets/moc/shizuku.1024/texture_02.png","hash":"055eb2da9c13e9116be93a1e60c0ea2b660af864","modified":1586178006210},{"_id":"public/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1586178006244},{"_id":"public/img/avatar/ironman.png","hash":"7d6a06b4b544ab146c3b3e8474edc33f14ac6e4d","modified":1586178006254},{"_id":"public/img/header_img/archive.jpg","hash":"66d9f5a44f8b7e95ce9c3f63579e8deb801de29f","modified":1586178006254},{"_id":"public/img/header_img/home3.jpg","hash":"8676ac460c6b7eb2b1513c157edd4e3d6c94eaa3","modified":1586178006254},{"_id":"public/img/article_header/article_bg.jpg","hash":"6af63305c923899017e727b5ca968a2703bc08cf","modified":1586178006255},{"_id":"public/img/article_header/header.jpg","hash":"8488dc1d7055d8e7107be5cda42a5977812275fc","modified":1586178006255},{"_id":"public/img/mypost/pynput.png","hash":"2396def9b254d14bf21d04f7e7ed5ea935d69f67","modified":1586178006256},{"_id":"public/img/header_img/tag.jpg.bak","hash":"c2680f6d36f0ba1fcbf96a13a0a0516c6f9bd14b","modified":1586178006256},{"_id":"public/img/header_img/about.jpg","hash":"da78b9f1e92f03a4cb27f8a6c89b18ccffe59777","modified":1586178006256},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js.map","hash":"35e71cc2a130199efb167b9a06939576602f0d75","modified":1586178006320},{"_id":"public/img/article/huweihuang_blog.png","hash":"392cf8b33be6c752dd908e027fa3346a6ecd58ab","modified":1586178006327},{"_id":"public/img/header_img/home.jpg","hash":"8f1c440427a4aa86b623503a926c027e2e10cd66","modified":1586178006331},{"_id":"public/live2dw/assets/moc/shizuku.moc","hash":"c2670a0f75830edc89d7fe6d074de4ee67e8dc5d","modified":1586178006331},{"_id":"public/img/blog.jpg","hash":"a76af0b98dbe92ca2d21babcef13f094e409554b","modified":1586178006333},{"_id":"public/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1586178006350},{"_id":"public/img/header_img/home-bg-o.png","hash":"134ece4cb4c49c7ca1403a5afe7f46d0e2f9ecbb","modified":1586178006353},{"_id":"public/img/header_img/home2.png","hash":"da6a3d5ca787bdc25e69655abd879b4f821aeb30","modified":1586178006359},{"_id":"public/img/header_img/404.png","hash":"6bf9c224543ec54e250309db89cbdf46e0c4b5ba","modified":1586178006366},{"_id":"source/_posts/hiveserver2ä¸HQLçš„æ‰§è¡Œ.md","hash":"e9e42a09f2506b7fc1d11cff9c66453c2d8c74bf","modified":1586251617153},{"_id":"source/_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-æ ¼å¼åŒ–.md","hash":"25c92022831da147200d9723007911963adf5020","modified":1586251597840},{"_id":"source/_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-å…ƒæ•°æ®.md","hash":"3760e6f72a65b769db9fc2b39ffb821b6f32e8ed","modified":1586251565288},{"_id":"source/_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜.md","hash":"f928d181d5b64bfa92e1e2ce642a1fbd0893e724","modified":1586251607419},{"_id":"public/article/åŸºäºantlr4å®ç°HQLçš„è§£æ-å…ƒæ•°æ®/index.html","hash":"b3d5e79b7e1a5020778b1d4b556ad6637f827d1b","modified":1586251652977},{"_id":"public/article/hiveserver2ä¸HQLçš„æ‰§è¡Œ/index.html","hash":"487aea2a5e6417384c620e621d3c922ea30d7870","modified":1586251652977},{"_id":"public/article/åŸºäºantlr4å®ç°HQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜/index.html","hash":"e28b00bd7177c8ff22bcc2a0fced3dac76e93261","modified":1586251652977},{"_id":"public/article/åŸºäºantlr4å®ç°HQLçš„è§£æ-æ ¼å¼åŒ–/index.html","hash":"25aaa9ea9b2bec845a6432ab2190dcfde006b9a7","modified":1586251652977},{"_id":"public/tags/HQLè§£æ/index.html","hash":"97e8aac26cf1eaef9ee2c7057304fe9e79854539","modified":1586251652977},{"_id":"public/tags/Java/index.html","hash":"196cda416b8e70aa17abd732d14edc912dc152fc","modified":1586251652977}],"Category":[],"Data":[],"Page":[{"layout":"404","description":"ä½ æ¥åˆ°äº†æ²¡æœ‰çŸ¥è¯†çš„è’åŸ","header-img":"/img/header_img/404.png","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"ä½ æ¥åˆ°äº†æ²¡æœ‰çŸ¥è¯†çš„è’åŸ\"\nheader-img: \"/img/header_img/404.png\"\n---\n","date":"2019-11-10T11:55:31.061Z","updated":"2019-08-16T12:43:34.000Z","path":"404.html","title":"","comments":1,"_id":"ck8ohfh690000pb0jcagx476b","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"about","title":"About","date":"2019-11-11T02:00:00.000Z","description":"","header-img":"/img/header_img/about.jpg","aplayer":true,"fixed":false,"_content":"\n## å…³äºæˆ‘\n\n> ç”µå­ä¸“ä¸šçš„ä½è°ƒç å†œ\n\n> å–œæ¬¢çš„äº‹æƒ…ï¼šå†œè¯ï¼Œé’¢ç´ï¼Œé’“é±¼ï¼Œèººå°¸ï¼Œå‡ºé—¨èµ°èµ°\n\n> å‘å¾€çš„äº‹æƒ…ï¼šè¿˜æœ‰å¥½å¤šæ²¡åšè¿‡çš„äº‹æƒ…\n\n## æŠ€æœ¯æ ˆå†ç¨‹\n\n2015 - 2016\n- åˆå…¥ç¼–ç¨‹ï¼Œå…ˆä»å‰ç«¯åŸºç¡€html, css, jså­¦èµ·ï¼Œjqueryï¼Œbootstrapè¿˜å¾ˆæµè¡Œã€‚å¤§å­¦è¯¾ç¨‹å­¦åˆ°ä¸€äº›Cè¯­è¨€ã€‚\n\n2016 - 2017\n- å­¦äº†PHPï¼Œå†å­¦ä¸€äº›æ¡†æ¶ï¼Œå¾®æ“ï¼ŒCIï¼Œä¹°äº†äº‘æœåŠ¡å™¨ï¼Œæ­äº†ä¸ªåšå®¢ï¼Œç®¡ç†å¾®ä¿¡å…¬ä¼—å·ï¼Œå¼€å‘è‡ªå®šä¹‰æ¨¡å—ã€‚\n\n2017 - 2018\n- å¼€å§‹Pythonä¹‹æ—…ï¼Œå…¥é—¨åˆ°webæ¡†æ¶åˆ°ä¸€äº›æœºå™¨å­¦ä¹ ï¼Œä¹Ÿæ‰¾åˆ°äº†äººç”Ÿç¬¬ä¸€ä»½å·¥ä½œï¼Œç»§ç»­pythonåç«¯ï¼Œä¹Ÿæ¥è§¦äº›é‡åŒ–ï¼Œ\n  \n2018 - 2019\n- è¿›äº†ä¸€ä¸ªè¿ç»´éƒ¨é—¨ï¼Œç©ç©linuxçš„ç‰©ç†æœºï¼ŒShellè„šæœ¬ï¼Œä¹Ÿæœ‰éƒ¨åˆ†Pythonçš„å¼€å‘ã€‚\n\n2019 - 2020\n- ç»§ç»­Pythonçš„webå¼€å‘ï¼Œæ¥è§¦å¤§æ•°æ®çš„å…¨å®¶æ¡¶ï¼Œä¹Ÿè¿›è¡Œäº†ä¸‹Javaå’ŒSpringbootçš„å°è¯•ã€‚\n\n2020 - 2021\n- Springbootç»§ç»­å°è¯•ï¼Œå¤§æ•°æ®ç»„ä»¶ç»§ç»­å°è¯•ï¼Œå…¶ä»–æœŸå¾…ä¸­ã€‚ã€‚ã€‚\n\n\n## è”ç³»æˆ‘\n\n> Email: 935669873@qq.com  \n\n> å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åŠ æˆ‘qqäº¤æµğŸ‘†\n","source":"about/index.md","raw":"---\nlayout: \"about\"\ntitle: \"About\"\ndate: 2019-11-11 10:00:00\ndescription: \"\"\nheader-img: \"/img/header_img/about.jpg\"\naplayer: true\nfixed: false\n---\n\n## å…³äºæˆ‘\n\n> ç”µå­ä¸“ä¸šçš„ä½è°ƒç å†œ\n\n> å–œæ¬¢çš„äº‹æƒ…ï¼šå†œè¯ï¼Œé’¢ç´ï¼Œé’“é±¼ï¼Œèººå°¸ï¼Œå‡ºé—¨èµ°èµ°\n\n> å‘å¾€çš„äº‹æƒ…ï¼šè¿˜æœ‰å¥½å¤šæ²¡åšè¿‡çš„äº‹æƒ…\n\n## æŠ€æœ¯æ ˆå†ç¨‹\n\n2015 - 2016\n- åˆå…¥ç¼–ç¨‹ï¼Œå…ˆä»å‰ç«¯åŸºç¡€html, css, jså­¦èµ·ï¼Œjqueryï¼Œbootstrapè¿˜å¾ˆæµè¡Œã€‚å¤§å­¦è¯¾ç¨‹å­¦åˆ°ä¸€äº›Cè¯­è¨€ã€‚\n\n2016 - 2017\n- å­¦äº†PHPï¼Œå†å­¦ä¸€äº›æ¡†æ¶ï¼Œå¾®æ“ï¼ŒCIï¼Œä¹°äº†äº‘æœåŠ¡å™¨ï¼Œæ­äº†ä¸ªåšå®¢ï¼Œç®¡ç†å¾®ä¿¡å…¬ä¼—å·ï¼Œå¼€å‘è‡ªå®šä¹‰æ¨¡å—ã€‚\n\n2017 - 2018\n- å¼€å§‹Pythonä¹‹æ—…ï¼Œå…¥é—¨åˆ°webæ¡†æ¶åˆ°ä¸€äº›æœºå™¨å­¦ä¹ ï¼Œä¹Ÿæ‰¾åˆ°äº†äººç”Ÿç¬¬ä¸€ä»½å·¥ä½œï¼Œç»§ç»­pythonåç«¯ï¼Œä¹Ÿæ¥è§¦äº›é‡åŒ–ï¼Œ\n  \n2018 - 2019\n- è¿›äº†ä¸€ä¸ªè¿ç»´éƒ¨é—¨ï¼Œç©ç©linuxçš„ç‰©ç†æœºï¼ŒShellè„šæœ¬ï¼Œä¹Ÿæœ‰éƒ¨åˆ†Pythonçš„å¼€å‘ã€‚\n\n2019 - 2020\n- ç»§ç»­Pythonçš„webå¼€å‘ï¼Œæ¥è§¦å¤§æ•°æ®çš„å…¨å®¶æ¡¶ï¼Œä¹Ÿè¿›è¡Œäº†ä¸‹Javaå’ŒSpringbootçš„å°è¯•ã€‚\n\n2020 - 2021\n- Springbootç»§ç»­å°è¯•ï¼Œå¤§æ•°æ®ç»„ä»¶ç»§ç»­å°è¯•ï¼Œå…¶ä»–æœŸå¾…ä¸­ã€‚ã€‚ã€‚\n\n\n## è”ç³»æˆ‘\n\n> Email: 935669873@qq.com  \n\n> å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åŠ æˆ‘qqäº¤æµğŸ‘†\n","updated":"2020-04-07T09:24:39.017Z","path":"about/index.html","_id":"ck8ohfh760002pb0jv45xrz2u","comments":1,"content":"<h2 id=\"å…³äºæˆ‘\">å…³äºæˆ‘</h2>\n<blockquote>\n<p>ç”µå­ä¸“ä¸šçš„ä½è°ƒç å†œ</p>\n</blockquote>\n<blockquote>\n<p>å–œæ¬¢çš„äº‹æƒ…ï¼šå†œè¯ï¼Œé’¢ç´ï¼Œé’“é±¼ï¼Œèººå°¸ï¼Œå‡ºé—¨èµ°èµ°</p>\n</blockquote>\n<blockquote>\n<p>å‘å¾€çš„äº‹æƒ…ï¼šè¿˜æœ‰å¥½å¤šæ²¡åšè¿‡çš„äº‹æƒ…</p>\n</blockquote>\n<h2 id=\"æŠ€æœ¯æ ˆå†ç¨‹\">æŠ€æœ¯æ ˆå†ç¨‹</h2>\n<p>2015 - 2016</p>\n<ul>\n<li>åˆå…¥ç¼–ç¨‹ï¼Œå…ˆä»å‰ç«¯åŸºç¡€html, css, jså­¦èµ·ï¼Œjqueryï¼Œbootstrapè¿˜å¾ˆæµè¡Œã€‚å¤§å­¦è¯¾ç¨‹å­¦åˆ°ä¸€äº›Cè¯­è¨€ã€‚</li>\n</ul>\n<p>2016 - 2017</p>\n<ul>\n<li>å­¦äº†PHPï¼Œå†å­¦ä¸€äº›æ¡†æ¶ï¼Œå¾®æ“ï¼ŒCIï¼Œä¹°äº†äº‘æœåŠ¡å™¨ï¼Œæ­äº†ä¸ªåšå®¢ï¼Œç®¡ç†å¾®ä¿¡å…¬ä¼—å·ï¼Œå¼€å‘è‡ªå®šä¹‰æ¨¡å—ã€‚</li>\n</ul>\n<p>2017 - 2018</p>\n<ul>\n<li>å¼€å§‹Pythonä¹‹æ—…ï¼Œå…¥é—¨åˆ°webæ¡†æ¶åˆ°ä¸€äº›æœºå™¨å­¦ä¹ ï¼Œä¹Ÿæ‰¾åˆ°äº†äººç”Ÿç¬¬ä¸€ä»½å·¥ä½œï¼Œç»§ç»­pythonåç«¯ï¼Œä¹Ÿæ¥è§¦äº›é‡åŒ–ï¼Œ</li>\n</ul>\n<p>2018 - 2019</p>\n<ul>\n<li>è¿›äº†ä¸€ä¸ªè¿ç»´éƒ¨é—¨ï¼Œç©ç©linuxçš„ç‰©ç†æœºï¼ŒShellè„šæœ¬ï¼Œä¹Ÿæœ‰éƒ¨åˆ†Pythonçš„å¼€å‘ã€‚</li>\n</ul>\n<p>2019 - 2020</p>\n<ul>\n<li>ç»§ç»­Pythonçš„webå¼€å‘ï¼Œæ¥è§¦å¤§æ•°æ®çš„å…¨å®¶æ¡¶ï¼Œä¹Ÿè¿›è¡Œäº†ä¸‹Javaå’ŒSpringbootçš„å°è¯•ã€‚</li>\n</ul>\n<p>2020 - 2021</p>\n<ul>\n<li>Springbootç»§ç»­å°è¯•ï¼Œå¤§æ•°æ®ç»„ä»¶ç»§ç»­å°è¯•ï¼Œå…¶ä»–æœŸå¾…ä¸­ã€‚ã€‚ã€‚</li>\n</ul>\n<h2 id=\"è”ç³»æˆ‘\">è”ç³»æˆ‘</h2>\n<blockquote>\n<p>Email: <a href=\"mailto:935669873@qq.com\" target=\"_blank\" rel=\"noopener\">935669873@qq.com</a></p>\n</blockquote>\n<blockquote>\n<p>å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åŠ æˆ‘qqäº¤æµğŸ‘†</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h2>å…³äºæˆ‘</h2>\n<blockquote>\n<p>ç”µå­ä¸“ä¸šçš„ä½è°ƒç å†œ</p>\n</blockquote>\n<blockquote>\n<p>å–œæ¬¢çš„äº‹æƒ…ï¼šå†œè¯ï¼Œé’¢ç´ï¼Œé’“é±¼ï¼Œèººå°¸ï¼Œå‡ºé—¨èµ°èµ°</p>\n</blockquote>\n<blockquote>\n<p>å‘å¾€çš„äº‹æƒ…ï¼šè¿˜æœ‰å¥½å¤šæ²¡åšè¿‡çš„äº‹æƒ…</p>\n</blockquote>\n<h2>æŠ€æœ¯æ ˆå†ç¨‹</h2>\n<p>2015 - 2016</p>\n<ul>\n<li>åˆå…¥ç¼–ç¨‹ï¼Œå…ˆä»å‰ç«¯åŸºç¡€html, css, jså­¦èµ·ï¼Œjqueryï¼Œbootstrapè¿˜å¾ˆæµè¡Œã€‚å¤§å­¦è¯¾ç¨‹å­¦åˆ°ä¸€äº›Cè¯­è¨€ã€‚</li>\n</ul>\n<p>2016 - 2017</p>\n<ul>\n<li>å­¦äº†PHPï¼Œå†å­¦ä¸€äº›æ¡†æ¶ï¼Œå¾®æ“ï¼ŒCIï¼Œä¹°äº†äº‘æœåŠ¡å™¨ï¼Œæ­äº†ä¸ªåšå®¢ï¼Œç®¡ç†å¾®ä¿¡å…¬ä¼—å·ï¼Œå¼€å‘è‡ªå®šä¹‰æ¨¡å—ã€‚</li>\n</ul>\n<p>2017 - 2018</p>\n<ul>\n<li>å¼€å§‹Pythonä¹‹æ—…ï¼Œå…¥é—¨åˆ°webæ¡†æ¶åˆ°ä¸€äº›æœºå™¨å­¦ä¹ ï¼Œä¹Ÿæ‰¾åˆ°äº†äººç”Ÿç¬¬ä¸€ä»½å·¥ä½œï¼Œç»§ç»­pythonåç«¯ï¼Œä¹Ÿæ¥è§¦äº›é‡åŒ–ï¼Œ</li>\n</ul>\n<p>2018 - 2019</p>\n<ul>\n<li>è¿›äº†ä¸€ä¸ªè¿ç»´éƒ¨é—¨ï¼Œç©ç©linuxçš„ç‰©ç†æœºï¼ŒShellè„šæœ¬ï¼Œä¹Ÿæœ‰éƒ¨åˆ†Pythonçš„å¼€å‘ã€‚</li>\n</ul>\n<p>2019 - 2020</p>\n<ul>\n<li>ç»§ç»­Pythonçš„webå¼€å‘ï¼Œæ¥è§¦å¤§æ•°æ®çš„å…¨å®¶æ¡¶ï¼Œä¹Ÿè¿›è¡Œäº†ä¸‹Javaå’ŒSpringbootçš„å°è¯•ã€‚</li>\n</ul>\n<p>2020 - 2021</p>\n<ul>\n<li>Springbootç»§ç»­å°è¯•ï¼Œå¤§æ•°æ®ç»„ä»¶ç»§ç»­å°è¯•ï¼Œå…¶ä»–æœŸå¾…ä¸­ã€‚ã€‚ã€‚</li>\n</ul>\n<h2>è”ç³»æˆ‘</h2>\n<blockquote>\n<p>Email: <a href=\"mailto:935669873@qq.com\" target=\"_blank\" rel=\"noopener\">935669873@qq.com</a></p>\n</blockquote>\n<blockquote>\n<p>å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åŠ æˆ‘qqäº¤æµğŸ‘†</p>\n</blockquote>\n"},{"layout":"archive","title":"Archives","header-img":"/img/header_img/archive.jpg","comments":0,"date":"2017-09-20T12:49:56.000Z","description":"Hey, this is archives","_content":"","source":"archive/index.md","raw":"---\nlayout: \"archive\"\ntitle: \"Archives\"\nheader-img: \"/img/header_img/archive.jpg\"\ncomments: false\ndate: 2017-09-20 20:49:56\ndescription: \"Hey, this is archives\"\n---","updated":"2019-11-13T09:02:42.204Z","path":"archive/index.html","_id":"ck8ohfh7a0004pb0jl269cev0","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"tags","title":"Tags","description":"Hey, this is Tags.","header-img":"/img/header_img/tag.jpg","_content":"","source":"tags/index.md","raw":"---\nlayout: \"tags\"\ntitle: \"Tags\"\ndescription: \"Hey, this is Tags.\"\nheader-img: \"/img/header_img/tag.jpg\"\n---\n","date":"2019-11-11T01:49:59.687Z","updated":"2019-11-11T01:49:59.687Z","path":"tags/index.html","comments":1,"_id":"ck8ohfh7c0006pb0jcag5w24j","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†","catalog":true,"date":"2000-03-31T08:30:21.000Z","subtitle":null,"header-img":null,"_content":"","source":"_posts/hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†.md","raw":"---\ntitle: hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†\ncatalog: true\ndate: 2000-03-31 16:30:21\nsubtitle:\nheader-img:\ntags:\n---\n","slug":"hiveSQLæ‰§è¡Œæ—¥å¿—çš„æ”¶é›†","published":1,"updated":"2020-04-01T07:26:25.113Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh760003pb0jwf6vexbb","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•","catalog":true,"date":"2000-03-31T08:33:57.000Z","subtitle":null,"header-img":null,"_content":"","source":"_posts/å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•.md","raw":"---\ntitle: å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•\ncatalog: true\ndate: 2000-03-31 16:33:57\nsubtitle:\nheader-img:\ntags:\n---\n","slug":"å…³äºsparkä½¿ç”¨rangerç®¡ç†æ•°æ®æƒé™çš„ä¸€äº›å°è¯•","published":1,"updated":"2020-04-01T07:25:59.031Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7b0005pb0jbx8zxl7u","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„è®°å½•ä¸è¿˜åŸ","catalog":true,"date":"2020-04-01T08:19:52.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"\n## å‰è¨€\n\nå¿ƒè¡€æ¥æ½®ï¼Œå®ç°ä¸€æ³¢è®°å½•æ“ä½œå¹¶è¿˜åŸæ“ä½œï¼Œå¯ç”¨çš„åœºæ™¯è¯´ä¸å®šè¿˜æŒºå¤šã€‚  \nè¿™æ¬¡å®ç°çš„è®°å½•å’Œè¿˜åŸçš„æ“ä½œåŒ…æ‹¬  \n- é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®\n- é”®ç›˜çš„æŒ‰ä¸‹ï¼Œæ¾å¼€\n \n## å‰æœŸå‡†å¤‡\n\nä½¿ç”¨pynputå°±å¯ä»¥å®Œç¾çš„å®ç°ä¸Šé¢éœ€æ±‚ï¼Œè€Œä¸”ç”¨ç€è¿˜æŒºç®€å•ï¼›\nå…·ä½“åŒ…è¯¦ç»†æ¥å£ä¸ä½¿ç”¨è¯´æ˜çœ‹å¦‚ä¸‹å›¾ï¼š  \n![å›¾](/img/mypost/pynput.png)\n\n## å…·ä½“å®ç°\nä½¿ç”¨python3ç¼–å†™ï¼Œåœ¨macç¯å¢ƒä¸‹è¿è¡Œè‰¯å¥½ã€‚\n\n``` python\nimport time\nimport json\nimport random\nimport threading\nimport pynput\n\n\nclass MouseRecord(object):\n    \"\"\"\n    è®°å½•é”®ç›˜é¼ æ ‡äº‹ä»¶å€¼jsonæ–‡ä»¶ï¼Œ\n    åŒ…æ‹¬é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®\n    é”®ç›˜æŒ‰ä¸‹ï¼Œæ”¾å¼€\n    \"\"\"\n    def __init__(self):\n        self.start_time = 0\n        self.mouse_list = []\n        self.running = True\n        self.save_file = \"mouselist.json\"\n\n    def get_time(self):\n        return time.time() - self.start_time\n\n    def on_click(self, x, y, button, pressed):\n        \"\"\"\n        clickäº‹ä»¶\n        \"\"\"\n        if not self.running:\n            return False\n        if not pressed:\n            return True\n        self.mouse_list.append({\n            \"opera\": \"click\",\n            \"posix\": x,\n            \"posiy\": y,\n            \"button\": str(button),\n            \"stime\": self.get_time()\n        })\n        print(x, y, button, pressed)\n\n    def on_move(self, x, y):\n        \"\"\"\n        é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼ŒåŠ ä¸ªéšæœºå‡å°‘å­˜å‚¨\n        \"\"\"\n        if random.randint(0, 2) == 1:\n            self.mouse_list.append({\n                \"opera\": \"move\",\n                \"posix\": x,\n                \"posiy\": y,\n                \"stime\": self.get_time()\n            })\n\n    def on_scroll(self, x, y, dx, dy):\n        \"\"\"\n        é¼ æ ‡æ»šåŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse_list.append({\n            \"opera\": \"scroll\",\n            \"posix\": x,\n            \"posiy\": y,\n            \"scrollx\": dx,\n            \"scrolly\": dy,\n            \"stime\": self.get_time()\n        })\n\n    def on_key_press(self, key):\n        \"\"\"\n        é”®ç›˜æŒ‰ä¸‹äº‹ä»¶ï¼Œæ­£å¸¸å»ºæ˜¯ç›´æ¥å±•ç¤ºå­—ç¬¦ï¼Œç‰¹æ®Šé”®ä¼šè¿”å›Key.xxx\n        æŒ‰ä¸‹escçš„æ—¶å€™é€€å‡ºç›‘å¬\n        \"\"\"\n        if key == pynput.keyboard.Key.esc:\n            self.running = False\n            mouse = pynput.mouse.Controller()\n            mouse.click(pynput.mouse.Button.left)\n            return self.running\n        if str(key) != \"<0>\":\n            self.mouse_list.append({\n                \"opera\": \"press\",\n                \"key\": str(key).strip(\"'\"),\n                \"stime\": self.get_time()\n            })\n\n    def on_key_release(self, key):\n        \"\"\"\n        é”®ç›˜é‡Šæ”¾äº‹ä»¶\n        \"\"\"\n        if str(key) != \"<0>\":\n            self.mouse_list.append({\n                \"opera\": \"release\",\n                \"key\": str(key).strip(\"'\"),\n                \"stime\": self.get_time()\n            })\n\n    def mouse_listen(self):\n        \"\"\"\n        å¼€å¯é¼ æ ‡ç›‘å¬\n        \"\"\"\n        with pynput.mouse.Listener(on_move=self.on_move, on_click=self.on_click, on_scroll=self.on_scroll) as listener:\n            listener.join()\n\n    def key_listen(self):\n        \"\"\"\n        å¼€å¯é”®ç›˜ç›‘å¬\n        \"\"\"\n        with pynput.keyboard.Listener(on_press=self.on_key_press, on_release=self.on_key_release) as listener:\n            listener.join()\n\n    def run(self):\n        \"\"\"\n        è¿è¡Œç›‘å¬ï¼Œç»“æŸåä¿å­˜ä¸ºjsonæ–‡ä»¶\n        \"\"\"\n        self.start_time = time.time()\n        t1 = threading.Thread(target=self.mouse_listen)\n        t2 = threading.Thread(target=self.key_listen)\n        t1.start()\n        t2.start()\n        t1.join()\n        t2.join()\n        print(json.dumps(self.mouse_list), file=open(self.save_file, \"w\"))\n\n\nclass MouseRecover(object):\n    \"\"\"\n    è¿˜åŸé”®ç›˜é¼ æ ‡äº‹ä»¶\n    \"\"\"\n    def __init__(self):\n        self.start_time = 0\n        self.mouse = pynput.mouse.Controller()\n        self.keyboard = pynput.keyboard.Controller()\n        self.buttons = {\n            \"Button.left\": pynput.mouse.Button.left,\n            \"Button.right\": pynput.mouse.Button.right\n        }\n        self.read_file = \"mouselist.json\"\n\n    def deal_click(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡ç‚¹å‡»äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n        time.sleep(0.1)\n        self.mouse.click(self.buttons.get(record.get(\"button\")))\n\n    def deal_move(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡ç§»åŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n\n    def deal_scroll(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡æ»šåŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n        self.mouse.scroll(record.get(\"scrollx\"), record.get(\"scrolly\"))\n\n    def deal_key_press(self, record):\n        \"\"\"\n        å¤„ç†é”®ç›˜æŒ‰ä¸‹äº‹ä»¶\n        \"\"\"\n        if record.get(\"key\").startswith(\"Key\"):\n            self.keyboard.press(eval(record.get(\"key\"), {}, {\n                \"Key\": pynput.keyboard.Key\n            }))\n        else:\n            self.keyboard.press(record.get(\"key\"))\n\n    def deal_key_release(self, record):\n        \"\"\"\n        å¤„ç†é”®ç›˜é‡Šæ”¾äº‹ä»¶\n        \"\"\"\n        if record.get(\"key\").startswith(\"Key\"):\n            self.keyboard.release(eval(record.get(\"key\"), {}, {\n                \"Key\": pynput.keyboard.Key\n            }))\n        else:\n            self.keyboard.release(record.get(\"key\"))\n\n    def run(self):\n        \"\"\"\n        è¯»å–jsonæ–‡ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶\n        \"\"\"\n        data = json.load(open(self.read_file, \"r\"))\n        for item in data:\n            if item.get(\"opera\") == \"click\":\n                self.deal_click(item)\n            if item.get(\"opera\") == \"move\":\n                self.deal_move(item)\n            if item.get(\"opera\") == \"scroll\":\n                self.deal_scroll(item)\n            if item.get(\"opera\") == \"press\":\n                self.deal_key_press(item)\n            if item.get(\"opera\") == \"release\":\n                self.deal_key_release(item)\n            time.sleep(item.get(\"stime\") - self.start_time)\n            self.start_time = item.get(\"stime\")\n\n\nif __name__ == \"__main__\":\n    #è®°å½•äº‹ä»¶\n    t = MouseRecord()\n    t.run()\n\n    # è¿è¡Œäº‹ä»¶\n    # tt = MouseRecover()\n    # tt.run()\n```\n\n## ä½¿ç”¨\n\n- å…ˆè¿è¡ŒMouseRecordçš„runï¼Œç„¶åå°±å·²ç»å¼€å¯è®°å½•ï¼Œæ“ä½œä¸€éåæŒ‰escé€€å‡ºè®°å½•ï¼›\n- åœ¨è¿è¡ŒMouseRecoverçš„runï¼Œç„¶åå°±ä¼šæŠŠåˆšåˆšä¸­é—´è®°å½•çš„æ“ä½œæ‰§è¡Œä¸€éï¼›ï¼ˆæ“ä½œæœ€å¥½å¯é‡å¤è¿˜åŸçš„ï¼‰\n\n## åæœŸéæƒ³\n\n- å¯ä»¥å¯¹ä¿å­˜çš„æ“ä½œé“¾è·¯è¿›è¡Œç¼–è¾‘ï¼Œåœ¨æ‰§è¡Œæ—¶æ’å…¥ä¸€äº›å˜é‡ï¼›\n\n## å‚è€ƒå‹å†›\n- [è®°å½•ä½ çš„æ“ä½œâ€”â€”pynputæ¨¡æ‹Ÿå’Œç›‘å¬é”®ç›˜é¼ æ ‡æ“ä½œ](https://www.jianshu.com/p/11a8e75f5170)","source":"_posts/pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„ç›‘æ§ä¸è¿˜åŸ.md","raw":"---\ntitle: pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„è®°å½•ä¸è¿˜åŸ\ncatalog: true\ndate: 2020-04-01 16:19:52\nsubtitle: \nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- Python\n- è„šæœ¬\n---\n\n## å‰è¨€\n\nå¿ƒè¡€æ¥æ½®ï¼Œå®ç°ä¸€æ³¢è®°å½•æ“ä½œå¹¶è¿˜åŸæ“ä½œï¼Œå¯ç”¨çš„åœºæ™¯è¯´ä¸å®šè¿˜æŒºå¤šã€‚  \nè¿™æ¬¡å®ç°çš„è®°å½•å’Œè¿˜åŸçš„æ“ä½œåŒ…æ‹¬  \n- é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®\n- é”®ç›˜çš„æŒ‰ä¸‹ï¼Œæ¾å¼€\n \n## å‰æœŸå‡†å¤‡\n\nä½¿ç”¨pynputå°±å¯ä»¥å®Œç¾çš„å®ç°ä¸Šé¢éœ€æ±‚ï¼Œè€Œä¸”ç”¨ç€è¿˜æŒºç®€å•ï¼›\nå…·ä½“åŒ…è¯¦ç»†æ¥å£ä¸ä½¿ç”¨è¯´æ˜çœ‹å¦‚ä¸‹å›¾ï¼š  \n![å›¾](/img/mypost/pynput.png)\n\n## å…·ä½“å®ç°\nä½¿ç”¨python3ç¼–å†™ï¼Œåœ¨macç¯å¢ƒä¸‹è¿è¡Œè‰¯å¥½ã€‚\n\n``` python\nimport time\nimport json\nimport random\nimport threading\nimport pynput\n\n\nclass MouseRecord(object):\n    \"\"\"\n    è®°å½•é”®ç›˜é¼ æ ‡äº‹ä»¶å€¼jsonæ–‡ä»¶ï¼Œ\n    åŒ…æ‹¬é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®\n    é”®ç›˜æŒ‰ä¸‹ï¼Œæ”¾å¼€\n    \"\"\"\n    def __init__(self):\n        self.start_time = 0\n        self.mouse_list = []\n        self.running = True\n        self.save_file = \"mouselist.json\"\n\n    def get_time(self):\n        return time.time() - self.start_time\n\n    def on_click(self, x, y, button, pressed):\n        \"\"\"\n        clickäº‹ä»¶\n        \"\"\"\n        if not self.running:\n            return False\n        if not pressed:\n            return True\n        self.mouse_list.append({\n            \"opera\": \"click\",\n            \"posix\": x,\n            \"posiy\": y,\n            \"button\": str(button),\n            \"stime\": self.get_time()\n        })\n        print(x, y, button, pressed)\n\n    def on_move(self, x, y):\n        \"\"\"\n        é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼ŒåŠ ä¸ªéšæœºå‡å°‘å­˜å‚¨\n        \"\"\"\n        if random.randint(0, 2) == 1:\n            self.mouse_list.append({\n                \"opera\": \"move\",\n                \"posix\": x,\n                \"posiy\": y,\n                \"stime\": self.get_time()\n            })\n\n    def on_scroll(self, x, y, dx, dy):\n        \"\"\"\n        é¼ æ ‡æ»šåŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse_list.append({\n            \"opera\": \"scroll\",\n            \"posix\": x,\n            \"posiy\": y,\n            \"scrollx\": dx,\n            \"scrolly\": dy,\n            \"stime\": self.get_time()\n        })\n\n    def on_key_press(self, key):\n        \"\"\"\n        é”®ç›˜æŒ‰ä¸‹äº‹ä»¶ï¼Œæ­£å¸¸å»ºæ˜¯ç›´æ¥å±•ç¤ºå­—ç¬¦ï¼Œç‰¹æ®Šé”®ä¼šè¿”å›Key.xxx\n        æŒ‰ä¸‹escçš„æ—¶å€™é€€å‡ºç›‘å¬\n        \"\"\"\n        if key == pynput.keyboard.Key.esc:\n            self.running = False\n            mouse = pynput.mouse.Controller()\n            mouse.click(pynput.mouse.Button.left)\n            return self.running\n        if str(key) != \"<0>\":\n            self.mouse_list.append({\n                \"opera\": \"press\",\n                \"key\": str(key).strip(\"'\"),\n                \"stime\": self.get_time()\n            })\n\n    def on_key_release(self, key):\n        \"\"\"\n        é”®ç›˜é‡Šæ”¾äº‹ä»¶\n        \"\"\"\n        if str(key) != \"<0>\":\n            self.mouse_list.append({\n                \"opera\": \"release\",\n                \"key\": str(key).strip(\"'\"),\n                \"stime\": self.get_time()\n            })\n\n    def mouse_listen(self):\n        \"\"\"\n        å¼€å¯é¼ æ ‡ç›‘å¬\n        \"\"\"\n        with pynput.mouse.Listener(on_move=self.on_move, on_click=self.on_click, on_scroll=self.on_scroll) as listener:\n            listener.join()\n\n    def key_listen(self):\n        \"\"\"\n        å¼€å¯é”®ç›˜ç›‘å¬\n        \"\"\"\n        with pynput.keyboard.Listener(on_press=self.on_key_press, on_release=self.on_key_release) as listener:\n            listener.join()\n\n    def run(self):\n        \"\"\"\n        è¿è¡Œç›‘å¬ï¼Œç»“æŸåä¿å­˜ä¸ºjsonæ–‡ä»¶\n        \"\"\"\n        self.start_time = time.time()\n        t1 = threading.Thread(target=self.mouse_listen)\n        t2 = threading.Thread(target=self.key_listen)\n        t1.start()\n        t2.start()\n        t1.join()\n        t2.join()\n        print(json.dumps(self.mouse_list), file=open(self.save_file, \"w\"))\n\n\nclass MouseRecover(object):\n    \"\"\"\n    è¿˜åŸé”®ç›˜é¼ æ ‡äº‹ä»¶\n    \"\"\"\n    def __init__(self):\n        self.start_time = 0\n        self.mouse = pynput.mouse.Controller()\n        self.keyboard = pynput.keyboard.Controller()\n        self.buttons = {\n            \"Button.left\": pynput.mouse.Button.left,\n            \"Button.right\": pynput.mouse.Button.right\n        }\n        self.read_file = \"mouselist.json\"\n\n    def deal_click(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡ç‚¹å‡»äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n        time.sleep(0.1)\n        self.mouse.click(self.buttons.get(record.get(\"button\")))\n\n    def deal_move(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡ç§»åŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n\n    def deal_scroll(self, record):\n        \"\"\"\n        å¤„ç†é¼ æ ‡æ»šåŠ¨äº‹ä»¶\n        \"\"\"\n        self.mouse.position = (record.get(\"posix\"), record.get(\"posiy\"))\n        self.mouse.scroll(record.get(\"scrollx\"), record.get(\"scrolly\"))\n\n    def deal_key_press(self, record):\n        \"\"\"\n        å¤„ç†é”®ç›˜æŒ‰ä¸‹äº‹ä»¶\n        \"\"\"\n        if record.get(\"key\").startswith(\"Key\"):\n            self.keyboard.press(eval(record.get(\"key\"), {}, {\n                \"Key\": pynput.keyboard.Key\n            }))\n        else:\n            self.keyboard.press(record.get(\"key\"))\n\n    def deal_key_release(self, record):\n        \"\"\"\n        å¤„ç†é”®ç›˜é‡Šæ”¾äº‹ä»¶\n        \"\"\"\n        if record.get(\"key\").startswith(\"Key\"):\n            self.keyboard.release(eval(record.get(\"key\"), {}, {\n                \"Key\": pynput.keyboard.Key\n            }))\n        else:\n            self.keyboard.release(record.get(\"key\"))\n\n    def run(self):\n        \"\"\"\n        è¯»å–jsonæ–‡ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶\n        \"\"\"\n        data = json.load(open(self.read_file, \"r\"))\n        for item in data:\n            if item.get(\"opera\") == \"click\":\n                self.deal_click(item)\n            if item.get(\"opera\") == \"move\":\n                self.deal_move(item)\n            if item.get(\"opera\") == \"scroll\":\n                self.deal_scroll(item)\n            if item.get(\"opera\") == \"press\":\n                self.deal_key_press(item)\n            if item.get(\"opera\") == \"release\":\n                self.deal_key_release(item)\n            time.sleep(item.get(\"stime\") - self.start_time)\n            self.start_time = item.get(\"stime\")\n\n\nif __name__ == \"__main__\":\n    #è®°å½•äº‹ä»¶\n    t = MouseRecord()\n    t.run()\n\n    # è¿è¡Œäº‹ä»¶\n    # tt = MouseRecover()\n    # tt.run()\n```\n\n## ä½¿ç”¨\n\n- å…ˆè¿è¡ŒMouseRecordçš„runï¼Œç„¶åå°±å·²ç»å¼€å¯è®°å½•ï¼Œæ“ä½œä¸€éåæŒ‰escé€€å‡ºè®°å½•ï¼›\n- åœ¨è¿è¡ŒMouseRecoverçš„runï¼Œç„¶åå°±ä¼šæŠŠåˆšåˆšä¸­é—´è®°å½•çš„æ“ä½œæ‰§è¡Œä¸€éï¼›ï¼ˆæ“ä½œæœ€å¥½å¯é‡å¤è¿˜åŸçš„ï¼‰\n\n## åæœŸéæƒ³\n\n- å¯ä»¥å¯¹ä¿å­˜çš„æ“ä½œé“¾è·¯è¿›è¡Œç¼–è¾‘ï¼Œåœ¨æ‰§è¡Œæ—¶æ’å…¥ä¸€äº›å˜é‡ï¼›\n\n## å‚è€ƒå‹å†›\n- [è®°å½•ä½ çš„æ“ä½œâ€”â€”pynputæ¨¡æ‹Ÿå’Œç›‘å¬é”®ç›˜é¼ æ ‡æ“ä½œ](https://www.jianshu.com/p/11a8e75f5170)","slug":"pynputå®ç°é¼ æ ‡é”®ç›˜æ“ä½œçš„ç›‘æ§ä¸è¿˜åŸ","published":1,"updated":"2020-04-02T04:51:42.290Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7e0007pb0jlnx9ufqa","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>å¿ƒè¡€æ¥æ½®ï¼Œå®ç°ä¸€æ³¢è®°å½•æ“ä½œå¹¶è¿˜åŸæ“ä½œï¼Œå¯ç”¨çš„åœºæ™¯è¯´ä¸å®šè¿˜æŒºå¤šã€‚<br>\nè¿™æ¬¡å®ç°çš„è®°å½•å’Œè¿˜åŸçš„æ“ä½œåŒ…æ‹¬</p>\n<ul>\n<li>é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®</li>\n<li>é”®ç›˜çš„æŒ‰ä¸‹ï¼Œæ¾å¼€</li>\n</ul>\n<h2 id=\"å‰æœŸå‡†å¤‡\">å‰æœŸå‡†å¤‡</h2>\n<p>ä½¿ç”¨pynputå°±å¯ä»¥å®Œç¾çš„å®ç°ä¸Šé¢éœ€æ±‚ï¼Œè€Œä¸”ç”¨ç€è¿˜æŒºç®€å•ï¼›<br>\nå…·ä½“åŒ…è¯¦ç»†æ¥å£ä¸ä½¿ç”¨è¯´æ˜çœ‹å¦‚ä¸‹å›¾ï¼š<br>\n<img src=\"/img/mypost/pynput.png\" alt=\"å›¾\"></p>\n<h2 id=\"å…·ä½“å®ç°\">å…·ä½“å®ç°</h2>\n<p>ä½¿ç”¨python3ç¼–å†™ï¼Œåœ¨macç¯å¢ƒä¸‹è¿è¡Œè‰¯å¥½ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> pynput</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MouseRecord</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    è®°å½•é”®ç›˜é¼ æ ‡äº‹ä»¶å€¼jsonæ–‡ä»¶ï¼Œ</span></span><br><span class=\"line\"><span class=\"string\">    åŒ…æ‹¬é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®</span></span><br><span class=\"line\"><span class=\"string\">    é”®ç›˜æŒ‰ä¸‹ï¼Œæ”¾å¼€</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.start_time = <span class=\"number\">0</span></span><br><span class=\"line\">        self.mouse_list = []</span><br><span class=\"line\">        self.running = <span class=\"keyword\">True</span></span><br><span class=\"line\">        self.save_file = <span class=\"string\">\"mouselist.json\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_time</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> time.time() - self.start_time</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_click</span><span class=\"params\">(self, x, y, button, pressed)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        clickäº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> self.running:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">False</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> pressed:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">True</span></span><br><span class=\"line\">        self.mouse_list.append(&#123;</span><br><span class=\"line\">            <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"click\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">            <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">            <span class=\"string\">\"button\"</span>: str(button),</span><br><span class=\"line\">            <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        print(x, y, button, pressed)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_move</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼ŒåŠ ä¸ªéšæœºå‡å°‘å­˜å‚¨</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> random.randint(<span class=\"number\">0</span>, <span class=\"number\">2</span>) == <span class=\"number\">1</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"move\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">                <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_scroll</span><span class=\"params\">(self, x, y, dx, dy)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é¼ æ ‡æ»šåŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse_list.append(&#123;</span><br><span class=\"line\">            <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"scroll\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">            <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">            <span class=\"string\">\"scrollx\"</span>: dx,</span><br><span class=\"line\">            <span class=\"string\">\"scrolly\"</span>: dy,</span><br><span class=\"line\">            <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_key_press</span><span class=\"params\">(self, key)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é”®ç›˜æŒ‰ä¸‹äº‹ä»¶ï¼Œæ­£å¸¸å»ºæ˜¯ç›´æ¥å±•ç¤ºå­—ç¬¦ï¼Œç‰¹æ®Šé”®ä¼šè¿”å›Key.xxx</span></span><br><span class=\"line\"><span class=\"string\">        æŒ‰ä¸‹escçš„æ—¶å€™é€€å‡ºç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> key == pynput.keyboard.Key.esc:</span><br><span class=\"line\">            self.running = <span class=\"keyword\">False</span></span><br><span class=\"line\">            mouse = pynput.mouse.Controller()</span><br><span class=\"line\">            mouse.click(pynput.mouse.Button.left)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.running</span><br><span class=\"line\">        <span class=\"keyword\">if</span> str(key) != <span class=\"string\">\"&lt;0&gt;\"</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"press\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"key\"</span>: str(key).strip(<span class=\"string\">\"'\"</span>),</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_key_release</span><span class=\"params\">(self, key)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é”®ç›˜é‡Šæ”¾äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> str(key) != <span class=\"string\">\"&lt;0&gt;\"</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"release\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"key\"</span>: str(key).strip(<span class=\"string\">\"'\"</span>),</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mouse_listen</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¼€å¯é¼ æ ‡ç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> pynput.mouse.Listener(on_move=self.on_move, on_click=self.on_click, on_scroll=self.on_scroll) <span class=\"keyword\">as</span> listener:</span><br><span class=\"line\">            listener.join()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">key_listen</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¼€å¯é”®ç›˜ç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> pynput.keyboard.Listener(on_press=self.on_key_press, on_release=self.on_key_release) <span class=\"keyword\">as</span> listener:</span><br><span class=\"line\">            listener.join()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        è¿è¡Œç›‘å¬ï¼Œç»“æŸåä¿å­˜ä¸ºjsonæ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.start_time = time.time()</span><br><span class=\"line\">        t1 = threading.Thread(target=self.mouse_listen)</span><br><span class=\"line\">        t2 = threading.Thread(target=self.key_listen)</span><br><span class=\"line\">        t1.start()</span><br><span class=\"line\">        t2.start()</span><br><span class=\"line\">        t1.join()</span><br><span class=\"line\">        t2.join()</span><br><span class=\"line\">        print(json.dumps(self.mouse_list), file=open(self.save_file, <span class=\"string\">\"w\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MouseRecover</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    è¿˜åŸé”®ç›˜é¼ æ ‡äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.start_time = <span class=\"number\">0</span></span><br><span class=\"line\">        self.mouse = pynput.mouse.Controller()</span><br><span class=\"line\">        self.keyboard = pynput.keyboard.Controller()</span><br><span class=\"line\">        self.buttons = &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Button.left\"</span>: pynput.mouse.Button.left,</span><br><span class=\"line\">            <span class=\"string\">\"Button.right\"</span>: pynput.mouse.Button.right</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        self.read_file = <span class=\"string\">\"mouselist.json\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_click</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡ç‚¹å‡»äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.1</span>)</span><br><span class=\"line\">        self.mouse.click(self.buttons.get(record.get(<span class=\"string\">\"button\"</span>)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_move</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡ç§»åŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_scroll</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡æ»šåŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\">        self.mouse.scroll(record.get(<span class=\"string\">\"scrollx\"</span>), record.get(<span class=\"string\">\"scrolly\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_key_press</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é”®ç›˜æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> record.get(<span class=\"string\">\"key\"</span>).startswith(<span class=\"string\">\"Key\"</span>):</span><br><span class=\"line\">            self.keyboard.press(eval(record.get(<span class=\"string\">\"key\"</span>), &#123;&#125;, &#123;</span><br><span class=\"line\">                <span class=\"string\">\"Key\"</span>: pynput.keyboard.Key</span><br><span class=\"line\">            &#125;))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            self.keyboard.press(record.get(<span class=\"string\">\"key\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_key_release</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é”®ç›˜é‡Šæ”¾äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> record.get(<span class=\"string\">\"key\"</span>).startswith(<span class=\"string\">\"Key\"</span>):</span><br><span class=\"line\">            self.keyboard.release(eval(record.get(<span class=\"string\">\"key\"</span>), &#123;&#125;, &#123;</span><br><span class=\"line\">                <span class=\"string\">\"Key\"</span>: pynput.keyboard.Key</span><br><span class=\"line\">            &#125;))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            self.keyboard.release(record.get(<span class=\"string\">\"key\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        è¯»å–jsonæ–‡ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        data = json.load(open(self.read_file, <span class=\"string\">\"r\"</span>))</span><br><span class=\"line\">        <span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"click\"</span>:</span><br><span class=\"line\">                self.deal_click(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"move\"</span>:</span><br><span class=\"line\">                self.deal_move(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"scroll\"</span>:</span><br><span class=\"line\">                self.deal_scroll(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"press\"</span>:</span><br><span class=\"line\">                self.deal_key_press(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"release\"</span>:</span><br><span class=\"line\">                self.deal_key_release(item)</span><br><span class=\"line\">            time.sleep(item.get(<span class=\"string\">\"stime\"</span>) - self.start_time)</span><br><span class=\"line\">            self.start_time = item.get(<span class=\"string\">\"stime\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    <span class=\"comment\">#è®°å½•äº‹ä»¶</span></span><br><span class=\"line\">    t = MouseRecord()</span><br><span class=\"line\">    t.run()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è¿è¡Œäº‹ä»¶</span></span><br><span class=\"line\">    <span class=\"comment\"># tt = MouseRecover()</span></span><br><span class=\"line\">    <span class=\"comment\"># tt.run()</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"ä½¿ç”¨\">ä½¿ç”¨</h2>\n<ul>\n<li>å…ˆè¿è¡ŒMouseRecordçš„runï¼Œç„¶åå°±å·²ç»å¼€å¯è®°å½•ï¼Œæ“ä½œä¸€éåæŒ‰escé€€å‡ºè®°å½•ï¼›</li>\n<li>åœ¨è¿è¡ŒMouseRecoverçš„runï¼Œç„¶åå°±ä¼šæŠŠåˆšåˆšä¸­é—´è®°å½•çš„æ“ä½œæ‰§è¡Œä¸€éï¼›ï¼ˆæ“ä½œæœ€å¥½å¯é‡å¤è¿˜åŸçš„ï¼‰</li>\n</ul>\n<h2 id=\"åæœŸéæƒ³\">åæœŸéæƒ³</h2>\n<ul>\n<li>å¯ä»¥å¯¹ä¿å­˜çš„æ“ä½œé“¾è·¯è¿›è¡Œç¼–è¾‘ï¼Œåœ¨æ‰§è¡Œæ—¶æ’å…¥ä¸€äº›å˜é‡ï¼›</li>\n</ul>\n<h2 id=\"å‚è€ƒå‹å†›\">å‚è€ƒå‹å†›</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/11a8e75f5170\" target=\"_blank\" rel=\"noopener\">è®°å½•ä½ çš„æ“ä½œâ€”â€”pynputæ¨¡æ‹Ÿå’Œç›‘å¬é”®ç›˜é¼ æ ‡æ“ä½œ</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2>å‰è¨€</h2>\n<p>å¿ƒè¡€æ¥æ½®ï¼Œå®ç°ä¸€æ³¢è®°å½•æ“ä½œå¹¶è¿˜åŸæ“ä½œï¼Œå¯ç”¨çš„åœºæ™¯è¯´ä¸å®šè¿˜æŒºå¤šã€‚<br>\nè¿™æ¬¡å®ç°çš„è®°å½•å’Œè¿˜åŸçš„æ“ä½œåŒ…æ‹¬</p>\n<ul>\n<li>é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®</li>\n<li>é”®ç›˜çš„æŒ‰ä¸‹ï¼Œæ¾å¼€</li>\n</ul>\n<h2>å‰æœŸå‡†å¤‡</h2>\n<p>ä½¿ç”¨pynputå°±å¯ä»¥å®Œç¾çš„å®ç°ä¸Šé¢éœ€æ±‚ï¼Œè€Œä¸”ç”¨ç€è¿˜æŒºç®€å•ï¼›<br>\nå…·ä½“åŒ…è¯¦ç»†æ¥å£ä¸ä½¿ç”¨è¯´æ˜çœ‹å¦‚ä¸‹å›¾ï¼š<br>\n<img src=\"/img/mypost/pynput.png\" alt=\"å›¾\"></p>\n<h2>å…·ä½“å®ç°</h2>\n<p>ä½¿ç”¨python3ç¼–å†™ï¼Œåœ¨macç¯å¢ƒä¸‹è¿è¡Œè‰¯å¥½ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> pynput</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MouseRecord</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    è®°å½•é”®ç›˜é¼ æ ‡äº‹ä»¶å€¼jsonæ–‡ä»¶ï¼Œ</span></span><br><span class=\"line\"><span class=\"string\">    åŒ…æ‹¬é¼ æ ‡ç§»åŠ¨ï¼Œæ»šåŠ¨ï¼Œå·¦å³é”®</span></span><br><span class=\"line\"><span class=\"string\">    é”®ç›˜æŒ‰ä¸‹ï¼Œæ”¾å¼€</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.start_time = <span class=\"number\">0</span></span><br><span class=\"line\">        self.mouse_list = []</span><br><span class=\"line\">        self.running = <span class=\"keyword\">True</span></span><br><span class=\"line\">        self.save_file = <span class=\"string\">\"mouselist.json\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_time</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> time.time() - self.start_time</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_click</span><span class=\"params\">(self, x, y, button, pressed)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        clickäº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> self.running:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">False</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> pressed:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">True</span></span><br><span class=\"line\">        self.mouse_list.append(&#123;</span><br><span class=\"line\">            <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"click\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">            <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">            <span class=\"string\">\"button\"</span>: str(button),</span><br><span class=\"line\">            <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        print(x, y, button, pressed)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_move</span><span class=\"params\">(self, x, y)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼ŒåŠ ä¸ªéšæœºå‡å°‘å­˜å‚¨</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> random.randint(<span class=\"number\">0</span>, <span class=\"number\">2</span>) == <span class=\"number\">1</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"move\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">                <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_scroll</span><span class=\"params\">(self, x, y, dx, dy)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é¼ æ ‡æ»šåŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse_list.append(&#123;</span><br><span class=\"line\">            <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"scroll\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"posix\"</span>: x,</span><br><span class=\"line\">            <span class=\"string\">\"posiy\"</span>: y,</span><br><span class=\"line\">            <span class=\"string\">\"scrollx\"</span>: dx,</span><br><span class=\"line\">            <span class=\"string\">\"scrolly\"</span>: dy,</span><br><span class=\"line\">            <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_key_press</span><span class=\"params\">(self, key)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é”®ç›˜æŒ‰ä¸‹äº‹ä»¶ï¼Œæ­£å¸¸å»ºæ˜¯ç›´æ¥å±•ç¤ºå­—ç¬¦ï¼Œç‰¹æ®Šé”®ä¼šè¿”å›Key.xxx</span></span><br><span class=\"line\"><span class=\"string\">        æŒ‰ä¸‹escçš„æ—¶å€™é€€å‡ºç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> key == pynput.keyboard.Key.esc:</span><br><span class=\"line\">            self.running = <span class=\"keyword\">False</span></span><br><span class=\"line\">            mouse = pynput.mouse.Controller()</span><br><span class=\"line\">            mouse.click(pynput.mouse.Button.left)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> self.running</span><br><span class=\"line\">        <span class=\"keyword\">if</span> str(key) != <span class=\"string\">\"&lt;0&gt;\"</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"press\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"key\"</span>: str(key).strip(<span class=\"string\">\"'\"</span>),</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">on_key_release</span><span class=\"params\">(self, key)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        é”®ç›˜é‡Šæ”¾äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> str(key) != <span class=\"string\">\"&lt;0&gt;\"</span>:</span><br><span class=\"line\">            self.mouse_list.append(&#123;</span><br><span class=\"line\">                <span class=\"string\">\"opera\"</span>: <span class=\"string\">\"release\"</span>,</span><br><span class=\"line\">                <span class=\"string\">\"key\"</span>: str(key).strip(<span class=\"string\">\"'\"</span>),</span><br><span class=\"line\">                <span class=\"string\">\"stime\"</span>: self.get_time()</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">mouse_listen</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¼€å¯é¼ æ ‡ç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> pynput.mouse.Listener(on_move=self.on_move, on_click=self.on_click, on_scroll=self.on_scroll) <span class=\"keyword\">as</span> listener:</span><br><span class=\"line\">            listener.join()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">key_listen</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¼€å¯é”®ç›˜ç›‘å¬</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> pynput.keyboard.Listener(on_press=self.on_key_press, on_release=self.on_key_release) <span class=\"keyword\">as</span> listener:</span><br><span class=\"line\">            listener.join()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        è¿è¡Œç›‘å¬ï¼Œç»“æŸåä¿å­˜ä¸ºjsonæ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.start_time = time.time()</span><br><span class=\"line\">        t1 = threading.Thread(target=self.mouse_listen)</span><br><span class=\"line\">        t2 = threading.Thread(target=self.key_listen)</span><br><span class=\"line\">        t1.start()</span><br><span class=\"line\">        t2.start()</span><br><span class=\"line\">        t1.join()</span><br><span class=\"line\">        t2.join()</span><br><span class=\"line\">        print(json.dumps(self.mouse_list), file=open(self.save_file, <span class=\"string\">\"w\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MouseRecover</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    è¿˜åŸé”®ç›˜é¼ æ ‡äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.start_time = <span class=\"number\">0</span></span><br><span class=\"line\">        self.mouse = pynput.mouse.Controller()</span><br><span class=\"line\">        self.keyboard = pynput.keyboard.Controller()</span><br><span class=\"line\">        self.buttons = &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Button.left\"</span>: pynput.mouse.Button.left,</span><br><span class=\"line\">            <span class=\"string\">\"Button.right\"</span>: pynput.mouse.Button.right</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        self.read_file = <span class=\"string\">\"mouselist.json\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_click</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡ç‚¹å‡»äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.1</span>)</span><br><span class=\"line\">        self.mouse.click(self.buttons.get(record.get(<span class=\"string\">\"button\"</span>)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_move</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡ç§»åŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_scroll</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é¼ æ ‡æ»šåŠ¨äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.mouse.position = (record.get(<span class=\"string\">\"posix\"</span>), record.get(<span class=\"string\">\"posiy\"</span>))</span><br><span class=\"line\">        self.mouse.scroll(record.get(<span class=\"string\">\"scrollx\"</span>), record.get(<span class=\"string\">\"scrolly\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_key_press</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é”®ç›˜æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> record.get(<span class=\"string\">\"key\"</span>).startswith(<span class=\"string\">\"Key\"</span>):</span><br><span class=\"line\">            self.keyboard.press(eval(record.get(<span class=\"string\">\"key\"</span>), &#123;&#125;, &#123;</span><br><span class=\"line\">                <span class=\"string\">\"Key\"</span>: pynput.keyboard.Key</span><br><span class=\"line\">            &#125;))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            self.keyboard.press(record.get(<span class=\"string\">\"key\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">deal_key_release</span><span class=\"params\">(self, record)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        å¤„ç†é”®ç›˜é‡Šæ”¾äº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> record.get(<span class=\"string\">\"key\"</span>).startswith(<span class=\"string\">\"Key\"</span>):</span><br><span class=\"line\">            self.keyboard.release(eval(record.get(<span class=\"string\">\"key\"</span>), &#123;&#125;, &#123;</span><br><span class=\"line\">                <span class=\"string\">\"Key\"</span>: pynput.keyboard.Key</span><br><span class=\"line\">            &#125;))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            self.keyboard.release(record.get(<span class=\"string\">\"key\"</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        è¯»å–jsonæ–‡ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        data = json.load(open(self.read_file, <span class=\"string\">\"r\"</span>))</span><br><span class=\"line\">        <span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"click\"</span>:</span><br><span class=\"line\">                self.deal_click(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"move\"</span>:</span><br><span class=\"line\">                self.deal_move(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"scroll\"</span>:</span><br><span class=\"line\">                self.deal_scroll(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"press\"</span>:</span><br><span class=\"line\">                self.deal_key_press(item)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> item.get(<span class=\"string\">\"opera\"</span>) == <span class=\"string\">\"release\"</span>:</span><br><span class=\"line\">                self.deal_key_release(item)</span><br><span class=\"line\">            time.sleep(item.get(<span class=\"string\">\"stime\"</span>) - self.start_time)</span><br><span class=\"line\">            self.start_time = item.get(<span class=\"string\">\"stime\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    <span class=\"comment\">#è®°å½•äº‹ä»¶</span></span><br><span class=\"line\">    t = MouseRecord()</span><br><span class=\"line\">    t.run()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è¿è¡Œäº‹ä»¶</span></span><br><span class=\"line\">    <span class=\"comment\"># tt = MouseRecover()</span></span><br><span class=\"line\">    <span class=\"comment\"># tt.run()</span></span><br></pre></td></tr></table></figure>\n<h2>ä½¿ç”¨</h2>\n<ul>\n<li>å…ˆè¿è¡ŒMouseRecordçš„runï¼Œç„¶åå°±å·²ç»å¼€å¯è®°å½•ï¼Œæ“ä½œä¸€éåæŒ‰escé€€å‡ºè®°å½•ï¼›</li>\n<li>åœ¨è¿è¡ŒMouseRecoverçš„runï¼Œç„¶åå°±ä¼šæŠŠåˆšåˆšä¸­é—´è®°å½•çš„æ“ä½œæ‰§è¡Œä¸€éï¼›ï¼ˆæ“ä½œæœ€å¥½å¯é‡å¤è¿˜åŸçš„ï¼‰</li>\n</ul>\n<h2>åæœŸéæƒ³</h2>\n<ul>\n<li>å¯ä»¥å¯¹ä¿å­˜çš„æ“ä½œé“¾è·¯è¿›è¡Œç¼–è¾‘ï¼Œåœ¨æ‰§è¡Œæ—¶æ’å…¥ä¸€äº›å˜é‡ï¼›</li>\n</ul>\n<h2>å‚è€ƒå‹å†›</h2>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/11a8e75f5170\" target=\"_blank\" rel=\"noopener\">è®°å½•ä½ çš„æ“ä½œâ€”â€”pynputæ¨¡æ‹Ÿå’Œç›‘å¬é”®ç›˜é¼ æ ‡æ“ä½œ</a></li>\n</ul>\n"},{"title":"åˆåŒå’å•å»ºåšå®¢","catalog":true,"toc_nav_num":true,"date":"2019-11-13T09:05:00.000Z","subtitle":"è®²è®²æœ¬æ¬¡å»ºåšå®¢ä¸­é—´é‚£äº›äº‹","header-img":"/img/article_header/header.jpg","_content":"\n## å‰è¨€\n\nç¬¬äºŒæ¬¡æ­å»ºåšå®¢äº†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨çš„è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºäº†wordpressåšå®¢ï¼Œå†™äº†ä¸¤å¹´å·¦å³60+ç¯‡ï¼Œåœ¨æœåŠ¡å™¨åºŸå¼ƒåä¹Ÿä¸å†ç»´æŠ¤äº†ã€‚\n\næœ¬æ¬¡åˆå¿ƒè¡€æ¥æ½®ï¼Œä½¿ç”¨nodeçš„hexoå’Œgithubçš„gh-pagesæ¥æ­å»ºã€‚\n\nå¼€ç¯‡å°±ä»¥åšå®¢æ­å»ºè¿‡ç¨‹ä¸ºä¸»è¦å†…å®¹ã€‚\n\n## å·¥å…·å‡†å¤‡\n\n> git, node, githubè´¦å·, vscode(éå¿…å¤‡), åŸŸå(éå¿…å¤‡)\n\nè¿™é‡Œéœ€è¦è‡ªè¡Œæœç´¢å­¦ä¹ å®‰è£…äº†\n\n## åŠ¨æ‰‹æ­å»º\n\n> è´´ä¸ªå®˜æ–¹åœ°å€\n> https://hexo.io/zh-cn/\n\nè¿™é‡Œå°±ä¸è·Ÿç€å®˜æ–¹æ•™ç¨‹èµ°äº†ï¼Œä¸è¿‡å¤§åŒå°å¼‚\n\nå…ˆåˆ° [ä¸»é¢˜é¡µ](https://hexo.io/themes/) æ‰¾ä¸ªå–œæ¬¢çš„ä¸»é¢˜\n\nè¿™é‡Œé€‰äº† [A-Boy](https://github.com/huweihuang/hexo-theme-huweihuang) è¿™ä¸ªä¸»é¢˜ï¼ŒğŸ™„ä¸»è¦æ˜¯ä»–æ¯”è¾ƒåƒæˆ‘ä¹‹å‰çš„åšå®¢é£æ ¼ã€‚\n\n```\n# ä¸‹è½½hexoå‘½ä»¤è¡Œå·¥å…·\nnpm install hexo-cli -g\n\n# åˆ›å»ºæ–‡ä»¶å¤¹\nmkdir blog\n\n# \bä¸‹è½½ä¸»é¢˜åˆ°è¯¥æ–‡ä»¶å¤¹\ngit clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./blog\n\n# ä¸‹è½½ä¾èµ–åŒ…\ncd blog\nnpm install\n```\n\næ–‡ä»¶ç»„ç»‡ç»“æ„å¤§è‡´å¦‚ä¸‹\n```\n/_config.xml\nä¸»è¦é…ç½®æ–‡ä»¶\n\n/source\nå­˜æ”¾æ–‡ç«  ./_posts\nå›¾ç‰‡ ./img\n\n/themes\nä¸»é¢˜çš„ä¸€äº›æ¨¡æ¿æ–‡ä»¶\n\n/scaffolds\nä¸€äº›è„šæ‰‹æ¶ï¼ŒåŸç”Ÿå°±åœ¨\n\n/node_modules\nå¤–éƒ¨ä¾èµ–çš„æ¨¡å—\n\n/db.json\nå­˜å‚¨æœåŠ¡å™¨è§£æå‡ºæ¥çš„ä¸´æ—¶æ–‡ç« æ•°æ®\n\n/è¿˜æœ‰ä¸€äº›æš‚æ—¶ç”¨ä¸åˆ°çš„æ–‡ä»¶\n```\n\nå…ˆåˆ°githubå»ºç«‹è‡ªå·±çš„ä»“åº“ï¼Œå°±é•¿ä¸‹é¢è¿™æ ·\n![github](/img/mypost/github.png)\n\nç„¶åå¯¹ä¸»é¢˜çš„_config.xmlä¸€äº›é…ç½®é¡¹\n```\n# é…ç½®åˆšæ‰çš„githubä»“åº“, ä¸€èˆ¬ä½¿ç”¨gh-pagesåˆ†æ”¯\ndeploy:\n  type: git\n  repo: https://github.com/<yourAccount>/<repo>\n  branch: <your-branch>\n```\n\n```\n# é…ç½®è·¯ç”±ï¼Œè¿™é‡Œä½¿ç”¨åŸŸåçš„ç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„ä¼šæœ‰ä¸ªå‘->å›¾ç‰‡å†™ç»å¯¹è·¯å¾„æ—¶ä¸ä¼šæŠŠrootè·¯å¾„åŠ ä¸Š\nurl: http://ganjiacheng.cn/\nroot: /\n```\n\n```\n# é…ç½®ä¸»é¢˜ï¼Œ/theme/ä¸‹çš„å­ç›®å½•æ–‡ä»¶å¤¹\ntheme: huweihuang\n```\n\n```\n# ä¾§è¾¹æ çš„ä¸€äº›é…ç½®\nsidebar: true    \nsidebar-about-description: \"<your description>\"\nsidebar-avatar: img/<your avatar path>\nwidgets:  \n- featured-tags\n- short-about\n- recent-posts\n- friends-blog\n- archive\n- category\n```\n\n```\n# markdownç¼–è¯‘å™¨çš„ä¸€äº›é…ç½®\nmarkdown:\n  render:\n    html: true\n    xhtmlOut: false\n    breaks: true\n    linkify: true\n    typographer: true\n    quotes: 'â€œâ€â€˜â€™'\n```\n\nè¿™é‡Œæœ‰é…ç½®èƒŒæ™¯å›¾\næ¨èä¸€ä¸ªå¸¸ç”¨çš„[å£çº¸ç½‘ç«™](https://bing.ioliu.cn/)\n\n\nä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤è¡Œå‘½ä»¤\n```\n# æ–°å»ºæ–‡ç« \nhexo new post \"<post name>\" \n\n# åˆ é™¤ä¸´æ—¶æ•°æ®åº“\nhexo clean\n\n# ç¼–è¯‘ä¸ºhtml\nhexo generate \n\n# å¼€å¯server\nhexo server\n\n# ä¸Šä¼ åˆ°githubï¼Œç¬¬ä¸€æ¬¡è¦å†™è´¦å·å¯†ç ï¼Œåé¢å°±ä¸ç”¨äº†\nhexo deploy \n```\n\n## ä½¿ç”¨vscodeå†™æ–‡ç« \n\næ‰“å¼€å»ºç«‹çš„é¡¹ç›®æ–‡ä»¶å¤¹\n\nåœ¨/source/_posts/ä¸‹æ–°å»ºmdæ–‡ä»¶ä¸ºæ–°æ–‡ç« \n\nç”±äºæ–‡ç« éƒ½æ˜¯markdownæ ¼å¼ï¼Œç”¨ä¸€èˆ¬æ–‡æœ¬ç¼–è¾‘å™¨æ¯”è¾ƒå›°éš¾ï¼Œæ•…è€Œé€‰åˆ™vscodeï¼Œå› ä¸ºå®ƒå¸¦markdownæ’ä»¶ï¼Œ  \nå…¶ä»–å¯é€‰æ‹©çš„ä¹Ÿæœ‰å†™æ–‡ç« çš„hexoæ’ä»¶ [hexo-admin](https://github.com/jaredly/hexo-admin)\n\ncommand+shift+p æœç´¢markdown open preview to the side\n\nå°±å¯ä»¥åœ¨å·¦è¾¹å†™å³è¾¹å®æ—¶æŸ¥çœ‹æ•ˆæœäº†\n\næ¨èä¸€ä¸ªè‡ªå·±è®°å½•æœ€ç®€markdownæ‰‹å†Œ [markdownæ‰‹å†Œ](https://github.com/webgjc/ApiTestToMd/blob/master/md/markdown.md)\n\nåœ¨markdownæ–‡ä»¶å¼€å¤´åŠ ä¸Šä¸€äº›æ–‡ç« çš„å¿…å¤‡ä¿¡æ¯\n```\n---\ntitle: \"æ ‡é¢˜\"\ndate: 1999-01-01 00:00:00\nsubtitle: \"å‰¯æ ‡é¢˜\"\nheader-img: \"/img/å›¾ç‰‡.jpg\"\ntags:\n- æ ‡ç­¾\n---\n```\n\nç„¶åå¼€å§‹å†™æ–‡ç« \n```\næ­¤å¤„çœç•¥ä¸€ä¸‡å­—\n```\n\n## ä»‹ç»ä¸€äº›æ’ä»¶\n\nåŸç”Ÿçš„åšå®¢ä¸å¸¦æ’ä»¶ï¼Œå°‘äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚ç»Ÿè®¡è®¿é—®æ¬¡æ•°ï¼Œè¯„è®ºç³»ç»Ÿç­‰ã€‚\n\nä¹Ÿæœ‰ä¸€äº›ä¸»é¢˜ä¹Ÿå†…ç½®äº†ä¸€äº›æ’ä»¶ï¼Œç›´æ¥é…ç½®å³å¯ã€‚\n\nç”±äºè¿™äº›åŠŸèƒ½éƒ½å¾—å¸¦åç«¯å­˜å‚¨ï¼Œè‡ªå·±åšä¸ªåˆéº»çƒ¦ï¼Œå› æ­¤ä½¿ç”¨ä¸€äº›åˆ«äººåšçš„å…è´¹çš„ã€‚\n\n### è®¿é—®æ¬¡æ•°æ’ä»¶\n\nè¿™é‡Œè¯•ç”¨ä¸‹ [ä¸è’œå­](http://busuanzi.ibruce.info/) æ¥åšè®¿é—®æ¬¡æ•°ã€‚\n\nç¼–è¾‘ /_config.yml åœ¨æœ€ååŠ ä¸Š\n```\nbusuanzi:\n  enable: true\n```\n\næ‰¾åˆ°/themes/ä¸»é¢˜å/layout/_partial/footer.ejs\n\nåœ¨åº•éƒ¨\\</footer>æ ‡ç­¾å‰åŠ ä¸Šï¼Œå°±æ˜¯ç½‘ç«™æ¬¡æ•°ç»Ÿè®¡ï¼Œæˆ–è€…è‡ªå·±æƒ³åŠ å“ªåŠ å“ª\n```\n<% if (theme.busuanzi && theme.busuanzi.enable){ %>\n    <script async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"></script>\n    <div style=\"text-align: center;\">\n        <span>\n            æœ¬ç«™æ€»è®¿é—®é‡<span id=\"busuanzi_value_site_pv\"></span>æ¬¡\n            </span>\n            <span class=\"post-meta-divider\">|</span>\n        <span>\n            æœ¬ç«™è®¿å®¢æ•°<span id=\"busuanzi_value_site_uv\"></span>äºº\n        </span>\n    </div>\n<% } %>\n```\nä¸‹é¢è¿™ä¸ªæ˜¯é¡µé¢è®¿é—®æ¬¡æ•°\n```\n<% if (theme.busuanzi && theme.busuanzi.enable){ %>\n    <span>\n        Viewed <span id=\"busuanzi_value_page_pv\"></span> times\n    </span>\n<% } %>\n```\n\n### è¯„è®ºæ’ä»¶\n\nè¿™é‡Œä½¿ç”¨çš„æ˜¯[valine](https://valine.js.org/) å’Œ [leancloud](https://leancloud.cn/)\n\nvalineæ˜¯å‰ç«¯éƒ¨åˆ†åµŒå…¥ç»„ä»¶ï¼Œleancloudæ¥å­˜å‚¨ä¿¡æ¯\n\næ³¨å†Œç­‰æ­¥éª¤å°±ä¸è´´äº†,çœ‹[è¿™é‡Œ](https://valine.js.org/quickstart.html)\n\nè¯´ä¸‹åµŒå…¥çš„éƒ¨åˆ†ï¼Œåœ¨/themes/ä¸»é¢˜å/post.ejs\n\næ‰¾ä¸ªåˆé€‚çš„æ ‡ç­¾ä¸‹é¢åŠ å…¥ï¼ŒåŸºæœ¬å°±å’Œä¸Šé¢æ–‡ç« å¯¹é½å°±è¡Œ\n\n```\n<script src='//unpkg.com/valine/dist/Valine.min.js'></script>\n<h5>COMMENT</h5>\n<div id=\"vcomments\"></div>\n<script>\n    new Valine({\n        el: '#vcomments',\n        appId: '<AppId>', #è¿™ä¸ªè¦æ³¨å†Œåæ‹¿åˆ°\n        appKey: '<AppKey>', #è¿™ä¸ªåŒä¸Š\n        notify:false, \n        verify:false, \n        avatar:'mp', \n        placeholder: 'æ¥äº†è€å¼Ÿ #markdownæ ¼å¼'\n    })\n    setTimeout(() => {\n        document.getElementsByClassName(\"info\")[0].style.display=\"none\";\n    }, 1000)\n</script>\n```\nç‰¹åœ°è¯´ä¸‹åŠ settimeouté‚£æ­¥æ˜¯ä¸ºäº†éšè—è‡ªå¸¦çš„powerä¿¡æ¯ğŸ™ƒ\n\nè¯„è®ºï¼Œç„¶åå°±å¯ä»¥åœ¨leancloud å­˜å‚¨->ç»“æ„åŒ–æ•°æ®->commentçœ‹åˆ°è¯„è®ºä¿¡æ¯\n\n\næ•²é»‘æ¿ï¼Œä¸‹é¢æ˜¯é‡ç‚¹ğŸ‘‡ğŸ˜ğŸ˜\n\n> å·¦è¾¹å¦¹å­çš„æ’ä»¶å°±æœä¸‹ [hexo live2d](https://www.baidu.com/s?ie=UTF-8&wd=hexo%20live2d) \n\n\n## åŸŸåé…ç½®\n\næœ€åæ¥äº†è§£ä¸€ä¸‹ä¸Šä¼ åˆ°githubååŸŸåé…ç½®ã€‚\n\nåœ¨ hexo deploy å‰\n\né…ç½® /source/CNAME, å†™è§£æåçš„åŸŸå\n\nåœ¨ä¹°åŸŸåçš„åŸŸåç®¡ç†å¤„è¿›è¡ŒåŸŸåè§£æ \n\nè®°å½•ç±»å‹CNAME => githubè´¦å·.github.io\n\nå°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®å•¦ï¼\n\n## å¤šç»ˆç«¯åŒæ­¥\n\nè¿™ä¸ªä¹Ÿå¾ˆå¸¸è§ï¼Œå°±æ˜¯åœ¨å¤šä¸ªåœ°æ–¹å†™åšå®¢ï¼Œæƒ³è¿™è¾¹å†™å®ŒåŒæ­¥åˆ°å„ä¸ªå®¢æˆ·ç«¯ã€‚\n\nå¦‚æœæ˜¯æœ‰è‡ªå·±æœåŠ¡å™¨çš„ï¼Œå°±è£…ä¸ªhexo-adminçš„æ’ä»¶ï¼Œå¼€å¯hexo serveråç›‘å¬åˆ°å…¬ç½‘ç«¯å£ï¼Œä¸æ”¾å¿ƒçš„è¯å…¥å£åŠ ä¸ªè®¤è¯ï¼Œå°±å¯ä»¥åœ¨çº¿ç¼–è¾‘ã€‚\n\nä¸€èˆ¬çš„åšæ³•æ˜¯ä½¿ç”¨åˆšæ‰å»ºçš„githubä»“åº“çš„masteråˆ†æ”¯ä½œä¸ºæ–‡ç« æºç ï¼Œgh-pagesåˆ†æ”¯ä½œä¸ºé™æ€åšå®¢ã€‚\n\n```\né¡¹ç›®æ ¹ç›®å½•ä¸‹/\n# å¼•å…¥git\ngit init\n\n# è®¾ç½®è¿œç¨‹åœ°å€\ngit remote add origin gitåœ°å€\n\n# pullä¸€ä¸‹è¿œç¨‹çš„æäº¤ï¼Œæœ‰å†²çªå°±è§£å†³ä¸‹/æ–‡ä»¶å¤‡ä»½/é‡å‘½å\ngit pull origin master --allow-unrelated-histories\n\n# æ·»åŠ .gitignoreï¼ŒåŠ å…¥\npublic/\n.vscode\nnode_modules\n\n# gitä¸‰è¿\ngit add .\ngit commit -m \"\"\ngit push origin master\n```\n\nç»ˆç«¯ä½¿ç”¨å†™åšå®¢å‰å…ˆclone / pullä¸€ä¸‹ï¼Œ\n\nå†™å®Œdeployå å† gitä¸‰è¿å°±è¡Œ\n\n## æ‹“å±•å†…å®¹\n\nè‡ªå»ºä¸»é¢˜\n\nåˆ«äººçš„ä¸»é¢˜è¦è‡ªå®šä¹‰çš„è¯è¿˜æ˜¯æ”¹å¾ˆå¤šï¼Œæœ‰æƒ³æ³•å¯ä»¥è‡ªè¡Œå¼€å‘ä¸»é¢˜\n\nä»ä¸Šé¢åŸºæœ¬ä¹Ÿå¯ä»¥çŸ¥é“ä¸»é¢˜çš„å°±æ˜¯åœ¨ /theme/ä¸‹åˆ›å»ºçš„æ–‡ä»¶å¤¹,  \nç„¶åä¿®æ”¹_config.ymlçš„ä¸»é¢˜é…ç½®\n\n```\nä¸»é¢˜ä¸‹ä¸»è¦æ–‡ä»¶ç»“æ„\n/layout # ä¸»è¦å¸ƒå±€ï¼Œæ ·å¼æ–‡ä»¶\n/source # å¤–éƒ¨js cssç­‰\n_config.yml # é…ç½®æ–‡ä»¶\n```\næ•°æ®ä¸»è¦é æ¨¡æ¿çš„æ–¹å¼åŠ è½½ï¼Œå…¶ä»–è¿˜æ˜¯å’ŒåŸç”Ÿjså·®ä¸å¤š\n\nè´´ä¸ªä¸é”™çš„[æ•™ç¨‹](https://www.cnblogs.com/yyhh/p/11058985.html)\n\n## æœ€åä¸€å¸­è¯\n\ngithubæœ‰æ—¶ä¼šè¢«å¢™ï¼Œæœ‰æ—¶ä¼šè®¿é—®æ…¢ï¼Œè¿™ä¸ªå›½å†…ä¸ä¸€å®šç¨³å®šğŸ¤”\n\nä½“éªŒæ¥è¯´ç›¸æ¯”äºç®€ä¹¦ç­‰æ¥è¯´ï¼Œæ­å»ºè¿‡ç¨‹è¿˜æ˜¯éœ€è¦ä¸€å®šåŸºç¡€ï¼Œå†™èµ·æ¥ä¹Ÿéƒ½markdownï¼Œ\n\nä½†èƒœåœ¨å¯ä»¥è‡ªå®šä¹‰èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿(è£…é€¼ä¸‡å²)ã€‚\n\nä¸ºäº†åšæŒå†™åšå®¢ä¹‹å‰ä¸€ç›´ç”¨çš„æ˜¯å…ˆç«‹æ ‡é¢˜æ–‡ç« ï¼Œå‡ æ˜ŸæœŸè¿‡å»æœ‰æƒ³æ³•å’Œæ–¹æ³•äº†å†å»å¡«å……å®Œæˆå‰©ä¸‹çš„æ–‡ç« å†…å®¹ï¼Œè¿™ä¸ªä¸€ç›´éƒ½è¿˜ä¸é”™ã€‚\n\nå¸Œæœ›è¿™ä¸ªåšå®¢å¯ä»¥åšæŒä¹…ä¸€äº›~","source":"_posts/åˆåŒå’å•å»ºåšå®¢.md","raw":"---\ntitle: \"åˆåŒå’å•å»ºåšå®¢\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-11-13 17:05:00\nsubtitle: \"è®²è®²æœ¬æ¬¡å»ºåšå®¢ä¸­é—´é‚£äº›äº‹\"\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- Other\n---\n\n## å‰è¨€\n\nç¬¬äºŒæ¬¡æ­å»ºåšå®¢äº†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨çš„è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºäº†wordpressåšå®¢ï¼Œå†™äº†ä¸¤å¹´å·¦å³60+ç¯‡ï¼Œåœ¨æœåŠ¡å™¨åºŸå¼ƒåä¹Ÿä¸å†ç»´æŠ¤äº†ã€‚\n\næœ¬æ¬¡åˆå¿ƒè¡€æ¥æ½®ï¼Œä½¿ç”¨nodeçš„hexoå’Œgithubçš„gh-pagesæ¥æ­å»ºã€‚\n\nå¼€ç¯‡å°±ä»¥åšå®¢æ­å»ºè¿‡ç¨‹ä¸ºä¸»è¦å†…å®¹ã€‚\n\n## å·¥å…·å‡†å¤‡\n\n> git, node, githubè´¦å·, vscode(éå¿…å¤‡), åŸŸå(éå¿…å¤‡)\n\nè¿™é‡Œéœ€è¦è‡ªè¡Œæœç´¢å­¦ä¹ å®‰è£…äº†\n\n## åŠ¨æ‰‹æ­å»º\n\n> è´´ä¸ªå®˜æ–¹åœ°å€\n> https://hexo.io/zh-cn/\n\nè¿™é‡Œå°±ä¸è·Ÿç€å®˜æ–¹æ•™ç¨‹èµ°äº†ï¼Œä¸è¿‡å¤§åŒå°å¼‚\n\nå…ˆåˆ° [ä¸»é¢˜é¡µ](https://hexo.io/themes/) æ‰¾ä¸ªå–œæ¬¢çš„ä¸»é¢˜\n\nè¿™é‡Œé€‰äº† [A-Boy](https://github.com/huweihuang/hexo-theme-huweihuang) è¿™ä¸ªä¸»é¢˜ï¼ŒğŸ™„ä¸»è¦æ˜¯ä»–æ¯”è¾ƒåƒæˆ‘ä¹‹å‰çš„åšå®¢é£æ ¼ã€‚\n\n```\n# ä¸‹è½½hexoå‘½ä»¤è¡Œå·¥å…·\nnpm install hexo-cli -g\n\n# åˆ›å»ºæ–‡ä»¶å¤¹\nmkdir blog\n\n# \bä¸‹è½½ä¸»é¢˜åˆ°è¯¥æ–‡ä»¶å¤¹\ngit clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./blog\n\n# ä¸‹è½½ä¾èµ–åŒ…\ncd blog\nnpm install\n```\n\næ–‡ä»¶ç»„ç»‡ç»“æ„å¤§è‡´å¦‚ä¸‹\n```\n/_config.xml\nä¸»è¦é…ç½®æ–‡ä»¶\n\n/source\nå­˜æ”¾æ–‡ç«  ./_posts\nå›¾ç‰‡ ./img\n\n/themes\nä¸»é¢˜çš„ä¸€äº›æ¨¡æ¿æ–‡ä»¶\n\n/scaffolds\nä¸€äº›è„šæ‰‹æ¶ï¼ŒåŸç”Ÿå°±åœ¨\n\n/node_modules\nå¤–éƒ¨ä¾èµ–çš„æ¨¡å—\n\n/db.json\nå­˜å‚¨æœåŠ¡å™¨è§£æå‡ºæ¥çš„ä¸´æ—¶æ–‡ç« æ•°æ®\n\n/è¿˜æœ‰ä¸€äº›æš‚æ—¶ç”¨ä¸åˆ°çš„æ–‡ä»¶\n```\n\nå…ˆåˆ°githubå»ºç«‹è‡ªå·±çš„ä»“åº“ï¼Œå°±é•¿ä¸‹é¢è¿™æ ·\n![github](/img/mypost/github.png)\n\nç„¶åå¯¹ä¸»é¢˜çš„_config.xmlä¸€äº›é…ç½®é¡¹\n```\n# é…ç½®åˆšæ‰çš„githubä»“åº“, ä¸€èˆ¬ä½¿ç”¨gh-pagesåˆ†æ”¯\ndeploy:\n  type: git\n  repo: https://github.com/<yourAccount>/<repo>\n  branch: <your-branch>\n```\n\n```\n# é…ç½®è·¯ç”±ï¼Œè¿™é‡Œä½¿ç”¨åŸŸåçš„ç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„ä¼šæœ‰ä¸ªå‘->å›¾ç‰‡å†™ç»å¯¹è·¯å¾„æ—¶ä¸ä¼šæŠŠrootè·¯å¾„åŠ ä¸Š\nurl: http://ganjiacheng.cn/\nroot: /\n```\n\n```\n# é…ç½®ä¸»é¢˜ï¼Œ/theme/ä¸‹çš„å­ç›®å½•æ–‡ä»¶å¤¹\ntheme: huweihuang\n```\n\n```\n# ä¾§è¾¹æ çš„ä¸€äº›é…ç½®\nsidebar: true    \nsidebar-about-description: \"<your description>\"\nsidebar-avatar: img/<your avatar path>\nwidgets:  \n- featured-tags\n- short-about\n- recent-posts\n- friends-blog\n- archive\n- category\n```\n\n```\n# markdownç¼–è¯‘å™¨çš„ä¸€äº›é…ç½®\nmarkdown:\n  render:\n    html: true\n    xhtmlOut: false\n    breaks: true\n    linkify: true\n    typographer: true\n    quotes: 'â€œâ€â€˜â€™'\n```\n\nè¿™é‡Œæœ‰é…ç½®èƒŒæ™¯å›¾\næ¨èä¸€ä¸ªå¸¸ç”¨çš„[å£çº¸ç½‘ç«™](https://bing.ioliu.cn/)\n\n\nä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤è¡Œå‘½ä»¤\n```\n# æ–°å»ºæ–‡ç« \nhexo new post \"<post name>\" \n\n# åˆ é™¤ä¸´æ—¶æ•°æ®åº“\nhexo clean\n\n# ç¼–è¯‘ä¸ºhtml\nhexo generate \n\n# å¼€å¯server\nhexo server\n\n# ä¸Šä¼ åˆ°githubï¼Œç¬¬ä¸€æ¬¡è¦å†™è´¦å·å¯†ç ï¼Œåé¢å°±ä¸ç”¨äº†\nhexo deploy \n```\n\n## ä½¿ç”¨vscodeå†™æ–‡ç« \n\næ‰“å¼€å»ºç«‹çš„é¡¹ç›®æ–‡ä»¶å¤¹\n\nåœ¨/source/_posts/ä¸‹æ–°å»ºmdæ–‡ä»¶ä¸ºæ–°æ–‡ç« \n\nç”±äºæ–‡ç« éƒ½æ˜¯markdownæ ¼å¼ï¼Œç”¨ä¸€èˆ¬æ–‡æœ¬ç¼–è¾‘å™¨æ¯”è¾ƒå›°éš¾ï¼Œæ•…è€Œé€‰åˆ™vscodeï¼Œå› ä¸ºå®ƒå¸¦markdownæ’ä»¶ï¼Œ  \nå…¶ä»–å¯é€‰æ‹©çš„ä¹Ÿæœ‰å†™æ–‡ç« çš„hexoæ’ä»¶ [hexo-admin](https://github.com/jaredly/hexo-admin)\n\ncommand+shift+p æœç´¢markdown open preview to the side\n\nå°±å¯ä»¥åœ¨å·¦è¾¹å†™å³è¾¹å®æ—¶æŸ¥çœ‹æ•ˆæœäº†\n\næ¨èä¸€ä¸ªè‡ªå·±è®°å½•æœ€ç®€markdownæ‰‹å†Œ [markdownæ‰‹å†Œ](https://github.com/webgjc/ApiTestToMd/blob/master/md/markdown.md)\n\nåœ¨markdownæ–‡ä»¶å¼€å¤´åŠ ä¸Šä¸€äº›æ–‡ç« çš„å¿…å¤‡ä¿¡æ¯\n```\n---\ntitle: \"æ ‡é¢˜\"\ndate: 1999-01-01 00:00:00\nsubtitle: \"å‰¯æ ‡é¢˜\"\nheader-img: \"/img/å›¾ç‰‡.jpg\"\ntags:\n- æ ‡ç­¾\n---\n```\n\nç„¶åå¼€å§‹å†™æ–‡ç« \n```\næ­¤å¤„çœç•¥ä¸€ä¸‡å­—\n```\n\n## ä»‹ç»ä¸€äº›æ’ä»¶\n\nåŸç”Ÿçš„åšå®¢ä¸å¸¦æ’ä»¶ï¼Œå°‘äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚ç»Ÿè®¡è®¿é—®æ¬¡æ•°ï¼Œè¯„è®ºç³»ç»Ÿç­‰ã€‚\n\nä¹Ÿæœ‰ä¸€äº›ä¸»é¢˜ä¹Ÿå†…ç½®äº†ä¸€äº›æ’ä»¶ï¼Œç›´æ¥é…ç½®å³å¯ã€‚\n\nç”±äºè¿™äº›åŠŸèƒ½éƒ½å¾—å¸¦åç«¯å­˜å‚¨ï¼Œè‡ªå·±åšä¸ªåˆéº»çƒ¦ï¼Œå› æ­¤ä½¿ç”¨ä¸€äº›åˆ«äººåšçš„å…è´¹çš„ã€‚\n\n### è®¿é—®æ¬¡æ•°æ’ä»¶\n\nè¿™é‡Œè¯•ç”¨ä¸‹ [ä¸è’œå­](http://busuanzi.ibruce.info/) æ¥åšè®¿é—®æ¬¡æ•°ã€‚\n\nç¼–è¾‘ /_config.yml åœ¨æœ€ååŠ ä¸Š\n```\nbusuanzi:\n  enable: true\n```\n\næ‰¾åˆ°/themes/ä¸»é¢˜å/layout/_partial/footer.ejs\n\nåœ¨åº•éƒ¨\\</footer>æ ‡ç­¾å‰åŠ ä¸Šï¼Œå°±æ˜¯ç½‘ç«™æ¬¡æ•°ç»Ÿè®¡ï¼Œæˆ–è€…è‡ªå·±æƒ³åŠ å“ªåŠ å“ª\n```\n<% if (theme.busuanzi && theme.busuanzi.enable){ %>\n    <script async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"></script>\n    <div style=\"text-align: center;\">\n        <span>\n            æœ¬ç«™æ€»è®¿é—®é‡<span id=\"busuanzi_value_site_pv\"></span>æ¬¡\n            </span>\n            <span class=\"post-meta-divider\">|</span>\n        <span>\n            æœ¬ç«™è®¿å®¢æ•°<span id=\"busuanzi_value_site_uv\"></span>äºº\n        </span>\n    </div>\n<% } %>\n```\nä¸‹é¢è¿™ä¸ªæ˜¯é¡µé¢è®¿é—®æ¬¡æ•°\n```\n<% if (theme.busuanzi && theme.busuanzi.enable){ %>\n    <span>\n        Viewed <span id=\"busuanzi_value_page_pv\"></span> times\n    </span>\n<% } %>\n```\n\n### è¯„è®ºæ’ä»¶\n\nè¿™é‡Œä½¿ç”¨çš„æ˜¯[valine](https://valine.js.org/) å’Œ [leancloud](https://leancloud.cn/)\n\nvalineæ˜¯å‰ç«¯éƒ¨åˆ†åµŒå…¥ç»„ä»¶ï¼Œleancloudæ¥å­˜å‚¨ä¿¡æ¯\n\næ³¨å†Œç­‰æ­¥éª¤å°±ä¸è´´äº†,çœ‹[è¿™é‡Œ](https://valine.js.org/quickstart.html)\n\nè¯´ä¸‹åµŒå…¥çš„éƒ¨åˆ†ï¼Œåœ¨/themes/ä¸»é¢˜å/post.ejs\n\næ‰¾ä¸ªåˆé€‚çš„æ ‡ç­¾ä¸‹é¢åŠ å…¥ï¼ŒåŸºæœ¬å°±å’Œä¸Šé¢æ–‡ç« å¯¹é½å°±è¡Œ\n\n```\n<script src='//unpkg.com/valine/dist/Valine.min.js'></script>\n<h5>COMMENT</h5>\n<div id=\"vcomments\"></div>\n<script>\n    new Valine({\n        el: '#vcomments',\n        appId: '<AppId>', #è¿™ä¸ªè¦æ³¨å†Œåæ‹¿åˆ°\n        appKey: '<AppKey>', #è¿™ä¸ªåŒä¸Š\n        notify:false, \n        verify:false, \n        avatar:'mp', \n        placeholder: 'æ¥äº†è€å¼Ÿ #markdownæ ¼å¼'\n    })\n    setTimeout(() => {\n        document.getElementsByClassName(\"info\")[0].style.display=\"none\";\n    }, 1000)\n</script>\n```\nç‰¹åœ°è¯´ä¸‹åŠ settimeouté‚£æ­¥æ˜¯ä¸ºäº†éšè—è‡ªå¸¦çš„powerä¿¡æ¯ğŸ™ƒ\n\nè¯„è®ºï¼Œç„¶åå°±å¯ä»¥åœ¨leancloud å­˜å‚¨->ç»“æ„åŒ–æ•°æ®->commentçœ‹åˆ°è¯„è®ºä¿¡æ¯\n\n\næ•²é»‘æ¿ï¼Œä¸‹é¢æ˜¯é‡ç‚¹ğŸ‘‡ğŸ˜ğŸ˜\n\n> å·¦è¾¹å¦¹å­çš„æ’ä»¶å°±æœä¸‹ [hexo live2d](https://www.baidu.com/s?ie=UTF-8&wd=hexo%20live2d) \n\n\n## åŸŸåé…ç½®\n\næœ€åæ¥äº†è§£ä¸€ä¸‹ä¸Šä¼ åˆ°githubååŸŸåé…ç½®ã€‚\n\nåœ¨ hexo deploy å‰\n\né…ç½® /source/CNAME, å†™è§£æåçš„åŸŸå\n\nåœ¨ä¹°åŸŸåçš„åŸŸåç®¡ç†å¤„è¿›è¡ŒåŸŸåè§£æ \n\nè®°å½•ç±»å‹CNAME => githubè´¦å·.github.io\n\nå°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®å•¦ï¼\n\n## å¤šç»ˆç«¯åŒæ­¥\n\nè¿™ä¸ªä¹Ÿå¾ˆå¸¸è§ï¼Œå°±æ˜¯åœ¨å¤šä¸ªåœ°æ–¹å†™åšå®¢ï¼Œæƒ³è¿™è¾¹å†™å®ŒåŒæ­¥åˆ°å„ä¸ªå®¢æˆ·ç«¯ã€‚\n\nå¦‚æœæ˜¯æœ‰è‡ªå·±æœåŠ¡å™¨çš„ï¼Œå°±è£…ä¸ªhexo-adminçš„æ’ä»¶ï¼Œå¼€å¯hexo serveråç›‘å¬åˆ°å…¬ç½‘ç«¯å£ï¼Œä¸æ”¾å¿ƒçš„è¯å…¥å£åŠ ä¸ªè®¤è¯ï¼Œå°±å¯ä»¥åœ¨çº¿ç¼–è¾‘ã€‚\n\nä¸€èˆ¬çš„åšæ³•æ˜¯ä½¿ç”¨åˆšæ‰å»ºçš„githubä»“åº“çš„masteråˆ†æ”¯ä½œä¸ºæ–‡ç« æºç ï¼Œgh-pagesåˆ†æ”¯ä½œä¸ºé™æ€åšå®¢ã€‚\n\n```\né¡¹ç›®æ ¹ç›®å½•ä¸‹/\n# å¼•å…¥git\ngit init\n\n# è®¾ç½®è¿œç¨‹åœ°å€\ngit remote add origin gitåœ°å€\n\n# pullä¸€ä¸‹è¿œç¨‹çš„æäº¤ï¼Œæœ‰å†²çªå°±è§£å†³ä¸‹/æ–‡ä»¶å¤‡ä»½/é‡å‘½å\ngit pull origin master --allow-unrelated-histories\n\n# æ·»åŠ .gitignoreï¼ŒåŠ å…¥\npublic/\n.vscode\nnode_modules\n\n# gitä¸‰è¿\ngit add .\ngit commit -m \"\"\ngit push origin master\n```\n\nç»ˆç«¯ä½¿ç”¨å†™åšå®¢å‰å…ˆclone / pullä¸€ä¸‹ï¼Œ\n\nå†™å®Œdeployå å† gitä¸‰è¿å°±è¡Œ\n\n## æ‹“å±•å†…å®¹\n\nè‡ªå»ºä¸»é¢˜\n\nåˆ«äººçš„ä¸»é¢˜è¦è‡ªå®šä¹‰çš„è¯è¿˜æ˜¯æ”¹å¾ˆå¤šï¼Œæœ‰æƒ³æ³•å¯ä»¥è‡ªè¡Œå¼€å‘ä¸»é¢˜\n\nä»ä¸Šé¢åŸºæœ¬ä¹Ÿå¯ä»¥çŸ¥é“ä¸»é¢˜çš„å°±æ˜¯åœ¨ /theme/ä¸‹åˆ›å»ºçš„æ–‡ä»¶å¤¹,  \nç„¶åä¿®æ”¹_config.ymlçš„ä¸»é¢˜é…ç½®\n\n```\nä¸»é¢˜ä¸‹ä¸»è¦æ–‡ä»¶ç»“æ„\n/layout # ä¸»è¦å¸ƒå±€ï¼Œæ ·å¼æ–‡ä»¶\n/source # å¤–éƒ¨js cssç­‰\n_config.yml # é…ç½®æ–‡ä»¶\n```\næ•°æ®ä¸»è¦é æ¨¡æ¿çš„æ–¹å¼åŠ è½½ï¼Œå…¶ä»–è¿˜æ˜¯å’ŒåŸç”Ÿjså·®ä¸å¤š\n\nè´´ä¸ªä¸é”™çš„[æ•™ç¨‹](https://www.cnblogs.com/yyhh/p/11058985.html)\n\n## æœ€åä¸€å¸­è¯\n\ngithubæœ‰æ—¶ä¼šè¢«å¢™ï¼Œæœ‰æ—¶ä¼šè®¿é—®æ…¢ï¼Œè¿™ä¸ªå›½å†…ä¸ä¸€å®šç¨³å®šğŸ¤”\n\nä½“éªŒæ¥è¯´ç›¸æ¯”äºç®€ä¹¦ç­‰æ¥è¯´ï¼Œæ­å»ºè¿‡ç¨‹è¿˜æ˜¯éœ€è¦ä¸€å®šåŸºç¡€ï¼Œå†™èµ·æ¥ä¹Ÿéƒ½markdownï¼Œ\n\nä½†èƒœåœ¨å¯ä»¥è‡ªå®šä¹‰èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿(è£…é€¼ä¸‡å²)ã€‚\n\nä¸ºäº†åšæŒå†™åšå®¢ä¹‹å‰ä¸€ç›´ç”¨çš„æ˜¯å…ˆç«‹æ ‡é¢˜æ–‡ç« ï¼Œå‡ æ˜ŸæœŸè¿‡å»æœ‰æƒ³æ³•å’Œæ–¹æ³•äº†å†å»å¡«å……å®Œæˆå‰©ä¸‹çš„æ–‡ç« å†…å®¹ï¼Œè¿™ä¸ªä¸€ç›´éƒ½è¿˜ä¸é”™ã€‚\n\nå¸Œæœ›è¿™ä¸ªåšå®¢å¯ä»¥åšæŒä¹…ä¸€äº›~","slug":"åˆåŒå’å•å»ºåšå®¢","published":1,"updated":"2020-03-31T08:15:45.996Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7h0008pb0jhn6nijgg","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>ç¬¬äºŒæ¬¡æ­å»ºåšå®¢äº†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨çš„è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºäº†wordpressåšå®¢ï¼Œå†™äº†ä¸¤å¹´å·¦å³60+ç¯‡ï¼Œåœ¨æœåŠ¡å™¨åºŸå¼ƒåä¹Ÿä¸å†ç»´æŠ¤äº†ã€‚</p>\n<p>æœ¬æ¬¡åˆå¿ƒè¡€æ¥æ½®ï¼Œä½¿ç”¨nodeçš„hexoå’Œgithubçš„gh-pagesæ¥æ­å»ºã€‚</p>\n<p>å¼€ç¯‡å°±ä»¥åšå®¢æ­å»ºè¿‡ç¨‹ä¸ºä¸»è¦å†…å®¹ã€‚</p>\n<h2 id=\"å·¥å…·å‡†å¤‡\">å·¥å…·å‡†å¤‡</h2>\n<blockquote>\n<p>git, node, githubè´¦å·, vscode(éå¿…å¤‡), åŸŸå(éå¿…å¤‡)</p>\n</blockquote>\n<p>è¿™é‡Œéœ€è¦è‡ªè¡Œæœç´¢å­¦ä¹ å®‰è£…äº†</p>\n<h2 id=\"åŠ¨æ‰‹æ­å»º\">åŠ¨æ‰‹æ­å»º</h2>\n<blockquote>\n<p>è´´ä¸ªå®˜æ–¹åœ°å€<br>\n<a href=\"https://hexo.io/zh-cn/\" target=\"_blank\" rel=\"noopener\">https://hexo.io/zh-cn/</a></p>\n</blockquote>\n<p>è¿™é‡Œå°±ä¸è·Ÿç€å®˜æ–¹æ•™ç¨‹èµ°äº†ï¼Œä¸è¿‡å¤§åŒå°å¼‚</p>\n<p>å…ˆåˆ° <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">ä¸»é¢˜é¡µ</a> æ‰¾ä¸ªå–œæ¬¢çš„ä¸»é¢˜</p>\n<p>è¿™é‡Œé€‰äº† <a href=\"https://github.com/huweihuang/hexo-theme-huweihuang\" target=\"_blank\" rel=\"noopener\">A-Boy</a> è¿™ä¸ªä¸»é¢˜ï¼ŒğŸ™„ä¸»è¦æ˜¯ä»–æ¯”è¾ƒåƒæˆ‘ä¹‹å‰çš„åšå®¢é£æ ¼ã€‚</p>\n<figure class=\"highlight vala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># ä¸‹è½½hexoå‘½ä»¤è¡Œå·¥å…·</span></span><br><span class=\"line\">npm install hexo-cli -g</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class=\"line\">mkdir blog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># \bä¸‹è½½ä¸»é¢˜åˆ°è¯¥æ–‡ä»¶å¤¹</span></span><br><span class=\"line\">git clone https:<span class=\"comment\">//github.com/huweihuang/hexo-theme-huweihuang.git ./blog</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># ä¸‹è½½ä¾èµ–åŒ…</span></span><br><span class=\"line\">cd blog</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n<p>æ–‡ä»¶ç»„ç»‡ç»“æ„å¤§è‡´å¦‚ä¸‹</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">/_config.xml</span></span><br><span class=\"line\">ä¸»è¦é…ç½®æ–‡ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/source</span></span><br><span class=\"line\">å­˜æ”¾æ–‡ç«  <span class=\"string\">./_posts</span></span><br><span class=\"line\">å›¾ç‰‡ <span class=\"string\">./img</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/themes</span></span><br><span class=\"line\">ä¸»é¢˜çš„ä¸€äº›æ¨¡æ¿æ–‡ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/scaffolds</span></span><br><span class=\"line\">ä¸€äº›è„šæ‰‹æ¶ï¼ŒåŸç”Ÿå°±åœ¨</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/node_modules</span></span><br><span class=\"line\">å¤–éƒ¨ä¾èµ–çš„æ¨¡å—</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/db.json</span></span><br><span class=\"line\">å­˜å‚¨æœåŠ¡å™¨è§£æå‡ºæ¥çš„ä¸´æ—¶æ–‡ç« æ•°æ®</span><br><span class=\"line\"></span><br><span class=\"line\">/è¿˜æœ‰ä¸€äº›æš‚æ—¶ç”¨ä¸åˆ°çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n<p>å…ˆåˆ°githubå»ºç«‹è‡ªå·±çš„ä»“åº“ï¼Œå°±é•¿ä¸‹é¢è¿™æ ·<br>\n<img src=\"/img/mypost/github.png\" alt=\"github\"></p>\n<p>ç„¶åå¯¹ä¸»é¢˜çš„_config.xmlä¸€äº›é…ç½®é¡¹</p>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®åˆšæ‰çš„githubä»“åº“, ä¸€èˆ¬ä½¿ç”¨gh-pagesåˆ†æ”¯</span></span><br><span class=\"line\"><span class=\"symbol\">deploy:</span></span><br><span class=\"line\"><span class=\"symbol\">  type:</span> git</span><br><span class=\"line\"><span class=\"symbol\">  repo:</span> https:<span class=\"comment\">//github.com/&lt;yourAccount&gt;/&lt;repo&gt;</span></span><br><span class=\"line\"><span class=\"symbol\">  branch:</span> <span class=\"params\">&lt;your-branch&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®è·¯ç”±ï¼Œè¿™é‡Œä½¿ç”¨åŸŸåçš„ç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„ä¼šæœ‰ä¸ªå‘-&gt;å›¾ç‰‡å†™ç»å¯¹è·¯å¾„æ—¶ä¸ä¼šæŠŠrootè·¯å¾„åŠ ä¸Š</span></span><br><span class=\"line\"><span class=\"symbol\">url:</span> http:<span class=\"comment\">//ganjiacheng.cn/</span></span><br><span class=\"line\"><span class=\"symbol\">root:</span> /</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®ä¸»é¢˜ï¼Œ/theme/ä¸‹çš„å­ç›®å½•æ–‡ä»¶å¤¹</span></span><br><span class=\"line\"><span class=\"symbol\">theme:</span> huweihuang</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight haml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ä¾§è¾¹æ çš„ä¸€äº›é…ç½®</span><br><span class=\"line\">sidebar: true    </span><br><span class=\"line\">sidebar-about-description: \"&lt;your description&gt;\"</span><br><span class=\"line\">sidebar-avatar: img/&lt;your avatar path&gt;</span><br><span class=\"line\">widgets:  </span><br><span class=\"line\">-<span class=\"ruby\"> featured-tags</span></span><br><span class=\"line\"><span class=\"ruby\">- short-about</span></span><br><span class=\"line\"><span class=\"ruby\">- recent-posts</span></span><br><span class=\"line\"><span class=\"ruby\">- friends-blog</span></span><br><span class=\"line\"><span class=\"ruby\">- archive</span></span><br><span class=\"line\"><span class=\"ruby\">- category</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># markdownç¼–è¯‘å™¨çš„ä¸€äº›é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">markdown:</span></span><br><span class=\"line\"><span class=\"attr\">  render:</span></span><br><span class=\"line\"><span class=\"attr\">    html:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    xhtmlOut:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    breaks:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    linkify:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    typographer:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    quotes:</span> <span class=\"string\">'â€œâ€â€˜â€™'</span></span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæœ‰é…ç½®èƒŒæ™¯å›¾<br>\næ¨èä¸€ä¸ªå¸¸ç”¨çš„<a href=\"https://bing.ioliu.cn/\" target=\"_blank\" rel=\"noopener\">å£çº¸ç½‘ç«™</a></p>\n<p>ä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤è¡Œå‘½ä»¤</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ–°å»ºæ–‡ç« </span></span><br><span class=\"line\">hexo new post <span class=\"string\">\"&lt;post name&gt;\"</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ é™¤ä¸´æ—¶æ•°æ®åº“</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¼–è¯‘ä¸ºhtml</span></span><br><span class=\"line\">hexo generate </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¼€å¯server</span></span><br><span class=\"line\">hexo server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä¸Šä¼ åˆ°githubï¼Œç¬¬ä¸€æ¬¡è¦å†™è´¦å·å¯†ç ï¼Œåé¢å°±ä¸ç”¨äº†</span></span><br><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n<h2 id=\"ä½¿ç”¨vscodeå†™æ–‡ç« \">ä½¿ç”¨vscodeå†™æ–‡ç« </h2>\n<p>æ‰“å¼€å»ºç«‹çš„é¡¹ç›®æ–‡ä»¶å¤¹</p>\n<p>åœ¨/source/_posts/ä¸‹æ–°å»ºmdæ–‡ä»¶ä¸ºæ–°æ–‡ç« </p>\n<p>ç”±äºæ–‡ç« éƒ½æ˜¯markdownæ ¼å¼ï¼Œç”¨ä¸€èˆ¬æ–‡æœ¬ç¼–è¾‘å™¨æ¯”è¾ƒå›°éš¾ï¼Œæ•…è€Œé€‰åˆ™vscodeï¼Œå› ä¸ºå®ƒå¸¦markdownæ’ä»¶ï¼Œ<br>\nå…¶ä»–å¯é€‰æ‹©çš„ä¹Ÿæœ‰å†™æ–‡ç« çš„hexoæ’ä»¶ <a href=\"https://github.com/jaredly/hexo-admin\" target=\"_blank\" rel=\"noopener\">hexo-admin</a></p>\n<p>command+shift+p æœç´¢markdown open preview to the side</p>\n<p>å°±å¯ä»¥åœ¨å·¦è¾¹å†™å³è¾¹å®æ—¶æŸ¥çœ‹æ•ˆæœäº†</p>\n<p>æ¨èä¸€ä¸ªè‡ªå·±è®°å½•æœ€ç®€markdownæ‰‹å†Œ <a href=\"https://github.com/webgjc/ApiTestToMd/blob/master/md/markdown.md\" target=\"_blank\" rel=\"noopener\">markdownæ‰‹å†Œ</a></p>\n<p>åœ¨markdownæ–‡ä»¶å¼€å¤´åŠ ä¸Šä¸€äº›æ–‡ç« çš„å¿…å¤‡ä¿¡æ¯</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">\"æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">1999</span><span class=\"bullet\">-01</span><span class=\"bullet\">-01</span> <span class=\"number\">00</span><span class=\"string\">:00:00</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span> <span class=\"string\">\"å‰¯æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"attr\">header-img:</span> <span class=\"string\">\"/img/å›¾ç‰‡.jpg\"</span></span><br><span class=\"line\"><span class=\"attr\">tags:</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">æ ‡ç­¾</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åå¼€å§‹å†™æ–‡ç« </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ­¤å¤„çœç•¥ä¸€ä¸‡å­—</span><br></pre></td></tr></table></figure>\n<h2 id=\"ä»‹ç»ä¸€äº›æ’ä»¶\">ä»‹ç»ä¸€äº›æ’ä»¶</h2>\n<p>åŸç”Ÿçš„åšå®¢ä¸å¸¦æ’ä»¶ï¼Œå°‘äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚ç»Ÿè®¡è®¿é—®æ¬¡æ•°ï¼Œè¯„è®ºç³»ç»Ÿç­‰ã€‚</p>\n<p>ä¹Ÿæœ‰ä¸€äº›ä¸»é¢˜ä¹Ÿå†…ç½®äº†ä¸€äº›æ’ä»¶ï¼Œç›´æ¥é…ç½®å³å¯ã€‚</p>\n<p>ç”±äºè¿™äº›åŠŸèƒ½éƒ½å¾—å¸¦åç«¯å­˜å‚¨ï¼Œè‡ªå·±åšä¸ªåˆéº»çƒ¦ï¼Œå› æ­¤ä½¿ç”¨ä¸€äº›åˆ«äººåšçš„å…è´¹çš„ã€‚</p>\n<h3 id=\"è®¿é—®æ¬¡æ•°æ’ä»¶\">è®¿é—®æ¬¡æ•°æ’ä»¶</h3>\n<p>è¿™é‡Œè¯•ç”¨ä¸‹ <a href=\"http://busuanzi.ibruce.info/\" target=\"_blank\" rel=\"noopener\">ä¸è’œå­</a> æ¥åšè®¿é—®æ¬¡æ•°ã€‚</p>\n<p>ç¼–è¾‘ /_config.yml åœ¨æœ€ååŠ ä¸Š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">busuanzi:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ°/themes/ä¸»é¢˜å/layout/_partial/footer.ejs</p>\n<p>åœ¨åº•éƒ¨&lt;/footer&gt;æ ‡ç­¾å‰åŠ ä¸Šï¼Œå°±æ˜¯ç½‘ç«™æ¬¡æ•°ç»Ÿè®¡ï¼Œæˆ–è€…è‡ªå·±æƒ³åŠ å“ªåŠ å“ª</p>\n<figure class=\"highlight erb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> <span class=\"keyword\">if</span> (theme.busuanzi &amp;&amp; theme.busuanzi.enable)&#123; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">async</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align: center;\"</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            æœ¬ç«™æ€»è®¿é—®é‡<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>æ¬¡</span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-divider\"</span>&gt;</span>|<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            æœ¬ç«™è®¿å®¢æ•°<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_uv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>äºº</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> &#125; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br></pre></td></tr></table></figure>\n<p>ä¸‹é¢è¿™ä¸ªæ˜¯é¡µé¢è®¿é—®æ¬¡æ•°</p>\n<figure class=\"highlight erb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> <span class=\"keyword\">if</span> (theme.busuanzi &amp;&amp; theme.busuanzi.enable)&#123; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        Viewed <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_page_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> times</span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> &#125; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"è¯„è®ºæ’ä»¶\">è¯„è®ºæ’ä»¶</h3>\n<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<a href=\"https://valine.js.org/\" target=\"_blank\" rel=\"noopener\">valine</a> å’Œ <a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">leancloud</a></p>\n<p>valineæ˜¯å‰ç«¯éƒ¨åˆ†åµŒå…¥ç»„ä»¶ï¼Œleancloudæ¥å­˜å‚¨ä¿¡æ¯</p>\n<p>æ³¨å†Œç­‰æ­¥éª¤å°±ä¸è´´äº†,çœ‹<a href=\"https://valine.js.org/quickstart.html\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>è¯´ä¸‹åµŒå…¥çš„éƒ¨åˆ†ï¼Œåœ¨/themes/ä¸»é¢˜å/post.ejs</p>\n<p>æ‰¾ä¸ªåˆé€‚çš„æ ‡ç­¾ä¸‹é¢åŠ å…¥ï¼ŒåŸºæœ¬å°±å’Œä¸Šé¢æ–‡ç« å¯¹é½å°±è¡Œ</p>\n<figure class=\"highlight coffeescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script src=<span class=\"string\">'//unpkg.com/valine/dist/Valine.min.js'</span>&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;h5&gt;COMMENT&lt;/h5&gt;</span><br><span class=\"line\">&lt;div id=<span class=\"string\">\"vcomments\"</span>&gt;&lt;/div&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> Valine(&#123;</span><br><span class=\"line\">        el: <span class=\"string\">'#vcomments'</span>,</span><br><span class=\"line\">        appId: <span class=\"string\">'&lt;AppId&gt;'</span>, <span class=\"comment\">#è¿™ä¸ªè¦æ³¨å†Œåæ‹¿åˆ°</span></span><br><span class=\"line\">        appKey: <span class=\"string\">'&lt;AppKey&gt;'</span>, <span class=\"comment\">#è¿™ä¸ªåŒä¸Š</span></span><br><span class=\"line\">        notify:<span class=\"literal\">false</span>, </span><br><span class=\"line\">        verify:<span class=\"literal\">false</span>, </span><br><span class=\"line\">        avatar:<span class=\"string\">'mp'</span>, </span><br><span class=\"line\">        placeholder: <span class=\"string\">'æ¥äº†è€å¼Ÿ #markdownæ ¼å¼'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">\"info\"</span>)[<span class=\"number\">0</span>].style.display=<span class=\"string\">\"none\"</span>;</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<p>ç‰¹åœ°è¯´ä¸‹åŠ settimeouté‚£æ­¥æ˜¯ä¸ºäº†éšè—è‡ªå¸¦çš„powerä¿¡æ¯ğŸ™ƒ</p>\n<p>è¯„è®ºï¼Œç„¶åå°±å¯ä»¥åœ¨leancloud å­˜å‚¨-&gt;ç»“æ„åŒ–æ•°æ®-&gt;commentçœ‹åˆ°è¯„è®ºä¿¡æ¯</p>\n<p>æ•²é»‘æ¿ï¼Œä¸‹é¢æ˜¯é‡ç‚¹ğŸ‘‡ğŸ˜ğŸ˜</p>\n<blockquote>\n<p>å·¦è¾¹å¦¹å­çš„æ’ä»¶å°±æœä¸‹ <a href=\"https://www.baidu.com/s?ie=UTF-8&amp;wd=hexo%20live2d\" target=\"_blank\" rel=\"noopener\">hexo live2d</a></p>\n</blockquote>\n<h2 id=\"åŸŸåé…ç½®\">åŸŸåé…ç½®</h2>\n<p>æœ€åæ¥äº†è§£ä¸€ä¸‹ä¸Šä¼ åˆ°githubååŸŸåé…ç½®ã€‚</p>\n<p>åœ¨ hexo deploy å‰</p>\n<p>é…ç½® /source/CNAME, å†™è§£æåçš„åŸŸå</p>\n<p>åœ¨ä¹°åŸŸåçš„åŸŸåç®¡ç†å¤„è¿›è¡ŒåŸŸåè§£æ</p>\n<p>è®°å½•ç±»å‹CNAME =&gt; <a href=\"http://xn--github-ud6jy198a.github.io\" target=\"_blank\" rel=\"noopener\">githubè´¦å·.github.io</a></p>\n<p>å°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®å•¦ï¼</p>\n<h2 id=\"å¤šç»ˆç«¯åŒæ­¥\">å¤šç»ˆç«¯åŒæ­¥</h2>\n<p>è¿™ä¸ªä¹Ÿå¾ˆå¸¸è§ï¼Œå°±æ˜¯åœ¨å¤šä¸ªåœ°æ–¹å†™åšå®¢ï¼Œæƒ³è¿™è¾¹å†™å®ŒåŒæ­¥åˆ°å„ä¸ªå®¢æˆ·ç«¯ã€‚</p>\n<p>å¦‚æœæ˜¯æœ‰è‡ªå·±æœåŠ¡å™¨çš„ï¼Œå°±è£…ä¸ªhexo-adminçš„æ’ä»¶ï¼Œå¼€å¯hexo serveråç›‘å¬åˆ°å…¬ç½‘ç«¯å£ï¼Œä¸æ”¾å¿ƒçš„è¯å…¥å£åŠ ä¸ªè®¤è¯ï¼Œå°±å¯ä»¥åœ¨çº¿ç¼–è¾‘ã€‚</p>\n<p>ä¸€èˆ¬çš„åšæ³•æ˜¯ä½¿ç”¨åˆšæ‰å»ºçš„githubä»“åº“çš„masteråˆ†æ”¯ä½œä¸ºæ–‡ç« æºç ï¼Œgh-pagesåˆ†æ”¯ä½œä¸ºé™æ€åšå®¢ã€‚</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">é¡¹ç›®æ ¹ç›®å½•ä¸‹/</span><br><span class=\"line\"><span class=\"comment\"># å¼•å…¥git</span></span><br><span class=\"line\">git init</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®è¿œç¨‹åœ°å€</span></span><br><span class=\"line\">git remote <span class=\"keyword\">add</span><span class=\"bash\"> origin gitåœ°å€</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># pullä¸€ä¸‹è¿œç¨‹çš„æäº¤ï¼Œæœ‰å†²çªå°±è§£å†³ä¸‹/æ–‡ä»¶å¤‡ä»½/é‡å‘½å</span></span></span><br><span class=\"line\"><span class=\"bash\">git pull origin master --allow-unrelated-histories</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># æ·»åŠ .gitignoreï¼ŒåŠ å…¥</span></span></span><br><span class=\"line\"><span class=\"bash\">public/</span></span><br><span class=\"line\"><span class=\"bash\">.vscode</span></span><br><span class=\"line\"><span class=\"bash\">node_modules</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># gitä¸‰è¿</span></span></span><br><span class=\"line\"><span class=\"bash\">git add .</span></span><br><span class=\"line\"><span class=\"bash\">git commit -m <span class=\"string\">\"\"</span></span></span><br><span class=\"line\"><span class=\"bash\">git push origin master</span></span><br></pre></td></tr></table></figure>\n<p>ç»ˆç«¯ä½¿ç”¨å†™åšå®¢å‰å…ˆclone / pullä¸€ä¸‹ï¼Œ</p>\n<p>å†™å®Œdeployå å† gitä¸‰è¿å°±è¡Œ</p>\n<h2 id=\"æ‹“å±•å†…å®¹\">æ‹“å±•å†…å®¹</h2>\n<p>è‡ªå»ºä¸»é¢˜</p>\n<p>åˆ«äººçš„ä¸»é¢˜è¦è‡ªå®šä¹‰çš„è¯è¿˜æ˜¯æ”¹å¾ˆå¤šï¼Œæœ‰æƒ³æ³•å¯ä»¥è‡ªè¡Œå¼€å‘ä¸»é¢˜</p>\n<p>ä»ä¸Šé¢åŸºæœ¬ä¹Ÿå¯ä»¥çŸ¥é“ä¸»é¢˜çš„å°±æ˜¯åœ¨ /theme/ä¸‹åˆ›å»ºçš„æ–‡ä»¶å¤¹,<br>\nç„¶åä¿®æ”¹_config.ymlçš„ä¸»é¢˜é…ç½®</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ä¸»é¢˜ä¸‹ä¸»è¦æ–‡ä»¶ç»“æ„</span><br><span class=\"line\"><span class=\"string\">/layout</span> <span class=\"comment\"># ä¸»è¦å¸ƒå±€ï¼Œæ ·å¼æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"string\">/source</span> <span class=\"comment\"># å¤–éƒ¨js cssç­‰</span></span><br><span class=\"line\">_config.yml <span class=\"comment\"># é…ç½®æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>\n<p>æ•°æ®ä¸»è¦é æ¨¡æ¿çš„æ–¹å¼åŠ è½½ï¼Œå…¶ä»–è¿˜æ˜¯å’ŒåŸç”Ÿjså·®ä¸å¤š</p>\n<p>è´´ä¸ªä¸é”™çš„<a href=\"https://www.cnblogs.com/yyhh/p/11058985.html\" target=\"_blank\" rel=\"noopener\">æ•™ç¨‹</a></p>\n<h2 id=\"æœ€åä¸€å¸­è¯\">æœ€åä¸€å¸­è¯</h2>\n<p>githubæœ‰æ—¶ä¼šè¢«å¢™ï¼Œæœ‰æ—¶ä¼šè®¿é—®æ…¢ï¼Œè¿™ä¸ªå›½å†…ä¸ä¸€å®šç¨³å®šğŸ¤”</p>\n<p>ä½“éªŒæ¥è¯´ç›¸æ¯”äºç®€ä¹¦ç­‰æ¥è¯´ï¼Œæ­å»ºè¿‡ç¨‹è¿˜æ˜¯éœ€è¦ä¸€å®šåŸºç¡€ï¼Œå†™èµ·æ¥ä¹Ÿéƒ½markdownï¼Œ</p>\n<p>ä½†èƒœåœ¨å¯ä»¥è‡ªå®šä¹‰èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿(è£…é€¼ä¸‡å²)ã€‚</p>\n<p>ä¸ºäº†åšæŒå†™åšå®¢ä¹‹å‰ä¸€ç›´ç”¨çš„æ˜¯å…ˆç«‹æ ‡é¢˜æ–‡ç« ï¼Œå‡ æ˜ŸæœŸè¿‡å»æœ‰æƒ³æ³•å’Œæ–¹æ³•äº†å†å»å¡«å……å®Œæˆå‰©ä¸‹çš„æ–‡ç« å†…å®¹ï¼Œè¿™ä¸ªä¸€ç›´éƒ½è¿˜ä¸é”™ã€‚</p>\n<p>å¸Œæœ›è¿™ä¸ªåšå®¢å¯ä»¥åšæŒä¹…ä¸€äº›~</p>\n","site":{"data":{}},"excerpt":"","more":"<h2>å‰è¨€</h2>\n<p>ç¬¬äºŒæ¬¡æ­å»ºåšå®¢äº†ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨çš„è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºäº†wordpressåšå®¢ï¼Œå†™äº†ä¸¤å¹´å·¦å³60+ç¯‡ï¼Œåœ¨æœåŠ¡å™¨åºŸå¼ƒåä¹Ÿä¸å†ç»´æŠ¤äº†ã€‚</p>\n<p>æœ¬æ¬¡åˆå¿ƒè¡€æ¥æ½®ï¼Œä½¿ç”¨nodeçš„hexoå’Œgithubçš„gh-pagesæ¥æ­å»ºã€‚</p>\n<p>å¼€ç¯‡å°±ä»¥åšå®¢æ­å»ºè¿‡ç¨‹ä¸ºä¸»è¦å†…å®¹ã€‚</p>\n<h2>å·¥å…·å‡†å¤‡</h2>\n<blockquote>\n<p>git, node, githubè´¦å·, vscode(éå¿…å¤‡), åŸŸå(éå¿…å¤‡)</p>\n</blockquote>\n<p>è¿™é‡Œéœ€è¦è‡ªè¡Œæœç´¢å­¦ä¹ å®‰è£…äº†</p>\n<h2>åŠ¨æ‰‹æ­å»º</h2>\n<blockquote>\n<p>è´´ä¸ªå®˜æ–¹åœ°å€<br>\n<a href=\"https://hexo.io/zh-cn/\" target=\"_blank\" rel=\"noopener\">https://hexo.io/zh-cn/</a></p>\n</blockquote>\n<p>è¿™é‡Œå°±ä¸è·Ÿç€å®˜æ–¹æ•™ç¨‹èµ°äº†ï¼Œä¸è¿‡å¤§åŒå°å¼‚</p>\n<p>å…ˆåˆ° <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">ä¸»é¢˜é¡µ</a> æ‰¾ä¸ªå–œæ¬¢çš„ä¸»é¢˜</p>\n<p>è¿™é‡Œé€‰äº† <a href=\"https://github.com/huweihuang/hexo-theme-huweihuang\" target=\"_blank\" rel=\"noopener\">A-Boy</a> è¿™ä¸ªä¸»é¢˜ï¼ŒğŸ™„ä¸»è¦æ˜¯ä»–æ¯”è¾ƒåƒæˆ‘ä¹‹å‰çš„åšå®¢é£æ ¼ã€‚</p>\n<figure class=\"highlight vala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># ä¸‹è½½hexoå‘½ä»¤è¡Œå·¥å…·</span></span><br><span class=\"line\">npm install hexo-cli -g</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class=\"line\">mkdir blog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># \bä¸‹è½½ä¸»é¢˜åˆ°è¯¥æ–‡ä»¶å¤¹</span></span><br><span class=\"line\">git clone https:<span class=\"comment\">//github.com/huweihuang/hexo-theme-huweihuang.git ./blog</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># ä¸‹è½½ä¾èµ–åŒ…</span></span><br><span class=\"line\">cd blog</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n<p>æ–‡ä»¶ç»„ç»‡ç»“æ„å¤§è‡´å¦‚ä¸‹</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">/_config.xml</span></span><br><span class=\"line\">ä¸»è¦é…ç½®æ–‡ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/source</span></span><br><span class=\"line\">å­˜æ”¾æ–‡ç«  <span class=\"string\">./_posts</span></span><br><span class=\"line\">å›¾ç‰‡ <span class=\"string\">./img</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/themes</span></span><br><span class=\"line\">ä¸»é¢˜çš„ä¸€äº›æ¨¡æ¿æ–‡ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/scaffolds</span></span><br><span class=\"line\">ä¸€äº›è„šæ‰‹æ¶ï¼ŒåŸç”Ÿå°±åœ¨</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/node_modules</span></span><br><span class=\"line\">å¤–éƒ¨ä¾èµ–çš„æ¨¡å—</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">/db.json</span></span><br><span class=\"line\">å­˜å‚¨æœåŠ¡å™¨è§£æå‡ºæ¥çš„ä¸´æ—¶æ–‡ç« æ•°æ®</span><br><span class=\"line\"></span><br><span class=\"line\">/è¿˜æœ‰ä¸€äº›æš‚æ—¶ç”¨ä¸åˆ°çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>\n<p>å…ˆåˆ°githubå»ºç«‹è‡ªå·±çš„ä»“åº“ï¼Œå°±é•¿ä¸‹é¢è¿™æ ·<br>\n<img src=\"/img/mypost/github.png\" alt=\"github\"></p>\n<p>ç„¶åå¯¹ä¸»é¢˜çš„_config.xmlä¸€äº›é…ç½®é¡¹</p>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®åˆšæ‰çš„githubä»“åº“, ä¸€èˆ¬ä½¿ç”¨gh-pagesåˆ†æ”¯</span></span><br><span class=\"line\"><span class=\"symbol\">deploy:</span></span><br><span class=\"line\"><span class=\"symbol\">  type:</span> git</span><br><span class=\"line\"><span class=\"symbol\">  repo:</span> https:<span class=\"comment\">//github.com/&lt;yourAccount&gt;/&lt;repo&gt;</span></span><br><span class=\"line\"><span class=\"symbol\">  branch:</span> <span class=\"params\">&lt;your-branch&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®è·¯ç”±ï¼Œè¿™é‡Œä½¿ç”¨åŸŸåçš„ç»å¯¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„ä¼šæœ‰ä¸ªå‘-&gt;å›¾ç‰‡å†™ç»å¯¹è·¯å¾„æ—¶ä¸ä¼šæŠŠrootè·¯å¾„åŠ ä¸Š</span></span><br><span class=\"line\"><span class=\"symbol\">url:</span> http:<span class=\"comment\">//ganjiacheng.cn/</span></span><br><span class=\"line\"><span class=\"symbol\">root:</span> /</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\"># é…ç½®ä¸»é¢˜ï¼Œ/theme/ä¸‹çš„å­ç›®å½•æ–‡ä»¶å¤¹</span></span><br><span class=\"line\"><span class=\"symbol\">theme:</span> huweihuang</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight haml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ä¾§è¾¹æ çš„ä¸€äº›é…ç½®</span><br><span class=\"line\">sidebar: true    </span><br><span class=\"line\">sidebar-about-description: \"&lt;your description&gt;\"</span><br><span class=\"line\">sidebar-avatar: img/&lt;your avatar path&gt;</span><br><span class=\"line\">widgets:  </span><br><span class=\"line\">-<span class=\"ruby\"> featured-tags</span></span><br><span class=\"line\"><span class=\"ruby\">- short-about</span></span><br><span class=\"line\"><span class=\"ruby\">- recent-posts</span></span><br><span class=\"line\"><span class=\"ruby\">- friends-blog</span></span><br><span class=\"line\"><span class=\"ruby\">- archive</span></span><br><span class=\"line\"><span class=\"ruby\">- category</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># markdownç¼–è¯‘å™¨çš„ä¸€äº›é…ç½®</span></span><br><span class=\"line\"><span class=\"attr\">markdown:</span></span><br><span class=\"line\"><span class=\"attr\">  render:</span></span><br><span class=\"line\"><span class=\"attr\">    html:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    xhtmlOut:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">    breaks:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    linkify:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    typographer:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    quotes:</span> <span class=\"string\">'â€œâ€â€˜â€™'</span></span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæœ‰é…ç½®èƒŒæ™¯å›¾<br>\næ¨èä¸€ä¸ªå¸¸ç”¨çš„<a href=\"https://bing.ioliu.cn/\" target=\"_blank\" rel=\"noopener\">å£çº¸ç½‘ç«™</a></p>\n<p>ä¸‹é¢æ˜¯ä¸€äº›å‘½ä»¤è¡Œå‘½ä»¤</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ–°å»ºæ–‡ç« </span></span><br><span class=\"line\">hexo new post <span class=\"string\">\"&lt;post name&gt;\"</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ é™¤ä¸´æ—¶æ•°æ®åº“</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¼–è¯‘ä¸ºhtml</span></span><br><span class=\"line\">hexo generate </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¼€å¯server</span></span><br><span class=\"line\">hexo server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä¸Šä¼ åˆ°githubï¼Œç¬¬ä¸€æ¬¡è¦å†™è´¦å·å¯†ç ï¼Œåé¢å°±ä¸ç”¨äº†</span></span><br><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n<h2>ä½¿ç”¨vscodeå†™æ–‡ç« </h2>\n<p>æ‰“å¼€å»ºç«‹çš„é¡¹ç›®æ–‡ä»¶å¤¹</p>\n<p>åœ¨/source/_posts/ä¸‹æ–°å»ºmdæ–‡ä»¶ä¸ºæ–°æ–‡ç« </p>\n<p>ç”±äºæ–‡ç« éƒ½æ˜¯markdownæ ¼å¼ï¼Œç”¨ä¸€èˆ¬æ–‡æœ¬ç¼–è¾‘å™¨æ¯”è¾ƒå›°éš¾ï¼Œæ•…è€Œé€‰åˆ™vscodeï¼Œå› ä¸ºå®ƒå¸¦markdownæ’ä»¶ï¼Œ<br>\nå…¶ä»–å¯é€‰æ‹©çš„ä¹Ÿæœ‰å†™æ–‡ç« çš„hexoæ’ä»¶ <a href=\"https://github.com/jaredly/hexo-admin\" target=\"_blank\" rel=\"noopener\">hexo-admin</a></p>\n<p>command+shift+p æœç´¢markdown open preview to the side</p>\n<p>å°±å¯ä»¥åœ¨å·¦è¾¹å†™å³è¾¹å®æ—¶æŸ¥çœ‹æ•ˆæœäº†</p>\n<p>æ¨èä¸€ä¸ªè‡ªå·±è®°å½•æœ€ç®€markdownæ‰‹å†Œ <a href=\"https://github.com/webgjc/ApiTestToMd/blob/master/md/markdown.md\" target=\"_blank\" rel=\"noopener\">markdownæ‰‹å†Œ</a></p>\n<p>åœ¨markdownæ–‡ä»¶å¼€å¤´åŠ ä¸Šä¸€äº›æ–‡ç« çš„å¿…å¤‡ä¿¡æ¯</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">\"æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"attr\">date:</span> <span class=\"number\">1999</span><span class=\"bullet\">-01</span><span class=\"bullet\">-01</span> <span class=\"number\">00</span><span class=\"string\">:00:00</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span> <span class=\"string\">\"å‰¯æ ‡é¢˜\"</span></span><br><span class=\"line\"><span class=\"attr\">header-img:</span> <span class=\"string\">\"/img/å›¾ç‰‡.jpg\"</span></span><br><span class=\"line\"><span class=\"attr\">tags:</span></span><br><span class=\"line\"><span class=\"bullet\">-</span> <span class=\"string\">æ ‡ç­¾</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åå¼€å§‹å†™æ–‡ç« </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ­¤å¤„çœç•¥ä¸€ä¸‡å­—</span><br></pre></td></tr></table></figure>\n<h2>ä»‹ç»ä¸€äº›æ’ä»¶</h2>\n<p>åŸç”Ÿçš„åšå®¢ä¸å¸¦æ’ä»¶ï¼Œå°‘äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚ç»Ÿè®¡è®¿é—®æ¬¡æ•°ï¼Œè¯„è®ºç³»ç»Ÿç­‰ã€‚</p>\n<p>ä¹Ÿæœ‰ä¸€äº›ä¸»é¢˜ä¹Ÿå†…ç½®äº†ä¸€äº›æ’ä»¶ï¼Œç›´æ¥é…ç½®å³å¯ã€‚</p>\n<p>ç”±äºè¿™äº›åŠŸèƒ½éƒ½å¾—å¸¦åç«¯å­˜å‚¨ï¼Œè‡ªå·±åšä¸ªåˆéº»çƒ¦ï¼Œå› æ­¤ä½¿ç”¨ä¸€äº›åˆ«äººåšçš„å…è´¹çš„ã€‚</p>\n<h3>è®¿é—®æ¬¡æ•°æ’ä»¶</h3>\n<p>è¿™é‡Œè¯•ç”¨ä¸‹ <a href=\"http://busuanzi.ibruce.info/\" target=\"_blank\" rel=\"noopener\">ä¸è’œå­</a> æ¥åšè®¿é—®æ¬¡æ•°ã€‚</p>\n<p>ç¼–è¾‘ /_config.yml åœ¨æœ€ååŠ ä¸Š</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">busuanzi:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ°/themes/ä¸»é¢˜å/layout/_partial/footer.ejs</p>\n<p>åœ¨åº•éƒ¨&lt;/footer&gt;æ ‡ç­¾å‰åŠ ä¸Šï¼Œå°±æ˜¯ç½‘ç«™æ¬¡æ•°ç»Ÿè®¡ï¼Œæˆ–è€…è‡ªå·±æƒ³åŠ å“ªåŠ å“ª</p>\n<figure class=\"highlight erb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> <span class=\"keyword\">if</span> (theme.busuanzi &amp;&amp; theme.busuanzi.enable)&#123; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">async</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align: center;\"</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            æœ¬ç«™æ€»è®¿é—®é‡<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>æ¬¡</span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-divider\"</span>&gt;</span>|<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">            æœ¬ç«™è®¿å®¢æ•°<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_uv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>äºº</span></span><br><span class=\"line\"><span class=\"xml\">        <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> &#125; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br></pre></td></tr></table></figure>\n<p>ä¸‹é¢è¿™ä¸ªæ˜¯é¡µé¢è®¿é—®æ¬¡æ•°</p>\n<figure class=\"highlight erb\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> <span class=\"keyword\">if</span> (theme.busuanzi &amp;&amp; theme.busuanzi.enable)&#123; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\">        Viewed <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_page_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> times</span></span><br><span class=\"line\"><span class=\"xml\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">%</span></span></span><span class=\"ruby\"> &#125; </span><span class=\"xml\"><span class=\"tag\">%&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h3>è¯„è®ºæ’ä»¶</h3>\n<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<a href=\"https://valine.js.org/\" target=\"_blank\" rel=\"noopener\">valine</a> å’Œ <a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">leancloud</a></p>\n<p>valineæ˜¯å‰ç«¯éƒ¨åˆ†åµŒå…¥ç»„ä»¶ï¼Œleancloudæ¥å­˜å‚¨ä¿¡æ¯</p>\n<p>æ³¨å†Œç­‰æ­¥éª¤å°±ä¸è´´äº†,çœ‹<a href=\"https://valine.js.org/quickstart.html\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>è¯´ä¸‹åµŒå…¥çš„éƒ¨åˆ†ï¼Œåœ¨/themes/ä¸»é¢˜å/post.ejs</p>\n<p>æ‰¾ä¸ªåˆé€‚çš„æ ‡ç­¾ä¸‹é¢åŠ å…¥ï¼ŒåŸºæœ¬å°±å’Œä¸Šé¢æ–‡ç« å¯¹é½å°±è¡Œ</p>\n<figure class=\"highlight coffeescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script src=<span class=\"string\">'//unpkg.com/valine/dist/Valine.min.js'</span>&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;h5&gt;COMMENT&lt;/h5&gt;</span><br><span class=\"line\">&lt;div id=<span class=\"string\">\"vcomments\"</span>&gt;&lt;/div&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    <span class=\"keyword\">new</span> Valine(&#123;</span><br><span class=\"line\">        el: <span class=\"string\">'#vcomments'</span>,</span><br><span class=\"line\">        appId: <span class=\"string\">'&lt;AppId&gt;'</span>, <span class=\"comment\">#è¿™ä¸ªè¦æ³¨å†Œåæ‹¿åˆ°</span></span><br><span class=\"line\">        appKey: <span class=\"string\">'&lt;AppKey&gt;'</span>, <span class=\"comment\">#è¿™ä¸ªåŒä¸Š</span></span><br><span class=\"line\">        notify:<span class=\"literal\">false</span>, </span><br><span class=\"line\">        verify:<span class=\"literal\">false</span>, </span><br><span class=\"line\">        avatar:<span class=\"string\">'mp'</span>, </span><br><span class=\"line\">        placeholder: <span class=\"string\">'æ¥äº†è€å¼Ÿ #markdownæ ¼å¼'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">\"info\"</span>)[<span class=\"number\">0</span>].style.display=<span class=\"string\">\"none\"</span>;</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<p>ç‰¹åœ°è¯´ä¸‹åŠ settimeouté‚£æ­¥æ˜¯ä¸ºäº†éšè—è‡ªå¸¦çš„powerä¿¡æ¯ğŸ™ƒ</p>\n<p>è¯„è®ºï¼Œç„¶åå°±å¯ä»¥åœ¨leancloud å­˜å‚¨-&gt;ç»“æ„åŒ–æ•°æ®-&gt;commentçœ‹åˆ°è¯„è®ºä¿¡æ¯</p>\n<p>æ•²é»‘æ¿ï¼Œä¸‹é¢æ˜¯é‡ç‚¹ğŸ‘‡ğŸ˜ğŸ˜</p>\n<blockquote>\n<p>å·¦è¾¹å¦¹å­çš„æ’ä»¶å°±æœä¸‹ <a href=\"https://www.baidu.com/s?ie=UTF-8&amp;wd=hexo%20live2d\" target=\"_blank\" rel=\"noopener\">hexo live2d</a></p>\n</blockquote>\n<h2>åŸŸåé…ç½®</h2>\n<p>æœ€åæ¥äº†è§£ä¸€ä¸‹ä¸Šä¼ åˆ°githubååŸŸåé…ç½®ã€‚</p>\n<p>åœ¨ hexo deploy å‰</p>\n<p>é…ç½® /source/CNAME, å†™è§£æåçš„åŸŸå</p>\n<p>åœ¨ä¹°åŸŸåçš„åŸŸåç®¡ç†å¤„è¿›è¡ŒåŸŸåè§£æ</p>\n<p>è®°å½•ç±»å‹CNAME =&gt; <a href=\"http://xn--github-ud6jy198a.github.io\" target=\"_blank\" rel=\"noopener\">githubè´¦å·.github.io</a></p>\n<p>å°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®å•¦ï¼</p>\n<h2>å¤šç»ˆç«¯åŒæ­¥</h2>\n<p>è¿™ä¸ªä¹Ÿå¾ˆå¸¸è§ï¼Œå°±æ˜¯åœ¨å¤šä¸ªåœ°æ–¹å†™åšå®¢ï¼Œæƒ³è¿™è¾¹å†™å®ŒåŒæ­¥åˆ°å„ä¸ªå®¢æˆ·ç«¯ã€‚</p>\n<p>å¦‚æœæ˜¯æœ‰è‡ªå·±æœåŠ¡å™¨çš„ï¼Œå°±è£…ä¸ªhexo-adminçš„æ’ä»¶ï¼Œå¼€å¯hexo serveråç›‘å¬åˆ°å…¬ç½‘ç«¯å£ï¼Œä¸æ”¾å¿ƒçš„è¯å…¥å£åŠ ä¸ªè®¤è¯ï¼Œå°±å¯ä»¥åœ¨çº¿ç¼–è¾‘ã€‚</p>\n<p>ä¸€èˆ¬çš„åšæ³•æ˜¯ä½¿ç”¨åˆšæ‰å»ºçš„githubä»“åº“çš„masteråˆ†æ”¯ä½œä¸ºæ–‡ç« æºç ï¼Œgh-pagesåˆ†æ”¯ä½œä¸ºé™æ€åšå®¢ã€‚</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">é¡¹ç›®æ ¹ç›®å½•ä¸‹/</span><br><span class=\"line\"><span class=\"comment\"># å¼•å…¥git</span></span><br><span class=\"line\">git init</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®è¿œç¨‹åœ°å€</span></span><br><span class=\"line\">git remote <span class=\"keyword\">add</span><span class=\"bash\"> origin gitåœ°å€</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># pullä¸€ä¸‹è¿œç¨‹çš„æäº¤ï¼Œæœ‰å†²çªå°±è§£å†³ä¸‹/æ–‡ä»¶å¤‡ä»½/é‡å‘½å</span></span></span><br><span class=\"line\"><span class=\"bash\">git pull origin master --allow-unrelated-histories</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># æ·»åŠ .gitignoreï¼ŒåŠ å…¥</span></span></span><br><span class=\"line\"><span class=\"bash\">public/</span></span><br><span class=\"line\"><span class=\"bash\">.vscode</span></span><br><span class=\"line\"><span class=\"bash\">node_modules</span></span><br><span class=\"line\"><span class=\"bash\"></span></span><br><span class=\"line\"><span class=\"bash\"><span class=\"comment\"># gitä¸‰è¿</span></span></span><br><span class=\"line\"><span class=\"bash\">git add .</span></span><br><span class=\"line\"><span class=\"bash\">git commit -m <span class=\"string\">\"\"</span></span></span><br><span class=\"line\"><span class=\"bash\">git push origin master</span></span><br></pre></td></tr></table></figure>\n<p>ç»ˆç«¯ä½¿ç”¨å†™åšå®¢å‰å…ˆclone / pullä¸€ä¸‹ï¼Œ</p>\n<p>å†™å®Œdeployå å† gitä¸‰è¿å°±è¡Œ</p>\n<h2>æ‹“å±•å†…å®¹</h2>\n<p>è‡ªå»ºä¸»é¢˜</p>\n<p>åˆ«äººçš„ä¸»é¢˜è¦è‡ªå®šä¹‰çš„è¯è¿˜æ˜¯æ”¹å¾ˆå¤šï¼Œæœ‰æƒ³æ³•å¯ä»¥è‡ªè¡Œå¼€å‘ä¸»é¢˜</p>\n<p>ä»ä¸Šé¢åŸºæœ¬ä¹Ÿå¯ä»¥çŸ¥é“ä¸»é¢˜çš„å°±æ˜¯åœ¨ /theme/ä¸‹åˆ›å»ºçš„æ–‡ä»¶å¤¹,<br>\nç„¶åä¿®æ”¹_config.ymlçš„ä¸»é¢˜é…ç½®</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ä¸»é¢˜ä¸‹ä¸»è¦æ–‡ä»¶ç»“æ„</span><br><span class=\"line\"><span class=\"string\">/layout</span> <span class=\"comment\"># ä¸»è¦å¸ƒå±€ï¼Œæ ·å¼æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"string\">/source</span> <span class=\"comment\"># å¤–éƒ¨js cssç­‰</span></span><br><span class=\"line\">_config.yml <span class=\"comment\"># é…ç½®æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>\n<p>æ•°æ®ä¸»è¦é æ¨¡æ¿çš„æ–¹å¼åŠ è½½ï¼Œå…¶ä»–è¿˜æ˜¯å’ŒåŸç”Ÿjså·®ä¸å¤š</p>\n<p>è´´ä¸ªä¸é”™çš„<a href=\"https://www.cnblogs.com/yyhh/p/11058985.html\" target=\"_blank\" rel=\"noopener\">æ•™ç¨‹</a></p>\n<h2>æœ€åä¸€å¸­è¯</h2>\n<p>githubæœ‰æ—¶ä¼šè¢«å¢™ï¼Œæœ‰æ—¶ä¼šè®¿é—®æ…¢ï¼Œè¿™ä¸ªå›½å†…ä¸ä¸€å®šç¨³å®šğŸ¤”</p>\n<p>ä½“éªŒæ¥è¯´ç›¸æ¯”äºç®€ä¹¦ç­‰æ¥è¯´ï¼Œæ­å»ºè¿‡ç¨‹è¿˜æ˜¯éœ€è¦ä¸€å®šåŸºç¡€ï¼Œå†™èµ·æ¥ä¹Ÿéƒ½markdownï¼Œ</p>\n<p>ä½†èƒœåœ¨å¯ä»¥è‡ªå®šä¹‰èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿(è£…é€¼ä¸‡å²)ã€‚</p>\n<p>ä¸ºäº†åšæŒå†™åšå®¢ä¹‹å‰ä¸€ç›´ç”¨çš„æ˜¯å…ˆç«‹æ ‡é¢˜æ–‡ç« ï¼Œå‡ æ˜ŸæœŸè¿‡å»æœ‰æƒ³æ³•å’Œæ–¹æ³•äº†å†å»å¡«å……å®Œæˆå‰©ä¸‹çš„æ–‡ç« å†…å®¹ï¼Œè¿™ä¸ªä¸€ç›´éƒ½è¿˜ä¸é”™ã€‚</p>\n<p>å¸Œæœ›è¿™ä¸ªåšå®¢å¯ä»¥åšæŒä¹…ä¸€äº›~</p>\n"},{"title":"hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†","catalog":true,"date":"2020-04-05T08:35:20.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"\n## Hiveå…ƒæ•°æ®é‡‡é›†\n\né¦–å…ˆä»¥hiveä¸¾ä¾‹ï¼Œ\n\nhiveå¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¾—åˆ°å¤§éƒ¨åˆ†è¡¨å’Œå­—æ®µçš„å…ƒæ•°æ®ï¼Œ  \nä½†å› ä¸ºè¿™æ ·æ¯ä¸ªéƒ½è¦æ‰§è¡Œå°±å¾ˆæ…¢ã€‚\n> DESCRIBE FORMATTED {tablename}\n\nç„¶åç›´æ¥å°è¯•ä»metastoreåº“é‡‡é›†ï¼Œè¿™é‡Œä¸åšmetastoreå…·ä½“ç»“æ„çš„è®ºè¿°ï¼Œ  \næƒ³äº†è§£è¯¦ç»†ç»“æ„å¯ä»¥ç§»æ­¥[Hive MetaStoreçš„ç»“æ„](https://www.jianshu.com/p/420ddb3bde7f)ã€‚\n\nå› ä¸ºæ˜¯æŒ‰åº“é‡‡é›†ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ–¹æ³•æ˜¯å…ˆåˆ°é€šè¿‡åº“è·å–åº“ä¸‹çš„å…¨éƒ¨è¡¨åˆ—è¡¨ï¼Œ  \nå†é€šè¿‡åº“è·å–å…¨éƒ¨è¡¨çš„å­—æ®µï¼Œç„¶ååœ¨ä»£ç é‡Œè¿›è¡Œå¯¹åº”è¡¨å­—æ®µçš„æ•´åˆï¼Œ  \nå› ä¸ºè¦å¯¹æ¯ä¸ªè¡¨éƒ½è¿›è¡Œæ¯”å¯¹ä¿®æ”¹å’Œç‰ˆæœ¬è®°å½•ç­‰ï¼Œå› æ­¤å°±ä¸€ä¸ªä¸ªè¡¨è¿›è¡Œå¤„ç†å…¥åº“ã€‚  \nè¿™æ ·å–æ•°çš„è¿‡ç¨‹å› ä¸ºå°±ä¸¤ä¸ªmysqläº‹åŠ¡çš„æ­¥éª¤ï¼Œå®é™…å°±å¾ˆå¿«ï¼Œä½†å…¥åº“æ—¶çš„æ•ˆç‡å°±ä¼šåä½ã€‚\n\nä¸‹é¢æ˜¯Metastoreè·å–åº“ï¼Œè¡¨ï¼Œå­—æ®µçš„å…·ä½“æ“ä½œï¼š\n- å…ˆæœ‰è¦é‡‡é›†çš„åº“åï¼Œåˆ°**dbs**è¡¨æ ¹æ®nameæŸ¥è¯¢åˆ°å¯¹åº”çš„ä¸€æ¡æ•°æ®ï¼Œå¾—åˆ°åº“çš„ä¸€äº›ä¿¡æ¯ï¼Œè®°å½•ä¸‹**db_id**;\n- æ ¹æ®å¾—åˆ°çš„**db_id**åœ¨tblsè¡¨æ‰¾åˆ°å¯¹åº”**db_id**çš„è¡¨åˆ—è¡¨ï¼Œæ¯æ¡æ•°æ®åŒ…å«äº†è¡¨åï¼Œç±»å‹ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ï¼›\n- è¡¨çš„å…ƒæ•°æ®è¿˜ä¸å¤Ÿï¼Œæœ‰ä¸€éƒ¨åˆ†åœ¨**table_params**è¡¨ä¸­ï¼Œä»–çš„å­˜å‚¨æ–¹å¼æ˜¯**tbl_id, keyï¼Œvalueï¼Œkey**åŒ…å«äº†æ–‡ä»¶æ•°ï¼Œè¡Œæ•°ï¼Œå¤§å°ï¼Œå¤‡æ³¨ï¼Œæ›´æ–°æ—¶é—´ç­‰(æœ‰äº›ä¸ä¸€å®šé è°±)\n- é€šè¿‡**tbl_id**åˆ°**partition**ï¼Œ**partition_params**ï¼Œ**partition_keys**å¯ä»¥æ‹¿åˆ°åˆ†åŒºè¡¨çš„åˆ†åŒºä¿¡æ¯å’Œå…¨éƒ¨åˆ†åŒºçš„å¤§å°\n  \n\n- ç„¶åæ˜¯å–ä¸€ä¸ªåº“çš„å…¨éƒ¨å­—æ®µï¼Œå½“ç„¶å­—æ®µéƒ½æ˜¯è¦å¸¦æœ‰**tbl_id**çš„ï¼Œè¿™æ ·æ‰èƒ½ä¸ä¸Šé¢è¡¨åˆ—è¡¨å¯¹åº”ã€‚\n- é€šè¿‡**db_id**ä»**tbls**è·å–åˆ°å¯¹åº”çš„è¡¨åˆ—è¡¨ï¼Œé€šè¿‡åˆ—è¡¨ä¸­çš„**sd_id**åˆ°è¡¨sdså¾—åˆ°å¯¹åº”çš„**cd_id**åˆ—è¡¨\n- é€šè¿‡**cd_id**åˆ—è¡¨åˆ°è¡¨**columns_v2**è·å–åˆ°å¯¹åº”çš„å­—æ®µä¿¡æ¯\n- å¦å¤–åˆ†åŒºå­—æ®µéœ€è¦é¢å¤–ä»**partition_keys**é€šè¿‡**tbl_id**è·å–\n\nä½¿ç”¨ä¸Šè¿°æ“ä½œï¼Œå°†è¡¨ä¿¡æ¯å’Œå­—æ®µä¿¡æ¯åˆ†åˆ«ä½¿ç”¨joinæ‹¼æ¥ä¸ºä¸€å¼ å¤§è¡¨ï¼ˆè¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›æ…¢æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåŒæ­¥æ”¾åˆ°ä»åº“é‡Œï¼‰ï¼Œè¿™æ ·å°±å·²ç»æ‹¿åˆ°äº†åŸºæœ¬æƒ³è¦çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡tbl_idå¯¹è¡¨å’Œå­—æ®µæ•°æ®è¿›è¡Œæ•´åˆï¼Œåœ¨æŠŠè¡¨ä¸€å¼ å¼ è¿›è¡Œå¤„ç†æ›´æ–°æˆ–æ–°å»ºï¼ŒåŒæ—¶æ›´æ–°ç›¸å…³è”çš„é¡¹ï¼›\n\n## Mysqlå…ƒæ•°æ®é‡‡é›†\n\nMysqlæŒ‰ç†æ¥è¯´æ˜¯å’Œä¸Šé¢metastoreåŸºæœ¬ä¸€æ ·çš„ï¼Œä½†è¿™è¾¹æƒ³æ›´å¿«ä¸€ç‚¹ï¼Œä¸”å¯ä»¥å¿½ç•¥è°ƒè¡¨ã€å­—æ®µå’Œå…¶ä»–æœ‰å¤–é”®å…³è”çš„é¡¹ï¼›\n\ninformation_schemaçš„ç»“æ„å¤§è‡´è§[è¿™é‡Œ](https://www.jianshu.com/p/c08fe8e01c0a)\n\nè¿™é‡Œä»¥tablesè¡¨ä¸ºä¾‹ï¼Œå­˜äº†å¤§éƒ¨åˆ†è¡¨å…ƒæ•°æ®ï¼Œå–æ•°æ®æ¯”å¦‚åº“è®°å½•id \n> database_id = 2   \n> database_name = db_test\n\nå–è¡¨æ•°æ®æ•°æ®\n\n> select `TABLE_SCHEMA`, `TABLE_NAME`, `TABLE_TYPE`  \n> form `TABLES` where `TABLE_SCHEMA` = 'db_test'\n\nåœ¨å¾€åç«¯åŒæ­¥æ•°æ®æ—¶ï¼Œå…ˆå»ºä¸€ä¸ªdb_id ä¸ table_name çš„å”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨on duplicate key updateå®ç°å¯¹æ’å…¥æ•°æ®è¿˜æ˜¯æ›´æ–°æ•°æ®çš„æ£€æŸ¥ã€‚ä¾‹å¦‚ä¸‹\n\n> insert into back_table  \n> (db_id, table_name, table_type)  \n> values  \n> ('test', 'db_test', 'test', 'test')  \n> on duplicate key update  \n> table_name=values(table_name),  \n> table_type=values(table_type);\n\nç„¶åç›´æ¥å®Œæˆå¯¹åç«¯å…ƒæ•°æ®çš„åŒæ­¥ã€‚å­—æ®µåŒç†ã€‚\n\nè¿™ç§æ–¹å¼é‡‡é›†ä¸€èˆ¬çš„åº“å‡ ç™¾å¼ è¡¨å’Œå­—æ®µçš„å°±éå¸¸å¿«äº†ï¼ŒåŸºæœ¬éƒ½3ç§’ä»¥å†…ã€‚ä½†ä¹Ÿè¦è€ƒè™‘åœ¨è¡¨å’Œå­—æ®µæ¯”è¾ƒå¤šçš„æ—¶å€™è¦è¿›è¡Œåˆ†æ‰¹å¤„ç†ï¼Œå¦åˆ™å¯èƒ½ä¸€ä¸ªsqlè¿‡å¤§æˆ–æ’å…¥è¿‡æ…¢ã€‚\n\n## å…³äºå®æ—¶é‡‡é›†\n\nä¸Šé¢è®²åˆ°çš„æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹å…¨éƒ¨å…ƒæ•°æ®è¿›è¡Œå®šæ—¶é‡‡é›†ï¼Œå®šæ—¶çš„å…¨é‡é‡‡é›†æœ‰ä¸ªç¼ºç‚¹å°±å¾ˆæ…¢ï¼Œå»ºäº†è¡¨å¥½ä¹…æ‰èƒ½åŒæ­¥åˆ°ã€‚\n\nä¸€èˆ¬ä¼˜åŒ–çš„æ–¹å¼æ˜¯å®šæ—¶é‡‡é›†ä¹Ÿå¯ä»¥åˆ†ä¸ºæ–°è¡¨é‡‡é›†ä¸å…¨é‡é‡‡é›†ï¼Œè¿™æ ·æŠŠæ–°è¡¨é‡‡é›†çš„é¢‘ç‡å˜é«˜ï¼Œå…¨é‡é‡‡é›†ä¸å˜ï¼Œå¯ä»¥ç¨å¾®ä¼˜åŒ–ä¸‹ä½“éªŒã€‚\n\nç„¶åè¿™é‡Œå†æ¥è€ƒè™‘ä¸€ä¸‹å®æ—¶é‡‡é›†çš„æ–¹æ¡ˆã€‚\n\nä¸»è¦åˆ©ç”¨çš„æ˜¯mysqlçš„binlogï¼Œå…ˆå¼€å¯MySQLçš„binlogï¼›\n\nç„¶åä½¿ç”¨MySQL binlogçš„å¢é‡è®¢é˜…&æ¶ˆè´¹ç»„ä»¶ï¼Œå¦‚aliçš„canalï¼Œå°†binlogçš„jsonæ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚kafkaï¼›\n\nç„¶åå†™ä¸€ä¸ªæ¶ˆè´¹ç«¯å»æ¶ˆè´¹ï¼Œå¦‚æœæ¶ˆè´¹åˆ°createè¯­å¥ï¼Œå°±æ ¹æ®åº“åï¼Œè¡¨ååˆ°æºæ•°æ®åº“è¿›è¡Œä¸€æ¬¡å•è¡¨çš„é‡‡é›†ã€‚è¿™æ ·å°±å¯ä»¥å®ç°å»ºè¡¨å³å®æ—¶é‡‡é›†åˆ°å…ƒæ•°æ®ç³»ç»Ÿä¸­ã€‚\n\nmysqlå¼€å¯binlogè§[è¿™é‡Œ](https://www.jianshu.com/p/5870cf1affb6)\n\ncanalè¿æ¥mysqlæ¥å—binlogå¹¶æŠŠæ•°æ®æŠ•é€’åˆ°kafkaè§[è¿™é‡Œå®˜æ–¹æ•™ç¨‹](https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart)(å®‰è£…æ•™ç¨‹ä¹Ÿåœ¨è¿™é‡Œ)\n\nä¹‹åå†™ä¸ªkafkaæ¶ˆè´¹ç«¯æ¥æ¥å—jsonçš„binlogæ•°æ®ï¼Œå¹¶å¾—åˆ°åº“è¡¨å»è¿›è¡Œé‡‡é›†åŒæ­¥ï¼Œ  \nè¿™é‡Œç”¨javaå®ç°å®ç°äº†ä¸€ä¸ªæ¶ˆè´¹kafkaçš„demoã€‚\n``` Java\npackage cn.ganjiacheng;\n\nimport org.apache.kafka.clients.consumer.ConsumerRecord;\nimport org.apache.kafka.clients.consumer.ConsumerRecords;\nimport org.apache.kafka.clients.consumer.KafkaConsumer;\n\nimport java.util.Collections;\nimport java.util.Properties;\n\n/**\n * @description:\n * @author: again\n * @email: 935669873@qq.com\n * @date: 2020/3/9 11:46 ä¸Šåˆ\n */\npublic class KafkaConsumerTest {\n\n    public static void main(String[] args) {\n        String topic = \"mysqldata\";\n        String groupID = \"lalal\";\n\n        Properties props = new Properties();\n        props.put(\"bootstrap.servers\", \"localhost:9092\");\n        props.put(\"group.id\", groupID);\n        props.put(\"enable.auto.commit\", \"true\");\n        props.put(\"auto.commit.interval.ms\", \"1000\");\n        props.put(\"auto.offset.reset\", \"earliest\");\n        props.put(\"key.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\");\n        props.put(\"value.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\");\n        KafkaConsumer<String, String> consumer = new KafkaConsumer<String, String>(props);\n\n        consumer.subscribe(Collections.singletonList(topic));\n        try {\n            while (true) {\n                ConsumerRecords<String, String> records = consumer.poll(1000);\n                for(ConsumerRecord<String, String> record: records) {\n                    System.out.println(String.format(\"offset = %s, key = %s, value = %s\", record.offset(), record.key(), record.value()));\n                }\n            }\n        } finally {\n            consumer.close();\n        }\n    }\n}\n```\n\nå¼€å¯canalçš„flatMessageä¸ºtrueï¼Œæ‹¿åˆ°çš„æ•°æ®ä¸ºjsonæ ¼å¼ï¼Œ  \nä»valueé‡Œè§£æjsonæ•°æ®å¦‚ä¸‹ï¼Œèƒ½æ‹¿åˆ°databaseå’Œtableã€‚\nä¹‹åå°±å¯ä»¥è¿›è¡Œå…ƒæ•°æ®é‡‡é›†ã€‚\n``` json\n{\n    \"data\": null,\n    \"database\": \"canal\",\n    \"es\": 1586092113000,\n    \"id\": 1,\n    \"isDdl\": true,\n    \"mysqlType\": null,\n    \"old\": null,\n    \"pkNames\": null,\n    \"sql\": \"sql sql sql\",\n    \"sqlType\": null,\n    \"table\": \"table_name\",\n    \"ts\": 1586092904217,\n    \"type\": \"CREATE\"\n}\n```","source":"_posts/hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†.md","raw":"---\ntitle: hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†\ncatalog: true\ndate: 2020-04-05 16:35:20\nsubtitle:\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- å…ƒæ•°æ®\n- å¤§æ•°æ®\n- Mysql\n---\n\n## Hiveå…ƒæ•°æ®é‡‡é›†\n\né¦–å…ˆä»¥hiveä¸¾ä¾‹ï¼Œ\n\nhiveå¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¾—åˆ°å¤§éƒ¨åˆ†è¡¨å’Œå­—æ®µçš„å…ƒæ•°æ®ï¼Œ  \nä½†å› ä¸ºè¿™æ ·æ¯ä¸ªéƒ½è¦æ‰§è¡Œå°±å¾ˆæ…¢ã€‚\n> DESCRIBE FORMATTED {tablename}\n\nç„¶åç›´æ¥å°è¯•ä»metastoreåº“é‡‡é›†ï¼Œè¿™é‡Œä¸åšmetastoreå…·ä½“ç»“æ„çš„è®ºè¿°ï¼Œ  \næƒ³äº†è§£è¯¦ç»†ç»“æ„å¯ä»¥ç§»æ­¥[Hive MetaStoreçš„ç»“æ„](https://www.jianshu.com/p/420ddb3bde7f)ã€‚\n\nå› ä¸ºæ˜¯æŒ‰åº“é‡‡é›†ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ–¹æ³•æ˜¯å…ˆåˆ°é€šè¿‡åº“è·å–åº“ä¸‹çš„å…¨éƒ¨è¡¨åˆ—è¡¨ï¼Œ  \nå†é€šè¿‡åº“è·å–å…¨éƒ¨è¡¨çš„å­—æ®µï¼Œç„¶ååœ¨ä»£ç é‡Œè¿›è¡Œå¯¹åº”è¡¨å­—æ®µçš„æ•´åˆï¼Œ  \nå› ä¸ºè¦å¯¹æ¯ä¸ªè¡¨éƒ½è¿›è¡Œæ¯”å¯¹ä¿®æ”¹å’Œç‰ˆæœ¬è®°å½•ç­‰ï¼Œå› æ­¤å°±ä¸€ä¸ªä¸ªè¡¨è¿›è¡Œå¤„ç†å…¥åº“ã€‚  \nè¿™æ ·å–æ•°çš„è¿‡ç¨‹å› ä¸ºå°±ä¸¤ä¸ªmysqläº‹åŠ¡çš„æ­¥éª¤ï¼Œå®é™…å°±å¾ˆå¿«ï¼Œä½†å…¥åº“æ—¶çš„æ•ˆç‡å°±ä¼šåä½ã€‚\n\nä¸‹é¢æ˜¯Metastoreè·å–åº“ï¼Œè¡¨ï¼Œå­—æ®µçš„å…·ä½“æ“ä½œï¼š\n- å…ˆæœ‰è¦é‡‡é›†çš„åº“åï¼Œåˆ°**dbs**è¡¨æ ¹æ®nameæŸ¥è¯¢åˆ°å¯¹åº”çš„ä¸€æ¡æ•°æ®ï¼Œå¾—åˆ°åº“çš„ä¸€äº›ä¿¡æ¯ï¼Œè®°å½•ä¸‹**db_id**;\n- æ ¹æ®å¾—åˆ°çš„**db_id**åœ¨tblsè¡¨æ‰¾åˆ°å¯¹åº”**db_id**çš„è¡¨åˆ—è¡¨ï¼Œæ¯æ¡æ•°æ®åŒ…å«äº†è¡¨åï¼Œç±»å‹ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ï¼›\n- è¡¨çš„å…ƒæ•°æ®è¿˜ä¸å¤Ÿï¼Œæœ‰ä¸€éƒ¨åˆ†åœ¨**table_params**è¡¨ä¸­ï¼Œä»–çš„å­˜å‚¨æ–¹å¼æ˜¯**tbl_id, keyï¼Œvalueï¼Œkey**åŒ…å«äº†æ–‡ä»¶æ•°ï¼Œè¡Œæ•°ï¼Œå¤§å°ï¼Œå¤‡æ³¨ï¼Œæ›´æ–°æ—¶é—´ç­‰(æœ‰äº›ä¸ä¸€å®šé è°±)\n- é€šè¿‡**tbl_id**åˆ°**partition**ï¼Œ**partition_params**ï¼Œ**partition_keys**å¯ä»¥æ‹¿åˆ°åˆ†åŒºè¡¨çš„åˆ†åŒºä¿¡æ¯å’Œå…¨éƒ¨åˆ†åŒºçš„å¤§å°\n  \n\n- ç„¶åæ˜¯å–ä¸€ä¸ªåº“çš„å…¨éƒ¨å­—æ®µï¼Œå½“ç„¶å­—æ®µéƒ½æ˜¯è¦å¸¦æœ‰**tbl_id**çš„ï¼Œè¿™æ ·æ‰èƒ½ä¸ä¸Šé¢è¡¨åˆ—è¡¨å¯¹åº”ã€‚\n- é€šè¿‡**db_id**ä»**tbls**è·å–åˆ°å¯¹åº”çš„è¡¨åˆ—è¡¨ï¼Œé€šè¿‡åˆ—è¡¨ä¸­çš„**sd_id**åˆ°è¡¨sdså¾—åˆ°å¯¹åº”çš„**cd_id**åˆ—è¡¨\n- é€šè¿‡**cd_id**åˆ—è¡¨åˆ°è¡¨**columns_v2**è·å–åˆ°å¯¹åº”çš„å­—æ®µä¿¡æ¯\n- å¦å¤–åˆ†åŒºå­—æ®µéœ€è¦é¢å¤–ä»**partition_keys**é€šè¿‡**tbl_id**è·å–\n\nä½¿ç”¨ä¸Šè¿°æ“ä½œï¼Œå°†è¡¨ä¿¡æ¯å’Œå­—æ®µä¿¡æ¯åˆ†åˆ«ä½¿ç”¨joinæ‹¼æ¥ä¸ºä¸€å¼ å¤§è¡¨ï¼ˆè¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›æ…¢æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåŒæ­¥æ”¾åˆ°ä»åº“é‡Œï¼‰ï¼Œè¿™æ ·å°±å·²ç»æ‹¿åˆ°äº†åŸºæœ¬æƒ³è¦çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡tbl_idå¯¹è¡¨å’Œå­—æ®µæ•°æ®è¿›è¡Œæ•´åˆï¼Œåœ¨æŠŠè¡¨ä¸€å¼ å¼ è¿›è¡Œå¤„ç†æ›´æ–°æˆ–æ–°å»ºï¼ŒåŒæ—¶æ›´æ–°ç›¸å…³è”çš„é¡¹ï¼›\n\n## Mysqlå…ƒæ•°æ®é‡‡é›†\n\nMysqlæŒ‰ç†æ¥è¯´æ˜¯å’Œä¸Šé¢metastoreåŸºæœ¬ä¸€æ ·çš„ï¼Œä½†è¿™è¾¹æƒ³æ›´å¿«ä¸€ç‚¹ï¼Œä¸”å¯ä»¥å¿½ç•¥è°ƒè¡¨ã€å­—æ®µå’Œå…¶ä»–æœ‰å¤–é”®å…³è”çš„é¡¹ï¼›\n\ninformation_schemaçš„ç»“æ„å¤§è‡´è§[è¿™é‡Œ](https://www.jianshu.com/p/c08fe8e01c0a)\n\nè¿™é‡Œä»¥tablesè¡¨ä¸ºä¾‹ï¼Œå­˜äº†å¤§éƒ¨åˆ†è¡¨å…ƒæ•°æ®ï¼Œå–æ•°æ®æ¯”å¦‚åº“è®°å½•id \n> database_id = 2   \n> database_name = db_test\n\nå–è¡¨æ•°æ®æ•°æ®\n\n> select `TABLE_SCHEMA`, `TABLE_NAME`, `TABLE_TYPE`  \n> form `TABLES` where `TABLE_SCHEMA` = 'db_test'\n\nåœ¨å¾€åç«¯åŒæ­¥æ•°æ®æ—¶ï¼Œå…ˆå»ºä¸€ä¸ªdb_id ä¸ table_name çš„å”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨on duplicate key updateå®ç°å¯¹æ’å…¥æ•°æ®è¿˜æ˜¯æ›´æ–°æ•°æ®çš„æ£€æŸ¥ã€‚ä¾‹å¦‚ä¸‹\n\n> insert into back_table  \n> (db_id, table_name, table_type)  \n> values  \n> ('test', 'db_test', 'test', 'test')  \n> on duplicate key update  \n> table_name=values(table_name),  \n> table_type=values(table_type);\n\nç„¶åç›´æ¥å®Œæˆå¯¹åç«¯å…ƒæ•°æ®çš„åŒæ­¥ã€‚å­—æ®µåŒç†ã€‚\n\nè¿™ç§æ–¹å¼é‡‡é›†ä¸€èˆ¬çš„åº“å‡ ç™¾å¼ è¡¨å’Œå­—æ®µçš„å°±éå¸¸å¿«äº†ï¼ŒåŸºæœ¬éƒ½3ç§’ä»¥å†…ã€‚ä½†ä¹Ÿè¦è€ƒè™‘åœ¨è¡¨å’Œå­—æ®µæ¯”è¾ƒå¤šçš„æ—¶å€™è¦è¿›è¡Œåˆ†æ‰¹å¤„ç†ï¼Œå¦åˆ™å¯èƒ½ä¸€ä¸ªsqlè¿‡å¤§æˆ–æ’å…¥è¿‡æ…¢ã€‚\n\n## å…³äºå®æ—¶é‡‡é›†\n\nä¸Šé¢è®²åˆ°çš„æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹å…¨éƒ¨å…ƒæ•°æ®è¿›è¡Œå®šæ—¶é‡‡é›†ï¼Œå®šæ—¶çš„å…¨é‡é‡‡é›†æœ‰ä¸ªç¼ºç‚¹å°±å¾ˆæ…¢ï¼Œå»ºäº†è¡¨å¥½ä¹…æ‰èƒ½åŒæ­¥åˆ°ã€‚\n\nä¸€èˆ¬ä¼˜åŒ–çš„æ–¹å¼æ˜¯å®šæ—¶é‡‡é›†ä¹Ÿå¯ä»¥åˆ†ä¸ºæ–°è¡¨é‡‡é›†ä¸å…¨é‡é‡‡é›†ï¼Œè¿™æ ·æŠŠæ–°è¡¨é‡‡é›†çš„é¢‘ç‡å˜é«˜ï¼Œå…¨é‡é‡‡é›†ä¸å˜ï¼Œå¯ä»¥ç¨å¾®ä¼˜åŒ–ä¸‹ä½“éªŒã€‚\n\nç„¶åè¿™é‡Œå†æ¥è€ƒè™‘ä¸€ä¸‹å®æ—¶é‡‡é›†çš„æ–¹æ¡ˆã€‚\n\nä¸»è¦åˆ©ç”¨çš„æ˜¯mysqlçš„binlogï¼Œå…ˆå¼€å¯MySQLçš„binlogï¼›\n\nç„¶åä½¿ç”¨MySQL binlogçš„å¢é‡è®¢é˜…&æ¶ˆè´¹ç»„ä»¶ï¼Œå¦‚aliçš„canalï¼Œå°†binlogçš„jsonæ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚kafkaï¼›\n\nç„¶åå†™ä¸€ä¸ªæ¶ˆè´¹ç«¯å»æ¶ˆè´¹ï¼Œå¦‚æœæ¶ˆè´¹åˆ°createè¯­å¥ï¼Œå°±æ ¹æ®åº“åï¼Œè¡¨ååˆ°æºæ•°æ®åº“è¿›è¡Œä¸€æ¬¡å•è¡¨çš„é‡‡é›†ã€‚è¿™æ ·å°±å¯ä»¥å®ç°å»ºè¡¨å³å®æ—¶é‡‡é›†åˆ°å…ƒæ•°æ®ç³»ç»Ÿä¸­ã€‚\n\nmysqlå¼€å¯binlogè§[è¿™é‡Œ](https://www.jianshu.com/p/5870cf1affb6)\n\ncanalè¿æ¥mysqlæ¥å—binlogå¹¶æŠŠæ•°æ®æŠ•é€’åˆ°kafkaè§[è¿™é‡Œå®˜æ–¹æ•™ç¨‹](https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart)(å®‰è£…æ•™ç¨‹ä¹Ÿåœ¨è¿™é‡Œ)\n\nä¹‹åå†™ä¸ªkafkaæ¶ˆè´¹ç«¯æ¥æ¥å—jsonçš„binlogæ•°æ®ï¼Œå¹¶å¾—åˆ°åº“è¡¨å»è¿›è¡Œé‡‡é›†åŒæ­¥ï¼Œ  \nè¿™é‡Œç”¨javaå®ç°å®ç°äº†ä¸€ä¸ªæ¶ˆè´¹kafkaçš„demoã€‚\n``` Java\npackage cn.ganjiacheng;\n\nimport org.apache.kafka.clients.consumer.ConsumerRecord;\nimport org.apache.kafka.clients.consumer.ConsumerRecords;\nimport org.apache.kafka.clients.consumer.KafkaConsumer;\n\nimport java.util.Collections;\nimport java.util.Properties;\n\n/**\n * @description:\n * @author: again\n * @email: 935669873@qq.com\n * @date: 2020/3/9 11:46 ä¸Šåˆ\n */\npublic class KafkaConsumerTest {\n\n    public static void main(String[] args) {\n        String topic = \"mysqldata\";\n        String groupID = \"lalal\";\n\n        Properties props = new Properties();\n        props.put(\"bootstrap.servers\", \"localhost:9092\");\n        props.put(\"group.id\", groupID);\n        props.put(\"enable.auto.commit\", \"true\");\n        props.put(\"auto.commit.interval.ms\", \"1000\");\n        props.put(\"auto.offset.reset\", \"earliest\");\n        props.put(\"key.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\");\n        props.put(\"value.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\");\n        KafkaConsumer<String, String> consumer = new KafkaConsumer<String, String>(props);\n\n        consumer.subscribe(Collections.singletonList(topic));\n        try {\n            while (true) {\n                ConsumerRecords<String, String> records = consumer.poll(1000);\n                for(ConsumerRecord<String, String> record: records) {\n                    System.out.println(String.format(\"offset = %s, key = %s, value = %s\", record.offset(), record.key(), record.value()));\n                }\n            }\n        } finally {\n            consumer.close();\n        }\n    }\n}\n```\n\nå¼€å¯canalçš„flatMessageä¸ºtrueï¼Œæ‹¿åˆ°çš„æ•°æ®ä¸ºjsonæ ¼å¼ï¼Œ  \nä»valueé‡Œè§£æjsonæ•°æ®å¦‚ä¸‹ï¼Œèƒ½æ‹¿åˆ°databaseå’Œtableã€‚\nä¹‹åå°±å¯ä»¥è¿›è¡Œå…ƒæ•°æ®é‡‡é›†ã€‚\n``` json\n{\n    \"data\": null,\n    \"database\": \"canal\",\n    \"es\": 1586092113000,\n    \"id\": 1,\n    \"isDdl\": true,\n    \"mysqlType\": null,\n    \"old\": null,\n    \"pkNames\": null,\n    \"sql\": \"sql sql sql\",\n    \"sqlType\": null,\n    \"table\": \"table_name\",\n    \"ts\": 1586092904217,\n    \"type\": \"CREATE\"\n}\n```","slug":"hiveä¸mysqlå…ƒæ•°æ®çš„å¿«é€Ÿé‡‡é›†","published":1,"updated":"2020-04-07T07:18:05.660Z","_id":"ck8ohfh7s000cpb0j1k6imkye","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"hiveå…ƒæ•°æ®é‡‡é›†\">Hiveå…ƒæ•°æ®é‡‡é›†</h2>\n<p>é¦–å…ˆä»¥hiveä¸¾ä¾‹ï¼Œ</p>\n<p>hiveå¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¾—åˆ°å¤§éƒ¨åˆ†è¡¨å’Œå­—æ®µçš„å…ƒæ•°æ®ï¼Œ<br>\nä½†å› ä¸ºè¿™æ ·æ¯ä¸ªéƒ½è¦æ‰§è¡Œå°±å¾ˆæ…¢ã€‚</p>\n<blockquote>\n<p>DESCRIBE FORMATTED {tablename}</p>\n</blockquote>\n<p>ç„¶åç›´æ¥å°è¯•ä»metastoreåº“é‡‡é›†ï¼Œè¿™é‡Œä¸åšmetastoreå…·ä½“ç»“æ„çš„è®ºè¿°ï¼Œ<br>\næƒ³äº†è§£è¯¦ç»†ç»“æ„å¯ä»¥ç§»æ­¥<a href=\"https://www.jianshu.com/p/420ddb3bde7f\" target=\"_blank\" rel=\"noopener\">Hive MetaStoreçš„ç»“æ„</a>ã€‚</p>\n<p>å› ä¸ºæ˜¯æŒ‰åº“é‡‡é›†ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ–¹æ³•æ˜¯å…ˆåˆ°é€šè¿‡åº“è·å–åº“ä¸‹çš„å…¨éƒ¨è¡¨åˆ—è¡¨ï¼Œ<br>\nå†é€šè¿‡åº“è·å–å…¨éƒ¨è¡¨çš„å­—æ®µï¼Œç„¶ååœ¨ä»£ç é‡Œè¿›è¡Œå¯¹åº”è¡¨å­—æ®µçš„æ•´åˆï¼Œ<br>\nå› ä¸ºè¦å¯¹æ¯ä¸ªè¡¨éƒ½è¿›è¡Œæ¯”å¯¹ä¿®æ”¹å’Œç‰ˆæœ¬è®°å½•ç­‰ï¼Œå› æ­¤å°±ä¸€ä¸ªä¸ªè¡¨è¿›è¡Œå¤„ç†å…¥åº“ã€‚<br>\nè¿™æ ·å–æ•°çš„è¿‡ç¨‹å› ä¸ºå°±ä¸¤ä¸ªmysqläº‹åŠ¡çš„æ­¥éª¤ï¼Œå®é™…å°±å¾ˆå¿«ï¼Œä½†å…¥åº“æ—¶çš„æ•ˆç‡å°±ä¼šåä½ã€‚</p>\n<p>ä¸‹é¢æ˜¯Metastoreè·å–åº“ï¼Œè¡¨ï¼Œå­—æ®µçš„å…·ä½“æ“ä½œï¼š</p>\n<ul>\n<li>å…ˆæœ‰è¦é‡‡é›†çš„åº“åï¼Œåˆ°<strong>dbs</strong>è¡¨æ ¹æ®nameæŸ¥è¯¢åˆ°å¯¹åº”çš„ä¸€æ¡æ•°æ®ï¼Œå¾—åˆ°åº“çš„ä¸€äº›ä¿¡æ¯ï¼Œè®°å½•ä¸‹<strong>db_id</strong>;</li>\n<li>æ ¹æ®å¾—åˆ°çš„<strong>db_id</strong>åœ¨tblsè¡¨æ‰¾åˆ°å¯¹åº”<strong>db_id</strong>çš„è¡¨åˆ—è¡¨ï¼Œæ¯æ¡æ•°æ®åŒ…å«äº†è¡¨åï¼Œç±»å‹ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ï¼›</li>\n<li>è¡¨çš„å…ƒæ•°æ®è¿˜ä¸å¤Ÿï¼Œæœ‰ä¸€éƒ¨åˆ†åœ¨<strong>table_params</strong>è¡¨ä¸­ï¼Œä»–çš„å­˜å‚¨æ–¹å¼æ˜¯<strong>tbl_id, keyï¼Œvalueï¼Œkey</strong>åŒ…å«äº†æ–‡ä»¶æ•°ï¼Œè¡Œæ•°ï¼Œå¤§å°ï¼Œå¤‡æ³¨ï¼Œæ›´æ–°æ—¶é—´ç­‰(æœ‰äº›ä¸ä¸€å®šé è°±)</li>\n<li>é€šè¿‡<strong>tbl_id</strong>åˆ°<strong>partition</strong>ï¼Œ<strong>partition_params</strong>ï¼Œ<strong>partition_keys</strong>å¯ä»¥æ‹¿åˆ°åˆ†åŒºè¡¨çš„åˆ†åŒºä¿¡æ¯å’Œå…¨éƒ¨åˆ†åŒºçš„å¤§å°</li>\n</ul>\n<ul>\n<li>ç„¶åæ˜¯å–ä¸€ä¸ªåº“çš„å…¨éƒ¨å­—æ®µï¼Œå½“ç„¶å­—æ®µéƒ½æ˜¯è¦å¸¦æœ‰<strong>tbl_id</strong>çš„ï¼Œè¿™æ ·æ‰èƒ½ä¸ä¸Šé¢è¡¨åˆ—è¡¨å¯¹åº”ã€‚</li>\n<li>é€šè¿‡<strong>db_id</strong>ä»<strong>tbls</strong>è·å–åˆ°å¯¹åº”çš„è¡¨åˆ—è¡¨ï¼Œé€šè¿‡åˆ—è¡¨ä¸­çš„<strong>sd_id</strong>åˆ°è¡¨sdså¾—åˆ°å¯¹åº”çš„<strong>cd_id</strong>åˆ—è¡¨</li>\n<li>é€šè¿‡<strong>cd_id</strong>åˆ—è¡¨åˆ°è¡¨<strong>columns_v2</strong>è·å–åˆ°å¯¹åº”çš„å­—æ®µä¿¡æ¯</li>\n<li>å¦å¤–åˆ†åŒºå­—æ®µéœ€è¦é¢å¤–ä»<strong>partition_keys</strong>é€šè¿‡<strong>tbl_id</strong>è·å–</li>\n</ul>\n<p>ä½¿ç”¨ä¸Šè¿°æ“ä½œï¼Œå°†è¡¨ä¿¡æ¯å’Œå­—æ®µä¿¡æ¯åˆ†åˆ«ä½¿ç”¨joinæ‹¼æ¥ä¸ºä¸€å¼ å¤§è¡¨ï¼ˆè¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›æ…¢æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåŒæ­¥æ”¾åˆ°ä»åº“é‡Œï¼‰ï¼Œè¿™æ ·å°±å·²ç»æ‹¿åˆ°äº†åŸºæœ¬æƒ³è¦çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡tbl_idå¯¹è¡¨å’Œå­—æ®µæ•°æ®è¿›è¡Œæ•´åˆï¼Œåœ¨æŠŠè¡¨ä¸€å¼ å¼ è¿›è¡Œå¤„ç†æ›´æ–°æˆ–æ–°å»ºï¼ŒåŒæ—¶æ›´æ–°ç›¸å…³è”çš„é¡¹ï¼›</p>\n<h2 id=\"mysqlå…ƒæ•°æ®é‡‡é›†\">Mysqlå…ƒæ•°æ®é‡‡é›†</h2>\n<p>MysqlæŒ‰ç†æ¥è¯´æ˜¯å’Œä¸Šé¢metastoreåŸºæœ¬ä¸€æ ·çš„ï¼Œä½†è¿™è¾¹æƒ³æ›´å¿«ä¸€ç‚¹ï¼Œä¸”å¯ä»¥å¿½ç•¥è°ƒè¡¨ã€å­—æ®µå’Œå…¶ä»–æœ‰å¤–é”®å…³è”çš„é¡¹ï¼›</p>\n<p>information_schemaçš„ç»“æ„å¤§è‡´è§<a href=\"https://www.jianshu.com/p/c08fe8e01c0a\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>è¿™é‡Œä»¥tablesè¡¨ä¸ºä¾‹ï¼Œå­˜äº†å¤§éƒ¨åˆ†è¡¨å…ƒæ•°æ®ï¼Œå–æ•°æ®æ¯”å¦‚åº“è®°å½•id</p>\n<blockquote>\n<p>database_id = 2<br>\ndatabase_name = db_test</p>\n</blockquote>\n<p>å–è¡¨æ•°æ®æ•°æ®</p>\n<blockquote>\n<p>select <code>TABLE_SCHEMA</code>, <code>TABLE_NAME</code>, <code>TABLE_TYPE</code><br>\nform <code>TABLES</code> where <code>TABLE_SCHEMA</code> = â€˜db_testâ€™</p>\n</blockquote>\n<p>åœ¨å¾€åç«¯åŒæ­¥æ•°æ®æ—¶ï¼Œå…ˆå»ºä¸€ä¸ªdb_id ä¸ table_name çš„å”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨on duplicate key updateå®ç°å¯¹æ’å…¥æ•°æ®è¿˜æ˜¯æ›´æ–°æ•°æ®çš„æ£€æŸ¥ã€‚ä¾‹å¦‚ä¸‹</p>\n<blockquote>\n<p>insert into back_table<br>\n(db_id, table_name, table_type)<br>\nvalues<br>\n(â€˜testâ€™, â€˜db_testâ€™, â€˜testâ€™, â€˜testâ€™)<br>\non duplicate key update<br>\ntable_name=values(table_name),<br>\ntable_type=values(table_type);</p>\n</blockquote>\n<p>ç„¶åç›´æ¥å®Œæˆå¯¹åç«¯å…ƒæ•°æ®çš„åŒæ­¥ã€‚å­—æ®µåŒç†ã€‚</p>\n<p>è¿™ç§æ–¹å¼é‡‡é›†ä¸€èˆ¬çš„åº“å‡ ç™¾å¼ è¡¨å’Œå­—æ®µçš„å°±éå¸¸å¿«äº†ï¼ŒåŸºæœ¬éƒ½3ç§’ä»¥å†…ã€‚ä½†ä¹Ÿè¦è€ƒè™‘åœ¨è¡¨å’Œå­—æ®µæ¯”è¾ƒå¤šçš„æ—¶å€™è¦è¿›è¡Œåˆ†æ‰¹å¤„ç†ï¼Œå¦åˆ™å¯èƒ½ä¸€ä¸ªsqlè¿‡å¤§æˆ–æ’å…¥è¿‡æ…¢ã€‚</p>\n<h2 id=\"å…³äºå®æ—¶é‡‡é›†\">å…³äºå®æ—¶é‡‡é›†</h2>\n<p>ä¸Šé¢è®²åˆ°çš„æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹å…¨éƒ¨å…ƒæ•°æ®è¿›è¡Œå®šæ—¶é‡‡é›†ï¼Œå®šæ—¶çš„å…¨é‡é‡‡é›†æœ‰ä¸ªç¼ºç‚¹å°±å¾ˆæ…¢ï¼Œå»ºäº†è¡¨å¥½ä¹…æ‰èƒ½åŒæ­¥åˆ°ã€‚</p>\n<p>ä¸€èˆ¬ä¼˜åŒ–çš„æ–¹å¼æ˜¯å®šæ—¶é‡‡é›†ä¹Ÿå¯ä»¥åˆ†ä¸ºæ–°è¡¨é‡‡é›†ä¸å…¨é‡é‡‡é›†ï¼Œè¿™æ ·æŠŠæ–°è¡¨é‡‡é›†çš„é¢‘ç‡å˜é«˜ï¼Œå…¨é‡é‡‡é›†ä¸å˜ï¼Œå¯ä»¥ç¨å¾®ä¼˜åŒ–ä¸‹ä½“éªŒã€‚</p>\n<p>ç„¶åè¿™é‡Œå†æ¥è€ƒè™‘ä¸€ä¸‹å®æ—¶é‡‡é›†çš„æ–¹æ¡ˆã€‚</p>\n<p>ä¸»è¦åˆ©ç”¨çš„æ˜¯mysqlçš„binlogï¼Œå…ˆå¼€å¯MySQLçš„binlogï¼›</p>\n<p>ç„¶åä½¿ç”¨MySQL binlogçš„å¢é‡è®¢é˜…&amp;æ¶ˆè´¹ç»„ä»¶ï¼Œå¦‚aliçš„canalï¼Œå°†binlogçš„jsonæ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚kafkaï¼›</p>\n<p>ç„¶åå†™ä¸€ä¸ªæ¶ˆè´¹ç«¯å»æ¶ˆè´¹ï¼Œå¦‚æœæ¶ˆè´¹åˆ°createè¯­å¥ï¼Œå°±æ ¹æ®åº“åï¼Œè¡¨ååˆ°æºæ•°æ®åº“è¿›è¡Œä¸€æ¬¡å•è¡¨çš„é‡‡é›†ã€‚è¿™æ ·å°±å¯ä»¥å®ç°å»ºè¡¨å³å®æ—¶é‡‡é›†åˆ°å…ƒæ•°æ®ç³»ç»Ÿä¸­ã€‚</p>\n<p>mysqlå¼€å¯binlogè§<a href=\"https://www.jianshu.com/p/5870cf1affb6\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>canalè¿æ¥mysqlæ¥å—binlogå¹¶æŠŠæ•°æ®æŠ•é€’åˆ°kafkaè§<a href=\"https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œå®˜æ–¹æ•™ç¨‹</a>(å®‰è£…æ•™ç¨‹ä¹Ÿåœ¨è¿™é‡Œ)</p>\n<p>ä¹‹åå†™ä¸ªkafkaæ¶ˆè´¹ç«¯æ¥æ¥å—jsonçš„binlogæ•°æ®ï¼Œå¹¶å¾—åˆ°åº“è¡¨å»è¿›è¡Œé‡‡é›†åŒæ­¥ï¼Œ<br>\nè¿™é‡Œç”¨javaå®ç°å®ç°äº†ä¸€ä¸ªæ¶ˆè´¹kafkaçš„demoã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> cn.ganjiacheng;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.ConsumerRecord;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.ConsumerRecords;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.KafkaConsumer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collections;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>:</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span>: again</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@email</span>: 935669873@qq.com</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span>: 2020/3/9 11:46 ä¸Šåˆ</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">KafkaConsumerTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        String topic = <span class=\"string\">\"mysqldata\"</span>;</span><br><span class=\"line\">        String groupID = <span class=\"string\">\"lalal\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        Properties props = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">        props.put(<span class=\"string\">\"bootstrap.servers\"</span>, <span class=\"string\">\"localhost:9092\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"group.id\"</span>, groupID);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"enable.auto.commit\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"auto.commit.interval.ms\"</span>, <span class=\"string\">\"1000\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"auto.offset.reset\"</span>, <span class=\"string\">\"earliest\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"key.deserializer\"</span>, <span class=\"string\">\"org.apache.kafka.common.serialization.StringDeserializer\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"value.deserializer\"</span>, <span class=\"string\">\"org.apache.kafka.common.serialization.StringDeserializer\"</span>);</span><br><span class=\"line\">        KafkaConsumer&lt;String, String&gt; consumer = <span class=\"keyword\">new</span> KafkaConsumer&lt;String, String&gt;(props);</span><br><span class=\"line\"></span><br><span class=\"line\">        consumer.subscribe(Collections.singletonList(topic));</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                ConsumerRecords&lt;String, String&gt; records = consumer.poll(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(ConsumerRecord&lt;String, String&gt; record: records) &#123;</span><br><span class=\"line\">                    System.out.println(String.format(<span class=\"string\">\"offset = %s, key = %s, value = %s\"</span>, record.offset(), record.key(), record.value()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            consumer.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¼€å¯canalçš„flatMessageä¸ºtrueï¼Œæ‹¿åˆ°çš„æ•°æ®ä¸ºjsonæ ¼å¼ï¼Œ<br>\nä»valueé‡Œè§£æjsonæ•°æ®å¦‚ä¸‹ï¼Œèƒ½æ‹¿åˆ°databaseå’Œtableã€‚<br>\nä¹‹åå°±å¯ä»¥è¿›è¡Œå…ƒæ•°æ®é‡‡é›†ã€‚</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"database\"</span>: <span class=\"string\">\"canal\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"es\"</span>: <span class=\"number\">1586092113000</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"id\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"isDdl\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"mysqlType\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"old\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"pkNames\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sql\"</span>: <span class=\"string\">\"sql sql sql\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sqlType\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"table\"</span>: <span class=\"string\">\"table_name\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ts\"</span>: <span class=\"number\">1586092904217</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"CREATE\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h2>Hiveå…ƒæ•°æ®é‡‡é›†</h2>\n<p>é¦–å…ˆä»¥hiveä¸¾ä¾‹ï¼Œ</p>\n<p>hiveå¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¾—åˆ°å¤§éƒ¨åˆ†è¡¨å’Œå­—æ®µçš„å…ƒæ•°æ®ï¼Œ<br>\nä½†å› ä¸ºè¿™æ ·æ¯ä¸ªéƒ½è¦æ‰§è¡Œå°±å¾ˆæ…¢ã€‚</p>\n<blockquote>\n<p>DESCRIBE FORMATTED {tablename}</p>\n</blockquote>\n<p>ç„¶åç›´æ¥å°è¯•ä»metastoreåº“é‡‡é›†ï¼Œè¿™é‡Œä¸åšmetastoreå…·ä½“ç»“æ„çš„è®ºè¿°ï¼Œ<br>\næƒ³äº†è§£è¯¦ç»†ç»“æ„å¯ä»¥ç§»æ­¥<a href=\"https://www.jianshu.com/p/420ddb3bde7f\" target=\"_blank\" rel=\"noopener\">Hive MetaStoreçš„ç»“æ„</a>ã€‚</p>\n<p>å› ä¸ºæ˜¯æŒ‰åº“é‡‡é›†ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ–¹æ³•æ˜¯å…ˆåˆ°é€šè¿‡åº“è·å–åº“ä¸‹çš„å…¨éƒ¨è¡¨åˆ—è¡¨ï¼Œ<br>\nå†é€šè¿‡åº“è·å–å…¨éƒ¨è¡¨çš„å­—æ®µï¼Œç„¶ååœ¨ä»£ç é‡Œè¿›è¡Œå¯¹åº”è¡¨å­—æ®µçš„æ•´åˆï¼Œ<br>\nå› ä¸ºè¦å¯¹æ¯ä¸ªè¡¨éƒ½è¿›è¡Œæ¯”å¯¹ä¿®æ”¹å’Œç‰ˆæœ¬è®°å½•ç­‰ï¼Œå› æ­¤å°±ä¸€ä¸ªä¸ªè¡¨è¿›è¡Œå¤„ç†å…¥åº“ã€‚<br>\nè¿™æ ·å–æ•°çš„è¿‡ç¨‹å› ä¸ºå°±ä¸¤ä¸ªmysqläº‹åŠ¡çš„æ­¥éª¤ï¼Œå®é™…å°±å¾ˆå¿«ï¼Œä½†å…¥åº“æ—¶çš„æ•ˆç‡å°±ä¼šåä½ã€‚</p>\n<p>ä¸‹é¢æ˜¯Metastoreè·å–åº“ï¼Œè¡¨ï¼Œå­—æ®µçš„å…·ä½“æ“ä½œï¼š</p>\n<ul>\n<li>å…ˆæœ‰è¦é‡‡é›†çš„åº“åï¼Œåˆ°<strong>dbs</strong>è¡¨æ ¹æ®nameæŸ¥è¯¢åˆ°å¯¹åº”çš„ä¸€æ¡æ•°æ®ï¼Œå¾—åˆ°åº“çš„ä¸€äº›ä¿¡æ¯ï¼Œè®°å½•ä¸‹<strong>db_id</strong>;</li>\n<li>æ ¹æ®å¾—åˆ°çš„<strong>db_id</strong>åœ¨tblsè¡¨æ‰¾åˆ°å¯¹åº”<strong>db_id</strong>çš„è¡¨åˆ—è¡¨ï¼Œæ¯æ¡æ•°æ®åŒ…å«äº†è¡¨åï¼Œç±»å‹ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ï¼›</li>\n<li>è¡¨çš„å…ƒæ•°æ®è¿˜ä¸å¤Ÿï¼Œæœ‰ä¸€éƒ¨åˆ†åœ¨<strong>table_params</strong>è¡¨ä¸­ï¼Œä»–çš„å­˜å‚¨æ–¹å¼æ˜¯<strong>tbl_id, keyï¼Œvalueï¼Œkey</strong>åŒ…å«äº†æ–‡ä»¶æ•°ï¼Œè¡Œæ•°ï¼Œå¤§å°ï¼Œå¤‡æ³¨ï¼Œæ›´æ–°æ—¶é—´ç­‰(æœ‰äº›ä¸ä¸€å®šé è°±)</li>\n<li>é€šè¿‡<strong>tbl_id</strong>åˆ°<strong>partition</strong>ï¼Œ<strong>partition_params</strong>ï¼Œ<strong>partition_keys</strong>å¯ä»¥æ‹¿åˆ°åˆ†åŒºè¡¨çš„åˆ†åŒºä¿¡æ¯å’Œå…¨éƒ¨åˆ†åŒºçš„å¤§å°</li>\n</ul>\n<ul>\n<li>ç„¶åæ˜¯å–ä¸€ä¸ªåº“çš„å…¨éƒ¨å­—æ®µï¼Œå½“ç„¶å­—æ®µéƒ½æ˜¯è¦å¸¦æœ‰<strong>tbl_id</strong>çš„ï¼Œè¿™æ ·æ‰èƒ½ä¸ä¸Šé¢è¡¨åˆ—è¡¨å¯¹åº”ã€‚</li>\n<li>é€šè¿‡<strong>db_id</strong>ä»<strong>tbls</strong>è·å–åˆ°å¯¹åº”çš„è¡¨åˆ—è¡¨ï¼Œé€šè¿‡åˆ—è¡¨ä¸­çš„<strong>sd_id</strong>åˆ°è¡¨sdså¾—åˆ°å¯¹åº”çš„<strong>cd_id</strong>åˆ—è¡¨</li>\n<li>é€šè¿‡<strong>cd_id</strong>åˆ—è¡¨åˆ°è¡¨<strong>columns_v2</strong>è·å–åˆ°å¯¹åº”çš„å­—æ®µä¿¡æ¯</li>\n<li>å¦å¤–åˆ†åŒºå­—æ®µéœ€è¦é¢å¤–ä»<strong>partition_keys</strong>é€šè¿‡<strong>tbl_id</strong>è·å–</li>\n</ul>\n<p>ä½¿ç”¨ä¸Šè¿°æ“ä½œï¼Œå°†è¡¨ä¿¡æ¯å’Œå­—æ®µä¿¡æ¯åˆ†åˆ«ä½¿ç”¨joinæ‹¼æ¥ä¸ºä¸€å¼ å¤§è¡¨ï¼ˆè¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›æ…¢æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠè¿™ä¸ªåŒæ­¥æ”¾åˆ°ä»åº“é‡Œï¼‰ï¼Œè¿™æ ·å°±å·²ç»æ‹¿åˆ°äº†åŸºæœ¬æƒ³è¦çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡tbl_idå¯¹è¡¨å’Œå­—æ®µæ•°æ®è¿›è¡Œæ•´åˆï¼Œåœ¨æŠŠè¡¨ä¸€å¼ å¼ è¿›è¡Œå¤„ç†æ›´æ–°æˆ–æ–°å»ºï¼ŒåŒæ—¶æ›´æ–°ç›¸å…³è”çš„é¡¹ï¼›</p>\n<h2>Mysqlå…ƒæ•°æ®é‡‡é›†</h2>\n<p>MysqlæŒ‰ç†æ¥è¯´æ˜¯å’Œä¸Šé¢metastoreåŸºæœ¬ä¸€æ ·çš„ï¼Œä½†è¿™è¾¹æƒ³æ›´å¿«ä¸€ç‚¹ï¼Œä¸”å¯ä»¥å¿½ç•¥è°ƒè¡¨ã€å­—æ®µå’Œå…¶ä»–æœ‰å¤–é”®å…³è”çš„é¡¹ï¼›</p>\n<p>information_schemaçš„ç»“æ„å¤§è‡´è§<a href=\"https://www.jianshu.com/p/c08fe8e01c0a\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>è¿™é‡Œä»¥tablesè¡¨ä¸ºä¾‹ï¼Œå­˜äº†å¤§éƒ¨åˆ†è¡¨å…ƒæ•°æ®ï¼Œå–æ•°æ®æ¯”å¦‚åº“è®°å½•id</p>\n<blockquote>\n<p>database_id = 2<br>\ndatabase_name = db_test</p>\n</blockquote>\n<p>å–è¡¨æ•°æ®æ•°æ®</p>\n<blockquote>\n<p>select <code>TABLE_SCHEMA</code>, <code>TABLE_NAME</code>, <code>TABLE_TYPE</code><br>\nform <code>TABLES</code> where <code>TABLE_SCHEMA</code> = â€˜db_testâ€™</p>\n</blockquote>\n<p>åœ¨å¾€åç«¯åŒæ­¥æ•°æ®æ—¶ï¼Œå…ˆå»ºä¸€ä¸ªdb_id ä¸ table_name çš„å”¯ä¸€ç´¢å¼•ï¼Œç„¶åä½¿ç”¨on duplicate key updateå®ç°å¯¹æ’å…¥æ•°æ®è¿˜æ˜¯æ›´æ–°æ•°æ®çš„æ£€æŸ¥ã€‚ä¾‹å¦‚ä¸‹</p>\n<blockquote>\n<p>insert into back_table<br>\n(db_id, table_name, table_type)<br>\nvalues<br>\n(â€˜testâ€™, â€˜db_testâ€™, â€˜testâ€™, â€˜testâ€™)<br>\non duplicate key update<br>\ntable_name=values(table_name),<br>\ntable_type=values(table_type);</p>\n</blockquote>\n<p>ç„¶åç›´æ¥å®Œæˆå¯¹åç«¯å…ƒæ•°æ®çš„åŒæ­¥ã€‚å­—æ®µåŒç†ã€‚</p>\n<p>è¿™ç§æ–¹å¼é‡‡é›†ä¸€èˆ¬çš„åº“å‡ ç™¾å¼ è¡¨å’Œå­—æ®µçš„å°±éå¸¸å¿«äº†ï¼ŒåŸºæœ¬éƒ½3ç§’ä»¥å†…ã€‚ä½†ä¹Ÿè¦è€ƒè™‘åœ¨è¡¨å’Œå­—æ®µæ¯”è¾ƒå¤šçš„æ—¶å€™è¦è¿›è¡Œåˆ†æ‰¹å¤„ç†ï¼Œå¦åˆ™å¯èƒ½ä¸€ä¸ªsqlè¿‡å¤§æˆ–æ’å…¥è¿‡æ…¢ã€‚</p>\n<h2>å…³äºå®æ—¶é‡‡é›†</h2>\n<p>ä¸Šé¢è®²åˆ°çš„æ–¹å¼åŸºæœ¬éƒ½æ˜¯å¯¹å…¨éƒ¨å…ƒæ•°æ®è¿›è¡Œå®šæ—¶é‡‡é›†ï¼Œå®šæ—¶çš„å…¨é‡é‡‡é›†æœ‰ä¸ªç¼ºç‚¹å°±å¾ˆæ…¢ï¼Œå»ºäº†è¡¨å¥½ä¹…æ‰èƒ½åŒæ­¥åˆ°ã€‚</p>\n<p>ä¸€èˆ¬ä¼˜åŒ–çš„æ–¹å¼æ˜¯å®šæ—¶é‡‡é›†ä¹Ÿå¯ä»¥åˆ†ä¸ºæ–°è¡¨é‡‡é›†ä¸å…¨é‡é‡‡é›†ï¼Œè¿™æ ·æŠŠæ–°è¡¨é‡‡é›†çš„é¢‘ç‡å˜é«˜ï¼Œå…¨é‡é‡‡é›†ä¸å˜ï¼Œå¯ä»¥ç¨å¾®ä¼˜åŒ–ä¸‹ä½“éªŒã€‚</p>\n<p>ç„¶åè¿™é‡Œå†æ¥è€ƒè™‘ä¸€ä¸‹å®æ—¶é‡‡é›†çš„æ–¹æ¡ˆã€‚</p>\n<p>ä¸»è¦åˆ©ç”¨çš„æ˜¯mysqlçš„binlogï¼Œå…ˆå¼€å¯MySQLçš„binlogï¼›</p>\n<p>ç„¶åä½¿ç”¨MySQL binlogçš„å¢é‡è®¢é˜…&amp;æ¶ˆè´¹ç»„ä»¶ï¼Œå¦‚aliçš„canalï¼Œå°†binlogçš„jsonæ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚kafkaï¼›</p>\n<p>ç„¶åå†™ä¸€ä¸ªæ¶ˆè´¹ç«¯å»æ¶ˆè´¹ï¼Œå¦‚æœæ¶ˆè´¹åˆ°createè¯­å¥ï¼Œå°±æ ¹æ®åº“åï¼Œè¡¨ååˆ°æºæ•°æ®åº“è¿›è¡Œä¸€æ¬¡å•è¡¨çš„é‡‡é›†ã€‚è¿™æ ·å°±å¯ä»¥å®ç°å»ºè¡¨å³å®æ—¶é‡‡é›†åˆ°å…ƒæ•°æ®ç³»ç»Ÿä¸­ã€‚</p>\n<p>mysqlå¼€å¯binlogè§<a href=\"https://www.jianshu.com/p/5870cf1affb6\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a></p>\n<p>canalè¿æ¥mysqlæ¥å—binlogå¹¶æŠŠæ•°æ®æŠ•é€’åˆ°kafkaè§<a href=\"https://github.com/alibaba/canal/wiki/Canal-Kafka-RocketMQ-QuickStart\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œå®˜æ–¹æ•™ç¨‹</a>(å®‰è£…æ•™ç¨‹ä¹Ÿåœ¨è¿™é‡Œ)</p>\n<p>ä¹‹åå†™ä¸ªkafkaæ¶ˆè´¹ç«¯æ¥æ¥å—jsonçš„binlogæ•°æ®ï¼Œå¹¶å¾—åˆ°åº“è¡¨å»è¿›è¡Œé‡‡é›†åŒæ­¥ï¼Œ<br>\nè¿™é‡Œç”¨javaå®ç°å®ç°äº†ä¸€ä¸ªæ¶ˆè´¹kafkaçš„demoã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> cn.ganjiacheng;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.ConsumerRecord;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.ConsumerRecords;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.kafka.clients.consumer.KafkaConsumer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collections;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>:</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span>: again</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@email</span>: 935669873@qq.com</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span>: 2020/3/9 11:46 ä¸Šåˆ</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">KafkaConsumerTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        String topic = <span class=\"string\">\"mysqldata\"</span>;</span><br><span class=\"line\">        String groupID = <span class=\"string\">\"lalal\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        Properties props = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">        props.put(<span class=\"string\">\"bootstrap.servers\"</span>, <span class=\"string\">\"localhost:9092\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"group.id\"</span>, groupID);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"enable.auto.commit\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"auto.commit.interval.ms\"</span>, <span class=\"string\">\"1000\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"auto.offset.reset\"</span>, <span class=\"string\">\"earliest\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"key.deserializer\"</span>, <span class=\"string\">\"org.apache.kafka.common.serialization.StringDeserializer\"</span>);</span><br><span class=\"line\">        props.put(<span class=\"string\">\"value.deserializer\"</span>, <span class=\"string\">\"org.apache.kafka.common.serialization.StringDeserializer\"</span>);</span><br><span class=\"line\">        KafkaConsumer&lt;String, String&gt; consumer = <span class=\"keyword\">new</span> KafkaConsumer&lt;String, String&gt;(props);</span><br><span class=\"line\"></span><br><span class=\"line\">        consumer.subscribe(Collections.singletonList(topic));</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                ConsumerRecords&lt;String, String&gt; records = consumer.poll(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                <span class=\"keyword\">for</span>(ConsumerRecord&lt;String, String&gt; record: records) &#123;</span><br><span class=\"line\">                    System.out.println(String.format(<span class=\"string\">\"offset = %s, key = %s, value = %s\"</span>, record.offset(), record.key(), record.value()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            consumer.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¼€å¯canalçš„flatMessageä¸ºtrueï¼Œæ‹¿åˆ°çš„æ•°æ®ä¸ºjsonæ ¼å¼ï¼Œ<br>\nä»valueé‡Œè§£æjsonæ•°æ®å¦‚ä¸‹ï¼Œèƒ½æ‹¿åˆ°databaseå’Œtableã€‚<br>\nä¹‹åå°±å¯ä»¥è¿›è¡Œå…ƒæ•°æ®é‡‡é›†ã€‚</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"data\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"database\"</span>: <span class=\"string\">\"canal\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"es\"</span>: <span class=\"number\">1586092113000</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"id\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"isDdl\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"mysqlType\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"old\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"pkNames\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sql\"</span>: <span class=\"string\">\"sql sql sql\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sqlType\"</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"table\"</span>: <span class=\"string\">\"table_name\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ts\"</span>: <span class=\"number\">1586092904217</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"CREATE\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"æ•´ç†æ™’æ™’è€åšå®¢","catalog":true,"date":"2020-02-29T08:15:00.000Z","subtitle":"æ•´ç†ä¸‹ä¹‹å‰è®°å½•çš„ä¸€äº›ä¸œè¥¿","header-img":"/img/article_header/header.jpg","_content":"\n## å‰è¨€\n\nä¹‹å‰å†™è¿‡äº›åšå®¢ï¼Œæ–‡ç« æ²¡ç›´æ¥ä¿ç•™ï¼Œä»£ç éƒ½è¿˜ç•™ç€ï¼›  \nè¿™è¾¹å¯¹ä¹‹å‰çš„åšç®€å•è®ºè¿°å’Œæ€»ç»“ã€‚\ngitåœ°å€ï¼š[https://github.com/webgjc/blog](https://github.com/webgjc/blog)\n\n## content\n\n### [ä¿®æ”¹æ¡Œé¢èƒŒæ™¯å›¾ç‰‡](https://github.com/webgjc/blog/tree/master/change_background_exe)\n- ä½¿ç”¨pythonå®ç°ï¼Œä»ç½‘ä¸Šè·å–[å›¾ç‰‡](https://bing.ioliu.cn/)ï¼Œä¿®æ”¹windowæ¡Œé¢èƒŒæ™¯å›¾ç‰‡ã€‚å¯ä»¥ç”¨pyinstalleræ‰“åŒ…ä¸ºexe\n\n### [dfsçš„å‡ ä¸ªdemo](https://github.com/webgjc/blog/tree/master/dfs_demo)\n- dfs.pyåŒ…å«äº†å…¨æ’ï¼Œå…«çš‡åé—®é¢˜  \nriver.pyä¸ºå’Œå°šå¦–æ€ªè¿‡æ²³é—®é¢˜  \nshudu.pyä¸ºè§£æ•°ç‹¬é—®é¢˜\n\n### [dlibäººè„¸è¯†åˆ«+svmåˆ†ç±»](https://github.com/webgjc/blog/tree/master/dlib_face)\n- ä½¿ç”¨pythonçš„dlibåŒ…è¿›è¡Œäººè„¸68ä¸ªå…³é”®ç‚¹è¯†åˆ«ï¼Œå¹¶ä½¿ç”¨svmè¿›è¡Œäº†äºŒåˆ†ç±»ã€‚\n\n### [flask mongodb gunicorn demo](https://github.com/webgjc/blog/tree/master/flask_mongodb_gunicorn)\n- flask mongodbå°è¯•\n\n### [å‰ç«¯è®¸æ„¿å¢™æ•ˆæœ](https://github.com/webgjc/blog/tree/master/front_end_vow_wall_effect)\n- å‰ç«¯æ•ˆæœ\n\n### [åœ¨çº¿åŒäººäº”å­æ£‹](https://github.com/webgjc/blog/tree/master/gobang_online)\n- ä½¿ç”¨äº†nodeçš„socket.ioçš„websocketå®ç°äº†ç½‘é¡µä¸Šçš„åŒäººäº”å­æ£‹æ¸¸æˆ\n\n### [æ¢¯åº¦ä¸‹é™æ³•](https://github.com/webgjc/blog/tree/master/gradient_descent_method)\n- å†™äº†ä¸‹æ¢¯åº¦ä¸‹é™çš„æ•ˆæœdemo\n\n### [æ‰‹æŒå¼¹å¹•æ•ˆæœ](https://github.com/webgjc/blog/tree/master/handheld_barrage)\n- å‰ç«¯æ•ˆæœ\n\n### [èªæ˜é’±--è‚¡ç¥¨ç­–ç•¥](https://github.com/webgjc/blog/tree/master/joinquant_smart_money)\n- åœ¨èšå®½å›æµ‹å¹³å°è¿è¡Œ\n\n### [æ‰«é›·jsç‰ˆ](https://github.com/webgjc/blog/tree/master/js_mine_clearance)\n- jsç‰ˆæ‰«é›·\n\n### [æ‰‹åŠ¨å®ç°kmeansèšç±»ç®—æ³•](https://github.com/webgjc/blog/tree/master/kmeans_hand)\n- pythonæ‰‹åŠ¨å®ç°äº†ä¸‹kmeans\n\n### [KNNåˆ†ç±»ç®—æ³•ï¼ˆmnistä¸ºä¾‹ï¼‰](https://github.com/webgjc/blog/tree/master/knn_mnist)\n- knn demo\n\n### [loadingåŠ¨ç”»](https://github.com/webgjc/blog/tree/master/loading_demo)\n- loadingåŠ¨ç”»\n\n### [é€»è¾‘å›å½’äºŒåˆ†ç±»](https://github.com/webgjc/blog/tree/master/logistic_classification)\n- æ‰‹åŠ¨å®ç°é€»è¾‘å›å½’äºŒåˆ†ç±»\n\n### [æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»å½•ï¼ˆpythonç‰ˆ+PHPç‰ˆï¼‰](https://github.com/webgjc/blog/tree/master/logon_digital_hangzhou_dianzi_university)\n- æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»é™†(ç›®å‰ä¸ä¸€å®šå¯é )\n\n### [matplotlib ç”»å›¾](https://github.com/webgjc/blog/tree/master/matplotlib_draw)\n- matplotlibç”»å›¾demo\n\n### [mctsåšäº”å­æ£‹ai](https://github.com/webgjc/blog/tree/master/mcts_gobang)\n- pythonå®ç°äº†ä¸‹äº”å­æ£‹ï¼Œå¹¶ç”¨mactsç®—æ³•è¿›è¡Œäº†aiæ¨¡æ‹Ÿ\n\n### [node express mongodb demo](https://github.com/webgjc/blog/tree/master/node_express_mongodb)\n- node express demo\n\n### [éçº¿æ€§æ‹Ÿåˆå’Œéçº¿æ€§é€»è¾‘å›å½’](https://github.com/webgjc/blog/tree/master/nonlinear_fitting_logistic)\n- pythonæ‰‹åŠ¨å®ç°æ‹Ÿåˆå’Œå›å½’\n\n### [swoole ä½ ç”»æˆ‘çŒœ](https://github.com/webgjc/blog/tree/master/php_swoole_draw_and_guess)\n- phpçš„swooleçš„socketå®ç°ä½ ç”»æˆ‘çŒœ\n\n### [å”è¯—è¯äº‘](https://github.com/webgjc/blog/tree/master/poet_word_cloud)\n- pythonçš„wordcloudå®ç°å”è¯—çš„è¯äº‘\n\n### [ppythonçš„ä½¿ç”¨](https://github.com/webgjc/blog/tree/master/ppython)\n- ppythonä¸»è¦æ˜¯phpè°ƒç”¨pythonç¨‹åº\n\n### [php rsaåŠ å¯†](https://github.com/webgjc/blog/tree/master/rsa_php)\n- php rsaåŠ å¯†\n\n### [ç®€å•çº¿æ€§å›å½’](https://github.com/webgjc/blog/tree/master/simple_linear_regression)\n- çº¿æ€§å›å½’demo\n\n### [PHPå®ç°SOAPè°ƒç”¨](https://github.com/webgjc/blog/tree/master/soap_php)\n- php soap\n\n### [svmåˆ†ç±»](https://github.com/webgjc/blog/tree/master/svm_classification)\n- svmåˆ†ç±»\n\n### [tensorflowå†™mniståˆ†ç±»](https://github.com/webgjc/blog/tree/master/tensorflow_mnist)\n- tensorflowå†™mniståˆ†ç±»\n\n### [threejs demo](https://github.com/webgjc/blog/tree/master/three_js_demo)\n- three js demo\n\n### [ttsäººæœºèŠå¤©åº”ç”¨](https://github.com/webgjc/blog/tree/master/tts_chat_demo)\n- ttsäººæœºèŠå¤©åº”ç”¨\n\n### [ç®€å•éªŒè¯ç çš„è¯†åˆ«](https://github.com/webgjc/blog/tree/master/verification_code_recognition)\n- ç®€å•éªŒè¯ç çš„è¯†åˆ«\n\n### [web worker demo](https://github.com/webgjc/blog/tree/master/web_worker)\n- web worker demo\n\n### [å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹](https://github.com/webgjc/blog/tree/master/wechat_small_program_sale_demo)\n- å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹\n\n### [å¾®ä¿¡å°ç¨‹åº--æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç ](https://github.com/webgjc/blog/tree/master/wechat_small_program_text_verification_code)\n- å¾®ä¿¡å°ç¨‹åº--æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç ","source":"_posts/æ•´ç†æ™’æ™’è€åšå®¢.md","raw":"---\ntitle: æ•´ç†æ™’æ™’è€åšå®¢\ncatalog: true\ndate: 2020-02-29 16:15:00\nsubtitle: \"æ•´ç†ä¸‹ä¹‹å‰è®°å½•çš„ä¸€äº›ä¸œè¥¿\"\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- Other\n---\n\n## å‰è¨€\n\nä¹‹å‰å†™è¿‡äº›åšå®¢ï¼Œæ–‡ç« æ²¡ç›´æ¥ä¿ç•™ï¼Œä»£ç éƒ½è¿˜ç•™ç€ï¼›  \nè¿™è¾¹å¯¹ä¹‹å‰çš„åšç®€å•è®ºè¿°å’Œæ€»ç»“ã€‚\ngitåœ°å€ï¼š[https://github.com/webgjc/blog](https://github.com/webgjc/blog)\n\n## content\n\n### [ä¿®æ”¹æ¡Œé¢èƒŒæ™¯å›¾ç‰‡](https://github.com/webgjc/blog/tree/master/change_background_exe)\n- ä½¿ç”¨pythonå®ç°ï¼Œä»ç½‘ä¸Šè·å–[å›¾ç‰‡](https://bing.ioliu.cn/)ï¼Œä¿®æ”¹windowæ¡Œé¢èƒŒæ™¯å›¾ç‰‡ã€‚å¯ä»¥ç”¨pyinstalleræ‰“åŒ…ä¸ºexe\n\n### [dfsçš„å‡ ä¸ªdemo](https://github.com/webgjc/blog/tree/master/dfs_demo)\n- dfs.pyåŒ…å«äº†å…¨æ’ï¼Œå…«çš‡åé—®é¢˜  \nriver.pyä¸ºå’Œå°šå¦–æ€ªè¿‡æ²³é—®é¢˜  \nshudu.pyä¸ºè§£æ•°ç‹¬é—®é¢˜\n\n### [dlibäººè„¸è¯†åˆ«+svmåˆ†ç±»](https://github.com/webgjc/blog/tree/master/dlib_face)\n- ä½¿ç”¨pythonçš„dlibåŒ…è¿›è¡Œäººè„¸68ä¸ªå…³é”®ç‚¹è¯†åˆ«ï¼Œå¹¶ä½¿ç”¨svmè¿›è¡Œäº†äºŒåˆ†ç±»ã€‚\n\n### [flask mongodb gunicorn demo](https://github.com/webgjc/blog/tree/master/flask_mongodb_gunicorn)\n- flask mongodbå°è¯•\n\n### [å‰ç«¯è®¸æ„¿å¢™æ•ˆæœ](https://github.com/webgjc/blog/tree/master/front_end_vow_wall_effect)\n- å‰ç«¯æ•ˆæœ\n\n### [åœ¨çº¿åŒäººäº”å­æ£‹](https://github.com/webgjc/blog/tree/master/gobang_online)\n- ä½¿ç”¨äº†nodeçš„socket.ioçš„websocketå®ç°äº†ç½‘é¡µä¸Šçš„åŒäººäº”å­æ£‹æ¸¸æˆ\n\n### [æ¢¯åº¦ä¸‹é™æ³•](https://github.com/webgjc/blog/tree/master/gradient_descent_method)\n- å†™äº†ä¸‹æ¢¯åº¦ä¸‹é™çš„æ•ˆæœdemo\n\n### [æ‰‹æŒå¼¹å¹•æ•ˆæœ](https://github.com/webgjc/blog/tree/master/handheld_barrage)\n- å‰ç«¯æ•ˆæœ\n\n### [èªæ˜é’±--è‚¡ç¥¨ç­–ç•¥](https://github.com/webgjc/blog/tree/master/joinquant_smart_money)\n- åœ¨èšå®½å›æµ‹å¹³å°è¿è¡Œ\n\n### [æ‰«é›·jsç‰ˆ](https://github.com/webgjc/blog/tree/master/js_mine_clearance)\n- jsç‰ˆæ‰«é›·\n\n### [æ‰‹åŠ¨å®ç°kmeansèšç±»ç®—æ³•](https://github.com/webgjc/blog/tree/master/kmeans_hand)\n- pythonæ‰‹åŠ¨å®ç°äº†ä¸‹kmeans\n\n### [KNNåˆ†ç±»ç®—æ³•ï¼ˆmnistä¸ºä¾‹ï¼‰](https://github.com/webgjc/blog/tree/master/knn_mnist)\n- knn demo\n\n### [loadingåŠ¨ç”»](https://github.com/webgjc/blog/tree/master/loading_demo)\n- loadingåŠ¨ç”»\n\n### [é€»è¾‘å›å½’äºŒåˆ†ç±»](https://github.com/webgjc/blog/tree/master/logistic_classification)\n- æ‰‹åŠ¨å®ç°é€»è¾‘å›å½’äºŒåˆ†ç±»\n\n### [æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»å½•ï¼ˆpythonç‰ˆ+PHPç‰ˆï¼‰](https://github.com/webgjc/blog/tree/master/logon_digital_hangzhou_dianzi_university)\n- æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»é™†(ç›®å‰ä¸ä¸€å®šå¯é )\n\n### [matplotlib ç”»å›¾](https://github.com/webgjc/blog/tree/master/matplotlib_draw)\n- matplotlibç”»å›¾demo\n\n### [mctsåšäº”å­æ£‹ai](https://github.com/webgjc/blog/tree/master/mcts_gobang)\n- pythonå®ç°äº†ä¸‹äº”å­æ£‹ï¼Œå¹¶ç”¨mactsç®—æ³•è¿›è¡Œäº†aiæ¨¡æ‹Ÿ\n\n### [node express mongodb demo](https://github.com/webgjc/blog/tree/master/node_express_mongodb)\n- node express demo\n\n### [éçº¿æ€§æ‹Ÿåˆå’Œéçº¿æ€§é€»è¾‘å›å½’](https://github.com/webgjc/blog/tree/master/nonlinear_fitting_logistic)\n- pythonæ‰‹åŠ¨å®ç°æ‹Ÿåˆå’Œå›å½’\n\n### [swoole ä½ ç”»æˆ‘çŒœ](https://github.com/webgjc/blog/tree/master/php_swoole_draw_and_guess)\n- phpçš„swooleçš„socketå®ç°ä½ ç”»æˆ‘çŒœ\n\n### [å”è¯—è¯äº‘](https://github.com/webgjc/blog/tree/master/poet_word_cloud)\n- pythonçš„wordcloudå®ç°å”è¯—çš„è¯äº‘\n\n### [ppythonçš„ä½¿ç”¨](https://github.com/webgjc/blog/tree/master/ppython)\n- ppythonä¸»è¦æ˜¯phpè°ƒç”¨pythonç¨‹åº\n\n### [php rsaåŠ å¯†](https://github.com/webgjc/blog/tree/master/rsa_php)\n- php rsaåŠ å¯†\n\n### [ç®€å•çº¿æ€§å›å½’](https://github.com/webgjc/blog/tree/master/simple_linear_regression)\n- çº¿æ€§å›å½’demo\n\n### [PHPå®ç°SOAPè°ƒç”¨](https://github.com/webgjc/blog/tree/master/soap_php)\n- php soap\n\n### [svmåˆ†ç±»](https://github.com/webgjc/blog/tree/master/svm_classification)\n- svmåˆ†ç±»\n\n### [tensorflowå†™mniståˆ†ç±»](https://github.com/webgjc/blog/tree/master/tensorflow_mnist)\n- tensorflowå†™mniståˆ†ç±»\n\n### [threejs demo](https://github.com/webgjc/blog/tree/master/three_js_demo)\n- three js demo\n\n### [ttsäººæœºèŠå¤©åº”ç”¨](https://github.com/webgjc/blog/tree/master/tts_chat_demo)\n- ttsäººæœºèŠå¤©åº”ç”¨\n\n### [ç®€å•éªŒè¯ç çš„è¯†åˆ«](https://github.com/webgjc/blog/tree/master/verification_code_recognition)\n- ç®€å•éªŒè¯ç çš„è¯†åˆ«\n\n### [web worker demo](https://github.com/webgjc/blog/tree/master/web_worker)\n- web worker demo\n\n### [å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹](https://github.com/webgjc/blog/tree/master/wechat_small_program_sale_demo)\n- å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹\n\n### [å¾®ä¿¡å°ç¨‹åº--æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç ](https://github.com/webgjc/blog/tree/master/wechat_small_program_text_verification_code)\n- å¾®ä¿¡å°ç¨‹åº--æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç ","slug":"æ•´ç†æ™’æ™’è€åšå®¢","published":1,"updated":"2020-04-01T11:51:26.553Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7w000hpb0j09gnep9k","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>ä¹‹å‰å†™è¿‡äº›åšå®¢ï¼Œæ–‡ç« æ²¡ç›´æ¥ä¿ç•™ï¼Œä»£ç éƒ½è¿˜ç•™ç€ï¼›<br>\nè¿™è¾¹å¯¹ä¹‹å‰çš„åšç®€å•è®ºè¿°å’Œæ€»ç»“ã€‚<br>\ngitåœ°å€ï¼š<a href=\"https://github.com/webgjc/blog\" target=\"_blank\" rel=\"noopener\">https://github.com/webgjc/blog</a></p>\n<h2 id=\"content\">content</h2>\n<h3 id=\"ä¿®æ”¹æ¡Œé¢èƒŒæ™¯å›¾ç‰‡\"><a href=\"https://github.com/webgjc/blog/tree/master/change_background_exe\" target=\"_blank\" rel=\"noopener\">ä¿®æ”¹æ¡Œé¢èƒŒæ™¯å›¾ç‰‡</a></h3>\n<ul>\n<li>ä½¿ç”¨pythonå®ç°ï¼Œä»ç½‘ä¸Šè·å–<a href=\"https://bing.ioliu.cn/\" target=\"_blank\" rel=\"noopener\">å›¾ç‰‡</a>ï¼Œä¿®æ”¹windowæ¡Œé¢èƒŒæ™¯å›¾ç‰‡ã€‚å¯ä»¥ç”¨pyinstalleræ‰“åŒ…ä¸ºexe</li>\n</ul>\n<h3 id=\"dfsçš„å‡ ä¸ªdemo\"><a href=\"https://github.com/webgjc/blog/tree/master/dfs_demo\" target=\"_blank\" rel=\"noopener\">dfsçš„å‡ ä¸ªdemo</a></h3>\n<ul>\n<li>dfs.pyåŒ…å«äº†å…¨æ’ï¼Œå…«çš‡åé—®é¢˜<br>\nriver.pyä¸ºå’Œå°šå¦–æ€ªè¿‡æ²³é—®é¢˜<br>\nshudu.pyä¸ºè§£æ•°ç‹¬é—®é¢˜</li>\n</ul>\n<h3 id=\"dlibäººè„¸è¯†åˆ«svmåˆ†ç±»\"><a href=\"https://github.com/webgjc/blog/tree/master/dlib_face\" target=\"_blank\" rel=\"noopener\">dlibäººè„¸è¯†åˆ«+svmåˆ†ç±»</a></h3>\n<ul>\n<li>ä½¿ç”¨pythonçš„dlibåŒ…è¿›è¡Œäººè„¸68ä¸ªå…³é”®ç‚¹è¯†åˆ«ï¼Œå¹¶ä½¿ç”¨svmè¿›è¡Œäº†äºŒåˆ†ç±»ã€‚</li>\n</ul>\n<h3 id=\"flask-mongodb-gunicorn-demo\"><a href=\"https://github.com/webgjc/blog/tree/master/flask_mongodb_gunicorn\" target=\"_blank\" rel=\"noopener\">flask mongodb gunicorn demo</a></h3>\n<ul>\n<li>flask mongodbå°è¯•</li>\n</ul>\n<h3 id=\"å‰ç«¯è®¸æ„¿å¢™æ•ˆæœ\"><a href=\"https://github.com/webgjc/blog/tree/master/front_end_vow_wall_effect\" target=\"_blank\" rel=\"noopener\">å‰ç«¯è®¸æ„¿å¢™æ•ˆæœ</a></h3>\n<ul>\n<li>å‰ç«¯æ•ˆæœ</li>\n</ul>\n<h3 id=\"åœ¨çº¿åŒäººäº”å­æ£‹\"><a href=\"https://github.com/webgjc/blog/tree/master/gobang_online\" target=\"_blank\" rel=\"noopener\">åœ¨çº¿åŒäººäº”å­æ£‹</a></h3>\n<ul>\n<li>ä½¿ç”¨äº†nodeçš„socket.ioçš„websocketå®ç°äº†ç½‘é¡µä¸Šçš„åŒäººäº”å­æ£‹æ¸¸æˆ</li>\n</ul>\n<h3 id=\"æ¢¯åº¦ä¸‹é™æ³•\"><a href=\"https://github.com/webgjc/blog/tree/master/gradient_descent_method\" target=\"_blank\" rel=\"noopener\">æ¢¯åº¦ä¸‹é™æ³•</a></h3>\n<ul>\n<li>å†™äº†ä¸‹æ¢¯åº¦ä¸‹é™çš„æ•ˆæœdemo</li>\n</ul>\n<h3 id=\"æ‰‹æŒå¼¹å¹•æ•ˆæœ\"><a href=\"https://github.com/webgjc/blog/tree/master/handheld_barrage\" target=\"_blank\" rel=\"noopener\">æ‰‹æŒå¼¹å¹•æ•ˆæœ</a></h3>\n<ul>\n<li>å‰ç«¯æ•ˆæœ</li>\n</ul>\n<h3 id=\"èªæ˜é’±è‚¡ç¥¨ç­–ç•¥\"><a href=\"https://github.com/webgjc/blog/tree/master/joinquant_smart_money\" target=\"_blank\" rel=\"noopener\">èªæ˜é’±â€“è‚¡ç¥¨ç­–ç•¥</a></h3>\n<ul>\n<li>åœ¨èšå®½å›æµ‹å¹³å°è¿è¡Œ</li>\n</ul>\n<h3 id=\"æ‰«é›·jsç‰ˆ\"><a href=\"https://github.com/webgjc/blog/tree/master/js_mine_clearance\" target=\"_blank\" rel=\"noopener\">æ‰«é›·jsç‰ˆ</a></h3>\n<ul>\n<li>jsç‰ˆæ‰«é›·</li>\n</ul>\n<h3 id=\"æ‰‹åŠ¨å®ç°kmeansèšç±»ç®—æ³•\"><a href=\"https://github.com/webgjc/blog/tree/master/kmeans_hand\" target=\"_blank\" rel=\"noopener\">æ‰‹åŠ¨å®ç°kmeansèšç±»ç®—æ³•</a></h3>\n<ul>\n<li>pythonæ‰‹åŠ¨å®ç°äº†ä¸‹kmeans</li>\n</ul>\n<h3 id=\"knnåˆ†ç±»ç®—æ³•mnistä¸ºä¾‹\"><a href=\"https://github.com/webgjc/blog/tree/master/knn_mnist\" target=\"_blank\" rel=\"noopener\">KNNåˆ†ç±»ç®—æ³•ï¼ˆmnistä¸ºä¾‹ï¼‰</a></h3>\n<ul>\n<li>knn demo</li>\n</ul>\n<h3 id=\"loadingåŠ¨ç”»\"><a href=\"https://github.com/webgjc/blog/tree/master/loading_demo\" target=\"_blank\" rel=\"noopener\">loadingåŠ¨ç”»</a></h3>\n<ul>\n<li>loadingåŠ¨ç”»</li>\n</ul>\n<h3 id=\"é€»è¾‘å›å½’äºŒåˆ†ç±»\"><a href=\"https://github.com/webgjc/blog/tree/master/logistic_classification\" target=\"_blank\" rel=\"noopener\">é€»è¾‘å›å½’äºŒåˆ†ç±»</a></h3>\n<ul>\n<li>æ‰‹åŠ¨å®ç°é€»è¾‘å›å½’äºŒåˆ†ç±»</li>\n</ul>\n<h3 id=\"æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»å½•pythonç‰ˆphpç‰ˆ\"><a href=\"https://github.com/webgjc/blog/tree/master/logon_digital_hangzhou_dianzi_university\" target=\"_blank\" rel=\"noopener\">æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»å½•ï¼ˆpythonç‰ˆ+PHPç‰ˆï¼‰</a></h3>\n<ul>\n<li>æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»é™†(ç›®å‰ä¸ä¸€å®šå¯é )</li>\n</ul>\n<h3 id=\"matplotlib-ç”»å›¾\"><a href=\"https://github.com/webgjc/blog/tree/master/matplotlib_draw\" target=\"_blank\" rel=\"noopener\">matplotlib ç”»å›¾</a></h3>\n<ul>\n<li>matplotlibç”»å›¾demo</li>\n</ul>\n<h3 id=\"mctsåšäº”å­æ£‹ai\"><a href=\"https://github.com/webgjc/blog/tree/master/mcts_gobang\" target=\"_blank\" rel=\"noopener\">mctsåšäº”å­æ£‹ai</a></h3>\n<ul>\n<li>pythonå®ç°äº†ä¸‹äº”å­æ£‹ï¼Œå¹¶ç”¨mactsç®—æ³•è¿›è¡Œäº†aiæ¨¡æ‹Ÿ</li>\n</ul>\n<h3 id=\"node-express-mongodb-demo\"><a href=\"https://github.com/webgjc/blog/tree/master/node_express_mongodb\" target=\"_blank\" rel=\"noopener\">node express mongodb demo</a></h3>\n<ul>\n<li>node express demo</li>\n</ul>\n<h3 id=\"éçº¿æ€§æ‹Ÿåˆå’Œéçº¿æ€§é€»è¾‘å›å½’\"><a href=\"https://github.com/webgjc/blog/tree/master/nonlinear_fitting_logistic\" target=\"_blank\" rel=\"noopener\">éçº¿æ€§æ‹Ÿåˆå’Œéçº¿æ€§é€»è¾‘å›å½’</a></h3>\n<ul>\n<li>pythonæ‰‹åŠ¨å®ç°æ‹Ÿåˆå’Œå›å½’</li>\n</ul>\n<h3 id=\"swoole-ä½ ç”»æˆ‘çŒœ\"><a href=\"https://github.com/webgjc/blog/tree/master/php_swoole_draw_and_guess\" target=\"_blank\" rel=\"noopener\">swoole ä½ ç”»æˆ‘çŒœ</a></h3>\n<ul>\n<li>phpçš„swooleçš„socketå®ç°ä½ ç”»æˆ‘çŒœ</li>\n</ul>\n<h3 id=\"å”è¯—è¯äº‘\"><a href=\"https://github.com/webgjc/blog/tree/master/poet_word_cloud\" target=\"_blank\" rel=\"noopener\">å”è¯—è¯äº‘</a></h3>\n<ul>\n<li>pythonçš„wordcloudå®ç°å”è¯—çš„è¯äº‘</li>\n</ul>\n<h3 id=\"ppythonçš„ä½¿ç”¨\"><a href=\"https://github.com/webgjc/blog/tree/master/ppython\" target=\"_blank\" rel=\"noopener\">ppythonçš„ä½¿ç”¨</a></h3>\n<ul>\n<li>ppythonä¸»è¦æ˜¯phpè°ƒç”¨pythonç¨‹åº</li>\n</ul>\n<h3 id=\"php-rsaåŠ å¯†\"><a href=\"https://github.com/webgjc/blog/tree/master/rsa_php\" target=\"_blank\" rel=\"noopener\">php rsaåŠ å¯†</a></h3>\n<ul>\n<li>php rsaåŠ å¯†</li>\n</ul>\n<h3 id=\"ç®€å•çº¿æ€§å›å½’\"><a href=\"https://github.com/webgjc/blog/tree/master/simple_linear_regression\" target=\"_blank\" rel=\"noopener\">ç®€å•çº¿æ€§å›å½’</a></h3>\n<ul>\n<li>çº¿æ€§å›å½’demo</li>\n</ul>\n<h3 id=\"phpå®ç°soapè°ƒç”¨\"><a href=\"https://github.com/webgjc/blog/tree/master/soap_php\" target=\"_blank\" rel=\"noopener\">PHPå®ç°SOAPè°ƒç”¨</a></h3>\n<ul>\n<li>php soap</li>\n</ul>\n<h3 id=\"svmåˆ†ç±»\"><a href=\"https://github.com/webgjc/blog/tree/master/svm_classification\" target=\"_blank\" rel=\"noopener\">svmåˆ†ç±»</a></h3>\n<ul>\n<li>svmåˆ†ç±»</li>\n</ul>\n<h3 id=\"tensorflowå†™mniståˆ†ç±»\"><a href=\"https://github.com/webgjc/blog/tree/master/tensorflow_mnist\" target=\"_blank\" rel=\"noopener\">tensorflowå†™mniståˆ†ç±»</a></h3>\n<ul>\n<li>tensorflowå†™mniståˆ†ç±»</li>\n</ul>\n<h3 id=\"threejs-demo\"><a href=\"https://github.com/webgjc/blog/tree/master/three_js_demo\" target=\"_blank\" rel=\"noopener\">threejs demo</a></h3>\n<ul>\n<li>three js demo</li>\n</ul>\n<h3 id=\"ttsäººæœºèŠå¤©åº”ç”¨\"><a href=\"https://github.com/webgjc/blog/tree/master/tts_chat_demo\" target=\"_blank\" rel=\"noopener\">ttsäººæœºèŠå¤©åº”ç”¨</a></h3>\n<ul>\n<li>ttsäººæœºèŠå¤©åº”ç”¨</li>\n</ul>\n<h3 id=\"ç®€å•éªŒè¯ç çš„è¯†åˆ«\"><a href=\"https://github.com/webgjc/blog/tree/master/verification_code_recognition\" target=\"_blank\" rel=\"noopener\">ç®€å•éªŒè¯ç çš„è¯†åˆ«</a></h3>\n<ul>\n<li>ç®€å•éªŒè¯ç çš„è¯†åˆ«</li>\n</ul>\n<h3 id=\"web-worker-demo\"><a href=\"https://github.com/webgjc/blog/tree/master/web_worker\" target=\"_blank\" rel=\"noopener\">web worker demo</a></h3>\n<ul>\n<li>web worker demo</li>\n</ul>\n<h3 id=\"å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹\"><a href=\"https://github.com/webgjc/blog/tree/master/wechat_small_program_sale_demo\" target=\"_blank\" rel=\"noopener\">å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹</a></h3>\n<ul>\n<li>å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹</li>\n</ul>\n<h3 id=\"å¾®ä¿¡å°ç¨‹åºæ–‡å­—è”ç³»æ–¹å¼äºŒç»´ç \"><a href=\"https://github.com/webgjc/blog/tree/master/wechat_small_program_text_verification_code\" target=\"_blank\" rel=\"noopener\">å¾®ä¿¡å°ç¨‹åºâ€“æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç </a></h3>\n<ul>\n<li>å¾®ä¿¡å°ç¨‹åºâ€“æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç </li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2>å‰è¨€</h2>\n<p>ä¹‹å‰å†™è¿‡äº›åšå®¢ï¼Œæ–‡ç« æ²¡ç›´æ¥ä¿ç•™ï¼Œä»£ç éƒ½è¿˜ç•™ç€ï¼›<br>\nè¿™è¾¹å¯¹ä¹‹å‰çš„åšç®€å•è®ºè¿°å’Œæ€»ç»“ã€‚<br>\ngitåœ°å€ï¼š<a href=\"https://github.com/webgjc/blog\" target=\"_blank\" rel=\"noopener\">https://github.com/webgjc/blog</a></p>\n<h2>content</h2>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/change_background_exe\" target=\"_blank\" rel=\"noopener\">ä¿®æ”¹æ¡Œé¢èƒŒæ™¯å›¾ç‰‡</a></h3>\n<ul>\n<li>ä½¿ç”¨pythonå®ç°ï¼Œä»ç½‘ä¸Šè·å–<a href=\"https://bing.ioliu.cn/\" target=\"_blank\" rel=\"noopener\">å›¾ç‰‡</a>ï¼Œä¿®æ”¹windowæ¡Œé¢èƒŒæ™¯å›¾ç‰‡ã€‚å¯ä»¥ç”¨pyinstalleræ‰“åŒ…ä¸ºexe</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/dfs_demo\" target=\"_blank\" rel=\"noopener\">dfsçš„å‡ ä¸ªdemo</a></h3>\n<ul>\n<li>dfs.pyåŒ…å«äº†å…¨æ’ï¼Œå…«çš‡åé—®é¢˜<br>\nriver.pyä¸ºå’Œå°šå¦–æ€ªè¿‡æ²³é—®é¢˜<br>\nshudu.pyä¸ºè§£æ•°ç‹¬é—®é¢˜</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/dlib_face\" target=\"_blank\" rel=\"noopener\">dlibäººè„¸è¯†åˆ«+svmåˆ†ç±»</a></h3>\n<ul>\n<li>ä½¿ç”¨pythonçš„dlibåŒ…è¿›è¡Œäººè„¸68ä¸ªå…³é”®ç‚¹è¯†åˆ«ï¼Œå¹¶ä½¿ç”¨svmè¿›è¡Œäº†äºŒåˆ†ç±»ã€‚</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/flask_mongodb_gunicorn\" target=\"_blank\" rel=\"noopener\">flask mongodb gunicorn demo</a></h3>\n<ul>\n<li>flask mongodbå°è¯•</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/front_end_vow_wall_effect\" target=\"_blank\" rel=\"noopener\">å‰ç«¯è®¸æ„¿å¢™æ•ˆæœ</a></h3>\n<ul>\n<li>å‰ç«¯æ•ˆæœ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/gobang_online\" target=\"_blank\" rel=\"noopener\">åœ¨çº¿åŒäººäº”å­æ£‹</a></h3>\n<ul>\n<li>ä½¿ç”¨äº†nodeçš„socket.ioçš„websocketå®ç°äº†ç½‘é¡µä¸Šçš„åŒäººäº”å­æ£‹æ¸¸æˆ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/gradient_descent_method\" target=\"_blank\" rel=\"noopener\">æ¢¯åº¦ä¸‹é™æ³•</a></h3>\n<ul>\n<li>å†™äº†ä¸‹æ¢¯åº¦ä¸‹é™çš„æ•ˆæœdemo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/handheld_barrage\" target=\"_blank\" rel=\"noopener\">æ‰‹æŒå¼¹å¹•æ•ˆæœ</a></h3>\n<ul>\n<li>å‰ç«¯æ•ˆæœ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/joinquant_smart_money\" target=\"_blank\" rel=\"noopener\">èªæ˜é’±â€“è‚¡ç¥¨ç­–ç•¥</a></h3>\n<ul>\n<li>åœ¨èšå®½å›æµ‹å¹³å°è¿è¡Œ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/js_mine_clearance\" target=\"_blank\" rel=\"noopener\">æ‰«é›·jsç‰ˆ</a></h3>\n<ul>\n<li>jsç‰ˆæ‰«é›·</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/kmeans_hand\" target=\"_blank\" rel=\"noopener\">æ‰‹åŠ¨å®ç°kmeansèšç±»ç®—æ³•</a></h3>\n<ul>\n<li>pythonæ‰‹åŠ¨å®ç°äº†ä¸‹kmeans</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/knn_mnist\" target=\"_blank\" rel=\"noopener\">KNNåˆ†ç±»ç®—æ³•ï¼ˆmnistä¸ºä¾‹ï¼‰</a></h3>\n<ul>\n<li>knn demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/loading_demo\" target=\"_blank\" rel=\"noopener\">loadingåŠ¨ç”»</a></h3>\n<ul>\n<li>loadingåŠ¨ç”»</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/logistic_classification\" target=\"_blank\" rel=\"noopener\">é€»è¾‘å›å½’äºŒåˆ†ç±»</a></h3>\n<ul>\n<li>æ‰‹åŠ¨å®ç°é€»è¾‘å›å½’äºŒåˆ†ç±»</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/logon_digital_hangzhou_dianzi_university\" target=\"_blank\" rel=\"noopener\">æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»å½•ï¼ˆpythonç‰ˆ+PHPç‰ˆï¼‰</a></h3>\n<ul>\n<li>æ•°å­—æ­ç”µæ¨¡æ‹Ÿç™»é™†(ç›®å‰ä¸ä¸€å®šå¯é )</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/matplotlib_draw\" target=\"_blank\" rel=\"noopener\">matplotlib ç”»å›¾</a></h3>\n<ul>\n<li>matplotlibç”»å›¾demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/mcts_gobang\" target=\"_blank\" rel=\"noopener\">mctsåšäº”å­æ£‹ai</a></h3>\n<ul>\n<li>pythonå®ç°äº†ä¸‹äº”å­æ£‹ï¼Œå¹¶ç”¨mactsç®—æ³•è¿›è¡Œäº†aiæ¨¡æ‹Ÿ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/node_express_mongodb\" target=\"_blank\" rel=\"noopener\">node express mongodb demo</a></h3>\n<ul>\n<li>node express demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/nonlinear_fitting_logistic\" target=\"_blank\" rel=\"noopener\">éçº¿æ€§æ‹Ÿåˆå’Œéçº¿æ€§é€»è¾‘å›å½’</a></h3>\n<ul>\n<li>pythonæ‰‹åŠ¨å®ç°æ‹Ÿåˆå’Œå›å½’</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/php_swoole_draw_and_guess\" target=\"_blank\" rel=\"noopener\">swoole ä½ ç”»æˆ‘çŒœ</a></h3>\n<ul>\n<li>phpçš„swooleçš„socketå®ç°ä½ ç”»æˆ‘çŒœ</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/poet_word_cloud\" target=\"_blank\" rel=\"noopener\">å”è¯—è¯äº‘</a></h3>\n<ul>\n<li>pythonçš„wordcloudå®ç°å”è¯—çš„è¯äº‘</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/ppython\" target=\"_blank\" rel=\"noopener\">ppythonçš„ä½¿ç”¨</a></h3>\n<ul>\n<li>ppythonä¸»è¦æ˜¯phpè°ƒç”¨pythonç¨‹åº</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/rsa_php\" target=\"_blank\" rel=\"noopener\">php rsaåŠ å¯†</a></h3>\n<ul>\n<li>php rsaåŠ å¯†</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/simple_linear_regression\" target=\"_blank\" rel=\"noopener\">ç®€å•çº¿æ€§å›å½’</a></h3>\n<ul>\n<li>çº¿æ€§å›å½’demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/soap_php\" target=\"_blank\" rel=\"noopener\">PHPå®ç°SOAPè°ƒç”¨</a></h3>\n<ul>\n<li>php soap</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/svm_classification\" target=\"_blank\" rel=\"noopener\">svmåˆ†ç±»</a></h3>\n<ul>\n<li>svmåˆ†ç±»</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/tensorflow_mnist\" target=\"_blank\" rel=\"noopener\">tensorflowå†™mniståˆ†ç±»</a></h3>\n<ul>\n<li>tensorflowå†™mniståˆ†ç±»</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/three_js_demo\" target=\"_blank\" rel=\"noopener\">threejs demo</a></h3>\n<ul>\n<li>three js demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/tts_chat_demo\" target=\"_blank\" rel=\"noopener\">ttsäººæœºèŠå¤©åº”ç”¨</a></h3>\n<ul>\n<li>ttsäººæœºèŠå¤©åº”ç”¨</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/verification_code_recognition\" target=\"_blank\" rel=\"noopener\">ç®€å•éªŒè¯ç çš„è¯†åˆ«</a></h3>\n<ul>\n<li>ç®€å•éªŒè¯ç çš„è¯†åˆ«</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/web_worker\" target=\"_blank\" rel=\"noopener\">web worker demo</a></h3>\n<ul>\n<li>web worker demo</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/wechat_small_program_sale_demo\" target=\"_blank\" rel=\"noopener\">å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹</a></h3>\n<ul>\n<li>å¾®ä¿¡å°ç¨‹åºè´­ç‰©åŠŸèƒ½ç¤ºä¾‹</li>\n</ul>\n<h3><a href=\"https://github.com/webgjc/blog/tree/master/wechat_small_program_text_verification_code\" target=\"_blank\" rel=\"noopener\">å¾®ä¿¡å°ç¨‹åºâ€“æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç </a></h3>\n<ul>\n<li>å¾®ä¿¡å°ç¨‹åºâ€“æ–‡å­—/è”ç³»æ–¹å¼äºŒç»´ç </li>\n</ul>\n"},{"title":"è®²è®²å…ƒæ•°æ®","catalog":true,"date":"2020-03-31T10:47:13.000Z","subtitle":"å¤§æ•°æ®å¹³å°ä¸­å…ƒæ•°æ®ç³»ç»Ÿçš„ä¸€äº›è§è§£","header-img":"/img/article_header/header.jpg","_content":"\n## å‰è¨€\n\nåšäº†ä¸€äº›å…ƒæ•°æ®çš„ç³»ç»Ÿï¼Œåˆ†äº«ä¸€äº›ç›¸å…³çš„ç†è§£ä¸ä½“ä¼šã€‚  \næºæ‚ä¸ªäººç†è§£ä¸å®æ“å†å²ï¼Œä¸ä¸€å®šæ˜¯æœ€ä½³å®è·µã€‚\n\n## å…ƒæ•°æ®å®šä¹‰\n\nå…ƒæ•°æ®ä¸€èˆ¬æŒ‡çš„æ˜¯ **å®šä¹‰æ•°æ®çš„æ•°æ®**ã€‚\n\nå¯¹äºä¸€ä¸ªåç«¯ç³»ç»Ÿæˆ–è€…å¤§æ•°æ®é›†ç¾¤æ¥è¯´ï¼ŒåŸºæœ¬çš„å…ƒæ•°æ®å°±æ˜¯åœ¨æ‰§è¡Œddlæ—¶äº§ç”Ÿçš„å„ç§åº“è¡¨å­—æ®µç­‰ä¿¡æ¯ã€‚ \n\n- æ¯”å¦‚mysqlçš„æ¯ä¸ªå®ä¾‹ä¼šé»˜è®¤æœ‰ä¸€ä¸ªå«information_schemaçš„åº“ï¼›  \n- æ¯”å¦‚hiveåœ¨è¿è¡Œå‰éƒ½éœ€è¦é…ç½®ä¸€ä¸ªmetastoreåº“ï¼Œä¸€èˆ¬ä¸ºmysqlåº“ä¸”åœ¨æ‰§è¡Œå‰åˆå§‹åŒ–ï¼›  \n\nè¿™é‡Œé¢éƒ½è®°å½•äº†å½“å‰å®ä¾‹æˆ–é›†ç¾¤çš„å¤§éƒ¨åˆ†åŸºç¡€å…ƒæ•°æ®ï¼Œä¸”åœ¨å…ƒæ•°æ®æ›´æ–°æ—¶å®æ—¶æ›´æ–°è¿™ä¸ªåº“ã€‚  \nå½“ç„¶è¿˜æœ‰ä¸€äº›å…ƒæ•°æ®æ¯”å¦‚æ•°æ®è¡€ç¼˜ï¼Œå…³è”å…³ç³»ï¼Œçƒ­åº¦ä¿¡æ¯ï¼Œä¸šåŠ¡å…ƒæ•°æ®ç­‰éœ€è¦ä¸€äº›å…¶ä»–æ‰‹æ®µè·å¾—ã€‚\n\n## å…ƒæ•°æ®é‡‡é›†\n\né¦–å…ˆè¿›è¡Œå…ƒæ•°æ®çš„é‡‡é›†å’Œæ•´åˆã€‚è¿™è¾¹éƒ½ä»¥hiveä¸¾ä¾‹ã€‚  \n\nå¯èƒ½ä¼šæœ‰æƒ³æ³•å¦‚æœåªæ˜¯å±•ç¤ºçš„è¯å¯ä»¥ç›´æ¥è¿metastoreåº“ï¼Œæ²¡å¿…è¦å†é‡‡é›†åˆ°åç«¯ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæœ‰å»¶æ—¶ã€‚ä½†åæœŸä¸ä¸€å®šä¼šåœ¨ä¸€ä¸ªé›†ç¾¤ï¼Œè€Œä¸”åº“è¡¨å­—æ®µç­‰è¿˜è¦æœ‰å…¶ä»–çš„å„ç§å…³è”æ•°æ®ï¼Œç»Ÿè®¡æ•°æ®ï¼Œå› æ­¤é‡‡é›†åˆ°åç«¯æ˜¯æ¯”è¾ƒç¨³å¦¥çš„åšæ³•ã€‚\n\n- å¯¹äºåº“ï¼Œè¡¨ï¼Œå­—æ®µï¼Œåˆ†åŒºç­‰ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨metastoreåº“è·å–ã€‚  \né‡‡å–å®šæ—¶åŒæ­¥çš„ç­–ç•¥ï¼ŒæŒ‰åº“æ¥åŒæ­¥ã€‚å› ä¸ºåŒæ­¥å…¨é‡æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œå¯ä»¥åˆ†ä¸¤ç§å®šæ—¶åŒæ­¥ï¼š  \nç¬¬ä¸€ç§ä¸ºè·å–è¡¨ååˆ—è¡¨å¯¹æ¯”å·²åŒæ­¥çš„è€è¡¨ï¼Œåªé‡‡é›†æ–°è¡¨ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå¿«ï¼›\nç¬¬äºŒç§ä¸ºè·å–å…¨é‡çš„è¡¨å’Œå­—æ®µç»“æ„å¯¹æ¯”ï¼Œæ–°å¢çš„åšinsertï¼Œä¿®æ”¹çš„åšupdateï¼›  \nåŒæ—¶ä¹Ÿä¿ç•™ä¸€ç§æ‰‹åŠ¨è§¦å‘æ–¹å¼ï¼Œå¯ä»¥è®©ç”¨æˆ·æ‰‹åŠ¨åŒæ­¥åº“æˆ–è¡¨ã€‚\n\n\n- å¯¹äºè¡€ç¼˜ï¼Œçƒ­åº¦ï¼Œå…³è”å…³ç³»ç­‰ä¿¡æ¯ï¼Œç›®å‰æ¯”è¾ƒç›´æ¥çš„æ˜¯ä½¿ç”¨hiveHookã€‚  \nè¡€ç¼˜hiveHookç›´æ¥æœ‰LineageLoggerç±»å¯ä»¥ä½¿ç”¨è·å–åˆ°è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜ã€‚(ä¸è¿‡è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œå°±ä¼šæ¯”è¾ƒéš¾äºæ’æŸ¥)ï¼›çƒ­åº¦éœ€è¦sqlè§£æå‡ºè¡¨åå’Œå­—æ®µåï¼Œå¯¹ç”¨åˆ°çš„éƒ½è¿›è¡Œç»Ÿè®¡ï¼›å…³è”å…³ç³»æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™ç”¨æˆ·å¯¹è¡¨æˆ–å­—æ®µè¿›è¡Œäº†å…³è”;æ‹¿åˆ°è¿™äº›æ•°æ®åå¯ä»¥ç›´æ¥æ”¾åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼Œç„¶åèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å­˜æ•°æ®å’Œæä¾›æ¥å£ã€‚  \nå¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡yarnï¼Œhookï¼Œç¦»çº¿ä»»åŠ¡ï¼Œå³æ—¶æŸ¥è¯¢ç­‰çš„æ¥æºé‡‡é›†åˆ°æ¯å¤©è¿è¡Œsqlï¼Œä½¿ç”¨sqlè§£ææ¯”å¦‚antlr4å’Œ[hiveè‡ªå¸¦çš„Hplsql.g4](https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4)è§£æå‡ºä¸Šé¢è¿™äº›ä¿¡æ¯ï¼Œç›´æ¥å­˜å‚¨è‡³åç«¯ï¼Œè§£ææ–‡ä»¶å¯ä»¥è‡ªè¡Œåšä¼˜åŒ–ã€‚\n\n\n- å¯¹äºä¸šåŠ¡å…ƒæ•°æ®ï¼Œæ¯”å¦‚è¡¨è´Ÿè´£äººï¼Œå±‚çº§åˆ’åˆ†ï¼Œä¸šåŠ¡åˆ’åˆ†ï¼Œæ‰“æ ‡ç­¾ç­‰ã€‚  \nå› ä¸ºè¡¨å­—æ®µç­‰ä¿¡æ¯æ˜¯ä»hiveåŒæ­¥æ¥çš„ï¼Œä¸”åˆ›è¡¨äººä¸€èˆ¬éƒ½ä¸ºç³»ç»Ÿè´¦å·ï¼Œå› æ­¤è¡¨è´Ÿè´£äººæ¥æºä¸€ä¸ªä¸ºä»ç¦»çº¿ä»»åŠ¡åŒæ­¥è€Œæ¥ï¼Œå¦ä¸€ä¸ªä¸ºä»å»ºæ¨¡å·¥å…·åŒæ­¥è€Œæ¥ã€‚  \nå±‚çº§åˆ’åˆ†ä¸šåŠ¡åˆ’åˆ†ä¸€èˆ¬æ˜¯æŒ‰åº“åæˆ–è¡¨åçš„è§„åˆ™å°±å¯ä»¥åŒºåˆ†å¼€ï¼Œåœ¨é‡‡é›†çš„æ—¶å€™å°±åŠ ä¸Šï¼ŒåæœŸæœ‰è¯¯çš„è¯éœ€è¦äººå·¥ç»´æŠ¤ã€‚  \nå…¶ä»–ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®é‡‡å–æ‰¹é‡å¯¼å‡ºå¯¼å…¥å’Œé¡µé¢ä¸Šç»´æŠ¤ã€‚\n\n## å…ƒæ•°æ®å¹³å°\n\nå…ƒæ•°æ®å¹³å°ä¸€èˆ¬ä½œä¸ºæ•°æ®åœ°å›¾ï¼Œé™¤äº†é‡‡é›†åˆ°å…ƒæ•°æ®ä»¥å¤–ï¼Œè¿˜è¦å¯¹å…ƒæ•°æ®è¿›è¡Œæ ¡æ­£ï¼Œå˜æ›´è®°å½•ï¼Œä½¿ç”¨è¯´æ˜ï¼Œç»Ÿè®¡ç­‰ã€‚  \nåœ¨é‡‡é›†è¡¨å­—æ®µç­‰å…ƒæ•°æ®æ—¶ï¼Œå¯¹å…ƒæ•°æ®çš„ä¿ç•™ä¸€ä»½å†å²ç‰ˆæœ¬ï¼Œå¯ä»¥åšå˜æ›´æŸ¥è¯¢ä¸æŠ¥è­¦ã€‚  \nåœ¨æ¥å£ä¸Šå®ç°å¯¹ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®çš„æ ¡æ­£å’Œä½¿ç”¨è¯´æ˜ã€‚  \nå®šæ—¶ç»Ÿè®¡å…ƒæ•°æ®ï¼Œå±•ç¤ºä¸€äº›å…ƒæ•°æ®çš„å…¨å±€æ•°æ®ï¼Œæ€»è®¡ï¼Œtopæ¦œç­‰ã€‚\n\nå¹³å°ç•Œé¢ä¸Šï¼Œé™¤äº†å¯¹ä¸Šè¿°æ‰€æœ‰å…ƒæ•°æ®çš„å±•ç¤ºï¼ŒåŒæ—¶ä¹Ÿæœ‰å„ç±»å…ƒæ•°æ®çš„ç»Ÿè®¡å’Œå›¾è¡¨å±•ç¤ºï¼Œè¿˜æœ‰å„ç±»çš„æ“ä½œå¯ä»¥æ“ä½œä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®ã€‚\n\n## å…ƒæ•°æ®åº”ç”¨\n\né™¤äº†å…ƒæ•°æ®å¹³å°ä¸Šçš„åŠŸèƒ½å¤–ï¼Œå…ƒæ•°æ®ä¹Ÿå¯ä»¥æœ‰å…¶ä»–å¾ˆå¤šçš„åº”ç”¨ã€‚\næ¯”å¦‚å…ƒæ•°æ®çš„æŒ‡æ ‡å»ºè®¾ï¼Œå°†å­—æ®µå…ƒæ•°æ®ä¸æŒ‡æ ‡è¿›è¡Œç»‘å®šï¼Œä»è€Œè®©å…ƒæ•°æ®æ›´è´´è¿‘ä¸šåŠ¡ï¼›\næ¯”å¦‚åœ¨æ§åˆ¶æ•°æ®æƒé™æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¡¨å­—æ®µçš„ç­–ç•¥ï¼›  \næ¯”å¦‚åœ¨å³æ—¶æŸ¥è¯¢æ—¶ç”¨æˆ·éœ€è¦æŸ¥çœ‹åº“è¡¨å­—æ®µä¿¡æ¯æ¥å®Œæˆsqlï¼›  \næ¯”å¦‚åœ¨æ•°æ®ç›‘æ§ä¸æ•°æ®è´¨é‡ä¸­ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å…ƒæ•°æ®ï¼›\n\n## å‚è€ƒå‹å†›\n- [æœ‰èµå…ƒæ•°æ®](https://tech.youzan.com/youzan-metadata/)\n- [é¥¿äº†ä¹ˆå…ƒæ•°æ®](https://dbaplus.cn/news-73-2143-1.html)\n- [çŸ¥ä¹ä¸€ä¸ªå…³äºå…ƒæ•°æ®çš„å›ç­”](https://www.zhihu.com/question/20679872/answer/54883263)","source":"_posts/è®²è®²å…ƒæ•°æ®.md","raw":"---\ntitle: è®²è®²å…ƒæ•°æ®\ncatalog: true\ndate: 2020-03-31 18:47:13\nsubtitle: å¤§æ•°æ®å¹³å°ä¸­å…ƒæ•°æ®ç³»ç»Ÿçš„ä¸€äº›è§è§£\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- å…ƒæ•°æ®\n- å¤§æ•°æ®\n---\n\n## å‰è¨€\n\nåšäº†ä¸€äº›å…ƒæ•°æ®çš„ç³»ç»Ÿï¼Œåˆ†äº«ä¸€äº›ç›¸å…³çš„ç†è§£ä¸ä½“ä¼šã€‚  \næºæ‚ä¸ªäººç†è§£ä¸å®æ“å†å²ï¼Œä¸ä¸€å®šæ˜¯æœ€ä½³å®è·µã€‚\n\n## å…ƒæ•°æ®å®šä¹‰\n\nå…ƒæ•°æ®ä¸€èˆ¬æŒ‡çš„æ˜¯ **å®šä¹‰æ•°æ®çš„æ•°æ®**ã€‚\n\nå¯¹äºä¸€ä¸ªåç«¯ç³»ç»Ÿæˆ–è€…å¤§æ•°æ®é›†ç¾¤æ¥è¯´ï¼ŒåŸºæœ¬çš„å…ƒæ•°æ®å°±æ˜¯åœ¨æ‰§è¡Œddlæ—¶äº§ç”Ÿçš„å„ç§åº“è¡¨å­—æ®µç­‰ä¿¡æ¯ã€‚ \n\n- æ¯”å¦‚mysqlçš„æ¯ä¸ªå®ä¾‹ä¼šé»˜è®¤æœ‰ä¸€ä¸ªå«information_schemaçš„åº“ï¼›  \n- æ¯”å¦‚hiveåœ¨è¿è¡Œå‰éƒ½éœ€è¦é…ç½®ä¸€ä¸ªmetastoreåº“ï¼Œä¸€èˆ¬ä¸ºmysqlåº“ä¸”åœ¨æ‰§è¡Œå‰åˆå§‹åŒ–ï¼›  \n\nè¿™é‡Œé¢éƒ½è®°å½•äº†å½“å‰å®ä¾‹æˆ–é›†ç¾¤çš„å¤§éƒ¨åˆ†åŸºç¡€å…ƒæ•°æ®ï¼Œä¸”åœ¨å…ƒæ•°æ®æ›´æ–°æ—¶å®æ—¶æ›´æ–°è¿™ä¸ªåº“ã€‚  \nå½“ç„¶è¿˜æœ‰ä¸€äº›å…ƒæ•°æ®æ¯”å¦‚æ•°æ®è¡€ç¼˜ï¼Œå…³è”å…³ç³»ï¼Œçƒ­åº¦ä¿¡æ¯ï¼Œä¸šåŠ¡å…ƒæ•°æ®ç­‰éœ€è¦ä¸€äº›å…¶ä»–æ‰‹æ®µè·å¾—ã€‚\n\n## å…ƒæ•°æ®é‡‡é›†\n\né¦–å…ˆè¿›è¡Œå…ƒæ•°æ®çš„é‡‡é›†å’Œæ•´åˆã€‚è¿™è¾¹éƒ½ä»¥hiveä¸¾ä¾‹ã€‚  \n\nå¯èƒ½ä¼šæœ‰æƒ³æ³•å¦‚æœåªæ˜¯å±•ç¤ºçš„è¯å¯ä»¥ç›´æ¥è¿metastoreåº“ï¼Œæ²¡å¿…è¦å†é‡‡é›†åˆ°åç«¯ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæœ‰å»¶æ—¶ã€‚ä½†åæœŸä¸ä¸€å®šä¼šåœ¨ä¸€ä¸ªé›†ç¾¤ï¼Œè€Œä¸”åº“è¡¨å­—æ®µç­‰è¿˜è¦æœ‰å…¶ä»–çš„å„ç§å…³è”æ•°æ®ï¼Œç»Ÿè®¡æ•°æ®ï¼Œå› æ­¤é‡‡é›†åˆ°åç«¯æ˜¯æ¯”è¾ƒç¨³å¦¥çš„åšæ³•ã€‚\n\n- å¯¹äºåº“ï¼Œè¡¨ï¼Œå­—æ®µï¼Œåˆ†åŒºç­‰ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨metastoreåº“è·å–ã€‚  \né‡‡å–å®šæ—¶åŒæ­¥çš„ç­–ç•¥ï¼ŒæŒ‰åº“æ¥åŒæ­¥ã€‚å› ä¸ºåŒæ­¥å…¨é‡æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œå¯ä»¥åˆ†ä¸¤ç§å®šæ—¶åŒæ­¥ï¼š  \nç¬¬ä¸€ç§ä¸ºè·å–è¡¨ååˆ—è¡¨å¯¹æ¯”å·²åŒæ­¥çš„è€è¡¨ï¼Œåªé‡‡é›†æ–°è¡¨ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå¿«ï¼›\nç¬¬äºŒç§ä¸ºè·å–å…¨é‡çš„è¡¨å’Œå­—æ®µç»“æ„å¯¹æ¯”ï¼Œæ–°å¢çš„åšinsertï¼Œä¿®æ”¹çš„åšupdateï¼›  \nåŒæ—¶ä¹Ÿä¿ç•™ä¸€ç§æ‰‹åŠ¨è§¦å‘æ–¹å¼ï¼Œå¯ä»¥è®©ç”¨æˆ·æ‰‹åŠ¨åŒæ­¥åº“æˆ–è¡¨ã€‚\n\n\n- å¯¹äºè¡€ç¼˜ï¼Œçƒ­åº¦ï¼Œå…³è”å…³ç³»ç­‰ä¿¡æ¯ï¼Œç›®å‰æ¯”è¾ƒç›´æ¥çš„æ˜¯ä½¿ç”¨hiveHookã€‚  \nè¡€ç¼˜hiveHookç›´æ¥æœ‰LineageLoggerç±»å¯ä»¥ä½¿ç”¨è·å–åˆ°è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜ã€‚(ä¸è¿‡è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œå°±ä¼šæ¯”è¾ƒéš¾äºæ’æŸ¥)ï¼›çƒ­åº¦éœ€è¦sqlè§£æå‡ºè¡¨åå’Œå­—æ®µåï¼Œå¯¹ç”¨åˆ°çš„éƒ½è¿›è¡Œç»Ÿè®¡ï¼›å…³è”å…³ç³»æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™ç”¨æˆ·å¯¹è¡¨æˆ–å­—æ®µè¿›è¡Œäº†å…³è”;æ‹¿åˆ°è¿™äº›æ•°æ®åå¯ä»¥ç›´æ¥æ”¾åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼Œç„¶åèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å­˜æ•°æ®å’Œæä¾›æ¥å£ã€‚  \nå¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡yarnï¼Œhookï¼Œç¦»çº¿ä»»åŠ¡ï¼Œå³æ—¶æŸ¥è¯¢ç­‰çš„æ¥æºé‡‡é›†åˆ°æ¯å¤©è¿è¡Œsqlï¼Œä½¿ç”¨sqlè§£ææ¯”å¦‚antlr4å’Œ[hiveè‡ªå¸¦çš„Hplsql.g4](https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4)è§£æå‡ºä¸Šé¢è¿™äº›ä¿¡æ¯ï¼Œç›´æ¥å­˜å‚¨è‡³åç«¯ï¼Œè§£ææ–‡ä»¶å¯ä»¥è‡ªè¡Œåšä¼˜åŒ–ã€‚\n\n\n- å¯¹äºä¸šåŠ¡å…ƒæ•°æ®ï¼Œæ¯”å¦‚è¡¨è´Ÿè´£äººï¼Œå±‚çº§åˆ’åˆ†ï¼Œä¸šåŠ¡åˆ’åˆ†ï¼Œæ‰“æ ‡ç­¾ç­‰ã€‚  \nå› ä¸ºè¡¨å­—æ®µç­‰ä¿¡æ¯æ˜¯ä»hiveåŒæ­¥æ¥çš„ï¼Œä¸”åˆ›è¡¨äººä¸€èˆ¬éƒ½ä¸ºç³»ç»Ÿè´¦å·ï¼Œå› æ­¤è¡¨è´Ÿè´£äººæ¥æºä¸€ä¸ªä¸ºä»ç¦»çº¿ä»»åŠ¡åŒæ­¥è€Œæ¥ï¼Œå¦ä¸€ä¸ªä¸ºä»å»ºæ¨¡å·¥å…·åŒæ­¥è€Œæ¥ã€‚  \nå±‚çº§åˆ’åˆ†ä¸šåŠ¡åˆ’åˆ†ä¸€èˆ¬æ˜¯æŒ‰åº“åæˆ–è¡¨åçš„è§„åˆ™å°±å¯ä»¥åŒºåˆ†å¼€ï¼Œåœ¨é‡‡é›†çš„æ—¶å€™å°±åŠ ä¸Šï¼ŒåæœŸæœ‰è¯¯çš„è¯éœ€è¦äººå·¥ç»´æŠ¤ã€‚  \nå…¶ä»–ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®é‡‡å–æ‰¹é‡å¯¼å‡ºå¯¼å…¥å’Œé¡µé¢ä¸Šç»´æŠ¤ã€‚\n\n## å…ƒæ•°æ®å¹³å°\n\nå…ƒæ•°æ®å¹³å°ä¸€èˆ¬ä½œä¸ºæ•°æ®åœ°å›¾ï¼Œé™¤äº†é‡‡é›†åˆ°å…ƒæ•°æ®ä»¥å¤–ï¼Œè¿˜è¦å¯¹å…ƒæ•°æ®è¿›è¡Œæ ¡æ­£ï¼Œå˜æ›´è®°å½•ï¼Œä½¿ç”¨è¯´æ˜ï¼Œç»Ÿè®¡ç­‰ã€‚  \nåœ¨é‡‡é›†è¡¨å­—æ®µç­‰å…ƒæ•°æ®æ—¶ï¼Œå¯¹å…ƒæ•°æ®çš„ä¿ç•™ä¸€ä»½å†å²ç‰ˆæœ¬ï¼Œå¯ä»¥åšå˜æ›´æŸ¥è¯¢ä¸æŠ¥è­¦ã€‚  \nåœ¨æ¥å£ä¸Šå®ç°å¯¹ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®çš„æ ¡æ­£å’Œä½¿ç”¨è¯´æ˜ã€‚  \nå®šæ—¶ç»Ÿè®¡å…ƒæ•°æ®ï¼Œå±•ç¤ºä¸€äº›å…ƒæ•°æ®çš„å…¨å±€æ•°æ®ï¼Œæ€»è®¡ï¼Œtopæ¦œç­‰ã€‚\n\nå¹³å°ç•Œé¢ä¸Šï¼Œé™¤äº†å¯¹ä¸Šè¿°æ‰€æœ‰å…ƒæ•°æ®çš„å±•ç¤ºï¼ŒåŒæ—¶ä¹Ÿæœ‰å„ç±»å…ƒæ•°æ®çš„ç»Ÿè®¡å’Œå›¾è¡¨å±•ç¤ºï¼Œè¿˜æœ‰å„ç±»çš„æ“ä½œå¯ä»¥æ“ä½œä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®ã€‚\n\n## å…ƒæ•°æ®åº”ç”¨\n\né™¤äº†å…ƒæ•°æ®å¹³å°ä¸Šçš„åŠŸèƒ½å¤–ï¼Œå…ƒæ•°æ®ä¹Ÿå¯ä»¥æœ‰å…¶ä»–å¾ˆå¤šçš„åº”ç”¨ã€‚\næ¯”å¦‚å…ƒæ•°æ®çš„æŒ‡æ ‡å»ºè®¾ï¼Œå°†å­—æ®µå…ƒæ•°æ®ä¸æŒ‡æ ‡è¿›è¡Œç»‘å®šï¼Œä»è€Œè®©å…ƒæ•°æ®æ›´è´´è¿‘ä¸šåŠ¡ï¼›\næ¯”å¦‚åœ¨æ§åˆ¶æ•°æ®æƒé™æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¡¨å­—æ®µçš„ç­–ç•¥ï¼›  \næ¯”å¦‚åœ¨å³æ—¶æŸ¥è¯¢æ—¶ç”¨æˆ·éœ€è¦æŸ¥çœ‹åº“è¡¨å­—æ®µä¿¡æ¯æ¥å®Œæˆsqlï¼›  \næ¯”å¦‚åœ¨æ•°æ®ç›‘æ§ä¸æ•°æ®è´¨é‡ä¸­ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å…ƒæ•°æ®ï¼›\n\n## å‚è€ƒå‹å†›\n- [æœ‰èµå…ƒæ•°æ®](https://tech.youzan.com/youzan-metadata/)\n- [é¥¿äº†ä¹ˆå…ƒæ•°æ®](https://dbaplus.cn/news-73-2143-1.html)\n- [çŸ¥ä¹ä¸€ä¸ªå…³äºå…ƒæ•°æ®çš„å›ç­”](https://www.zhihu.com/question/20679872/answer/54883263)","slug":"è®²è®²å…ƒæ•°æ®","published":1,"updated":"2020-04-01T07:33:04.580Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7x000jpb0jm516j23j","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>åšäº†ä¸€äº›å…ƒæ•°æ®çš„ç³»ç»Ÿï¼Œåˆ†äº«ä¸€äº›ç›¸å…³çš„ç†è§£ä¸ä½“ä¼šã€‚<br>\næºæ‚ä¸ªäººç†è§£ä¸å®æ“å†å²ï¼Œä¸ä¸€å®šæ˜¯æœ€ä½³å®è·µã€‚</p>\n<h2 id=\"å…ƒæ•°æ®å®šä¹‰\">å…ƒæ•°æ®å®šä¹‰</h2>\n<p>å…ƒæ•°æ®ä¸€èˆ¬æŒ‡çš„æ˜¯ <strong>å®šä¹‰æ•°æ®çš„æ•°æ®</strong>ã€‚</p>\n<p>å¯¹äºä¸€ä¸ªåç«¯ç³»ç»Ÿæˆ–è€…å¤§æ•°æ®é›†ç¾¤æ¥è¯´ï¼ŒåŸºæœ¬çš„å…ƒæ•°æ®å°±æ˜¯åœ¨æ‰§è¡Œddlæ—¶äº§ç”Ÿçš„å„ç§åº“è¡¨å­—æ®µç­‰ä¿¡æ¯ã€‚</p>\n<ul>\n<li>æ¯”å¦‚mysqlçš„æ¯ä¸ªå®ä¾‹ä¼šé»˜è®¤æœ‰ä¸€ä¸ªå«information_schemaçš„åº“ï¼›</li>\n<li>æ¯”å¦‚hiveåœ¨è¿è¡Œå‰éƒ½éœ€è¦é…ç½®ä¸€ä¸ªmetastoreåº“ï¼Œä¸€èˆ¬ä¸ºmysqlåº“ä¸”åœ¨æ‰§è¡Œå‰åˆå§‹åŒ–ï¼›</li>\n</ul>\n<p>è¿™é‡Œé¢éƒ½è®°å½•äº†å½“å‰å®ä¾‹æˆ–é›†ç¾¤çš„å¤§éƒ¨åˆ†åŸºç¡€å…ƒæ•°æ®ï¼Œä¸”åœ¨å…ƒæ•°æ®æ›´æ–°æ—¶å®æ—¶æ›´æ–°è¿™ä¸ªåº“ã€‚<br>\nå½“ç„¶è¿˜æœ‰ä¸€äº›å…ƒæ•°æ®æ¯”å¦‚æ•°æ®è¡€ç¼˜ï¼Œå…³è”å…³ç³»ï¼Œçƒ­åº¦ä¿¡æ¯ï¼Œä¸šåŠ¡å…ƒæ•°æ®ç­‰éœ€è¦ä¸€äº›å…¶ä»–æ‰‹æ®µè·å¾—ã€‚</p>\n<h2 id=\"å…ƒæ•°æ®é‡‡é›†\">å…ƒæ•°æ®é‡‡é›†</h2>\n<p>é¦–å…ˆè¿›è¡Œå…ƒæ•°æ®çš„é‡‡é›†å’Œæ•´åˆã€‚è¿™è¾¹éƒ½ä»¥hiveä¸¾ä¾‹ã€‚</p>\n<p>å¯èƒ½ä¼šæœ‰æƒ³æ³•å¦‚æœåªæ˜¯å±•ç¤ºçš„è¯å¯ä»¥ç›´æ¥è¿metastoreåº“ï¼Œæ²¡å¿…è¦å†é‡‡é›†åˆ°åç«¯ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæœ‰å»¶æ—¶ã€‚ä½†åæœŸä¸ä¸€å®šä¼šåœ¨ä¸€ä¸ªé›†ç¾¤ï¼Œè€Œä¸”åº“è¡¨å­—æ®µç­‰è¿˜è¦æœ‰å…¶ä»–çš„å„ç§å…³è”æ•°æ®ï¼Œç»Ÿè®¡æ•°æ®ï¼Œå› æ­¤é‡‡é›†åˆ°åç«¯æ˜¯æ¯”è¾ƒç¨³å¦¥çš„åšæ³•ã€‚</p>\n<ul>\n<li>å¯¹äºåº“ï¼Œè¡¨ï¼Œå­—æ®µï¼Œåˆ†åŒºç­‰ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨metastoreåº“è·å–ã€‚<br>\né‡‡å–å®šæ—¶åŒæ­¥çš„ç­–ç•¥ï¼ŒæŒ‰åº“æ¥åŒæ­¥ã€‚å› ä¸ºåŒæ­¥å…¨é‡æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œå¯ä»¥åˆ†ä¸¤ç§å®šæ—¶åŒæ­¥ï¼š<br>\nç¬¬ä¸€ç§ä¸ºè·å–è¡¨ååˆ—è¡¨å¯¹æ¯”å·²åŒæ­¥çš„è€è¡¨ï¼Œåªé‡‡é›†æ–°è¡¨ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå¿«ï¼›<br>\nç¬¬äºŒç§ä¸ºè·å–å…¨é‡çš„è¡¨å’Œå­—æ®µç»“æ„å¯¹æ¯”ï¼Œæ–°å¢çš„åšinsertï¼Œä¿®æ”¹çš„åšupdateï¼›<br>\nåŒæ—¶ä¹Ÿä¿ç•™ä¸€ç§æ‰‹åŠ¨è§¦å‘æ–¹å¼ï¼Œå¯ä»¥è®©ç”¨æˆ·æ‰‹åŠ¨åŒæ­¥åº“æˆ–è¡¨ã€‚</li>\n</ul>\n<ul>\n<li>å¯¹äºè¡€ç¼˜ï¼Œçƒ­åº¦ï¼Œå…³è”å…³ç³»ç­‰ä¿¡æ¯ï¼Œç›®å‰æ¯”è¾ƒç›´æ¥çš„æ˜¯ä½¿ç”¨hiveHookã€‚<br>\nè¡€ç¼˜hiveHookç›´æ¥æœ‰LineageLoggerç±»å¯ä»¥ä½¿ç”¨è·å–åˆ°è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜ã€‚(ä¸è¿‡è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œå°±ä¼šæ¯”è¾ƒéš¾äºæ’æŸ¥)ï¼›çƒ­åº¦éœ€è¦sqlè§£æå‡ºè¡¨åå’Œå­—æ®µåï¼Œå¯¹ç”¨åˆ°çš„éƒ½è¿›è¡Œç»Ÿè®¡ï¼›å…³è”å…³ç³»æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™ç”¨æˆ·å¯¹è¡¨æˆ–å­—æ®µè¿›è¡Œäº†å…³è”;æ‹¿åˆ°è¿™äº›æ•°æ®åå¯ä»¥ç›´æ¥æ”¾åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼Œç„¶åèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å­˜æ•°æ®å’Œæä¾›æ¥å£ã€‚<br>\nå¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡yarnï¼Œhookï¼Œç¦»çº¿ä»»åŠ¡ï¼Œå³æ—¶æŸ¥è¯¢ç­‰çš„æ¥æºé‡‡é›†åˆ°æ¯å¤©è¿è¡Œsqlï¼Œä½¿ç”¨sqlè§£ææ¯”å¦‚antlr4å’Œ<a href=\"https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4\" target=\"_blank\" rel=\"noopener\">hiveè‡ªå¸¦çš„Hplsql.g4</a>è§£æå‡ºä¸Šé¢è¿™äº›ä¿¡æ¯ï¼Œç›´æ¥å­˜å‚¨è‡³åç«¯ï¼Œè§£ææ–‡ä»¶å¯ä»¥è‡ªè¡Œåšä¼˜åŒ–ã€‚</li>\n</ul>\n<ul>\n<li>å¯¹äºä¸šåŠ¡å…ƒæ•°æ®ï¼Œæ¯”å¦‚è¡¨è´Ÿè´£äººï¼Œå±‚çº§åˆ’åˆ†ï¼Œä¸šåŠ¡åˆ’åˆ†ï¼Œæ‰“æ ‡ç­¾ç­‰ã€‚<br>\nå› ä¸ºè¡¨å­—æ®µç­‰ä¿¡æ¯æ˜¯ä»hiveåŒæ­¥æ¥çš„ï¼Œä¸”åˆ›è¡¨äººä¸€èˆ¬éƒ½ä¸ºç³»ç»Ÿè´¦å·ï¼Œå› æ­¤è¡¨è´Ÿè´£äººæ¥æºä¸€ä¸ªä¸ºä»ç¦»çº¿ä»»åŠ¡åŒæ­¥è€Œæ¥ï¼Œå¦ä¸€ä¸ªä¸ºä»å»ºæ¨¡å·¥å…·åŒæ­¥è€Œæ¥ã€‚<br>\nå±‚çº§åˆ’åˆ†ä¸šåŠ¡åˆ’åˆ†ä¸€èˆ¬æ˜¯æŒ‰åº“åæˆ–è¡¨åçš„è§„åˆ™å°±å¯ä»¥åŒºåˆ†å¼€ï¼Œåœ¨é‡‡é›†çš„æ—¶å€™å°±åŠ ä¸Šï¼ŒåæœŸæœ‰è¯¯çš„è¯éœ€è¦äººå·¥ç»´æŠ¤ã€‚<br>\nå…¶ä»–ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®é‡‡å–æ‰¹é‡å¯¼å‡ºå¯¼å…¥å’Œé¡µé¢ä¸Šç»´æŠ¤ã€‚</li>\n</ul>\n<h2 id=\"å…ƒæ•°æ®å¹³å°\">å…ƒæ•°æ®å¹³å°</h2>\n<p>å…ƒæ•°æ®å¹³å°ä¸€èˆ¬ä½œä¸ºæ•°æ®åœ°å›¾ï¼Œé™¤äº†é‡‡é›†åˆ°å…ƒæ•°æ®ä»¥å¤–ï¼Œè¿˜è¦å¯¹å…ƒæ•°æ®è¿›è¡Œæ ¡æ­£ï¼Œå˜æ›´è®°å½•ï¼Œä½¿ç”¨è¯´æ˜ï¼Œç»Ÿè®¡ç­‰ã€‚<br>\nåœ¨é‡‡é›†è¡¨å­—æ®µç­‰å…ƒæ•°æ®æ—¶ï¼Œå¯¹å…ƒæ•°æ®çš„ä¿ç•™ä¸€ä»½å†å²ç‰ˆæœ¬ï¼Œå¯ä»¥åšå˜æ›´æŸ¥è¯¢ä¸æŠ¥è­¦ã€‚<br>\nåœ¨æ¥å£ä¸Šå®ç°å¯¹ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®çš„æ ¡æ­£å’Œä½¿ç”¨è¯´æ˜ã€‚<br>\nå®šæ—¶ç»Ÿè®¡å…ƒæ•°æ®ï¼Œå±•ç¤ºä¸€äº›å…ƒæ•°æ®çš„å…¨å±€æ•°æ®ï¼Œæ€»è®¡ï¼Œtopæ¦œç­‰ã€‚</p>\n<p>å¹³å°ç•Œé¢ä¸Šï¼Œé™¤äº†å¯¹ä¸Šè¿°æ‰€æœ‰å…ƒæ•°æ®çš„å±•ç¤ºï¼ŒåŒæ—¶ä¹Ÿæœ‰å„ç±»å…ƒæ•°æ®çš„ç»Ÿè®¡å’Œå›¾è¡¨å±•ç¤ºï¼Œè¿˜æœ‰å„ç±»çš„æ“ä½œå¯ä»¥æ“ä½œä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®ã€‚</p>\n<h2 id=\"å…ƒæ•°æ®åº”ç”¨\">å…ƒæ•°æ®åº”ç”¨</h2>\n<p>é™¤äº†å…ƒæ•°æ®å¹³å°ä¸Šçš„åŠŸèƒ½å¤–ï¼Œå…ƒæ•°æ®ä¹Ÿå¯ä»¥æœ‰å…¶ä»–å¾ˆå¤šçš„åº”ç”¨ã€‚<br>\næ¯”å¦‚å…ƒæ•°æ®çš„æŒ‡æ ‡å»ºè®¾ï¼Œå°†å­—æ®µå…ƒæ•°æ®ä¸æŒ‡æ ‡è¿›è¡Œç»‘å®šï¼Œä»è€Œè®©å…ƒæ•°æ®æ›´è´´è¿‘ä¸šåŠ¡ï¼›<br>\næ¯”å¦‚åœ¨æ§åˆ¶æ•°æ®æƒé™æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¡¨å­—æ®µçš„ç­–ç•¥ï¼›<br>\næ¯”å¦‚åœ¨å³æ—¶æŸ¥è¯¢æ—¶ç”¨æˆ·éœ€è¦æŸ¥çœ‹åº“è¡¨å­—æ®µä¿¡æ¯æ¥å®Œæˆsqlï¼›<br>\næ¯”å¦‚åœ¨æ•°æ®ç›‘æ§ä¸æ•°æ®è´¨é‡ä¸­ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å…ƒæ•°æ®ï¼›</p>\n<h2 id=\"å‚è€ƒå‹å†›\">å‚è€ƒå‹å†›</h2>\n<ul>\n<li><a href=\"https://tech.youzan.com/youzan-metadata/\" target=\"_blank\" rel=\"noopener\">æœ‰èµå…ƒæ•°æ®</a></li>\n<li><a href=\"https://dbaplus.cn/news-73-2143-1.html\" target=\"_blank\" rel=\"noopener\">é¥¿äº†ä¹ˆå…ƒæ•°æ®</a></li>\n<li><a href=\"https://www.zhihu.com/question/20679872/answer/54883263\" target=\"_blank\" rel=\"noopener\">çŸ¥ä¹ä¸€ä¸ªå…³äºå…ƒæ•°æ®çš„å›ç­”</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2>å‰è¨€</h2>\n<p>åšäº†ä¸€äº›å…ƒæ•°æ®çš„ç³»ç»Ÿï¼Œåˆ†äº«ä¸€äº›ç›¸å…³çš„ç†è§£ä¸ä½“ä¼šã€‚<br>\næºæ‚ä¸ªäººç†è§£ä¸å®æ“å†å²ï¼Œä¸ä¸€å®šæ˜¯æœ€ä½³å®è·µã€‚</p>\n<h2>å…ƒæ•°æ®å®šä¹‰</h2>\n<p>å…ƒæ•°æ®ä¸€èˆ¬æŒ‡çš„æ˜¯ <strong>å®šä¹‰æ•°æ®çš„æ•°æ®</strong>ã€‚</p>\n<p>å¯¹äºä¸€ä¸ªåç«¯ç³»ç»Ÿæˆ–è€…å¤§æ•°æ®é›†ç¾¤æ¥è¯´ï¼ŒåŸºæœ¬çš„å…ƒæ•°æ®å°±æ˜¯åœ¨æ‰§è¡Œddlæ—¶äº§ç”Ÿçš„å„ç§åº“è¡¨å­—æ®µç­‰ä¿¡æ¯ã€‚</p>\n<ul>\n<li>æ¯”å¦‚mysqlçš„æ¯ä¸ªå®ä¾‹ä¼šé»˜è®¤æœ‰ä¸€ä¸ªå«information_schemaçš„åº“ï¼›</li>\n<li>æ¯”å¦‚hiveåœ¨è¿è¡Œå‰éƒ½éœ€è¦é…ç½®ä¸€ä¸ªmetastoreåº“ï¼Œä¸€èˆ¬ä¸ºmysqlåº“ä¸”åœ¨æ‰§è¡Œå‰åˆå§‹åŒ–ï¼›</li>\n</ul>\n<p>è¿™é‡Œé¢éƒ½è®°å½•äº†å½“å‰å®ä¾‹æˆ–é›†ç¾¤çš„å¤§éƒ¨åˆ†åŸºç¡€å…ƒæ•°æ®ï¼Œä¸”åœ¨å…ƒæ•°æ®æ›´æ–°æ—¶å®æ—¶æ›´æ–°è¿™ä¸ªåº“ã€‚<br>\nå½“ç„¶è¿˜æœ‰ä¸€äº›å…ƒæ•°æ®æ¯”å¦‚æ•°æ®è¡€ç¼˜ï¼Œå…³è”å…³ç³»ï¼Œçƒ­åº¦ä¿¡æ¯ï¼Œä¸šåŠ¡å…ƒæ•°æ®ç­‰éœ€è¦ä¸€äº›å…¶ä»–æ‰‹æ®µè·å¾—ã€‚</p>\n<h2>å…ƒæ•°æ®é‡‡é›†</h2>\n<p>é¦–å…ˆè¿›è¡Œå…ƒæ•°æ®çš„é‡‡é›†å’Œæ•´åˆã€‚è¿™è¾¹éƒ½ä»¥hiveä¸¾ä¾‹ã€‚</p>\n<p>å¯èƒ½ä¼šæœ‰æƒ³æ³•å¦‚æœåªæ˜¯å±•ç¤ºçš„è¯å¯ä»¥ç›´æ¥è¿metastoreåº“ï¼Œæ²¡å¿…è¦å†é‡‡é›†åˆ°åç«¯ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæœ‰å»¶æ—¶ã€‚ä½†åæœŸä¸ä¸€å®šä¼šåœ¨ä¸€ä¸ªé›†ç¾¤ï¼Œè€Œä¸”åº“è¡¨å­—æ®µç­‰è¿˜è¦æœ‰å…¶ä»–çš„å„ç§å…³è”æ•°æ®ï¼Œç»Ÿè®¡æ•°æ®ï¼Œå› æ­¤é‡‡é›†åˆ°åç«¯æ˜¯æ¯”è¾ƒç¨³å¦¥çš„åšæ³•ã€‚</p>\n<ul>\n<li>å¯¹äºåº“ï¼Œè¡¨ï¼Œå­—æ®µï¼Œåˆ†åŒºç­‰ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨metastoreåº“è·å–ã€‚<br>\né‡‡å–å®šæ—¶åŒæ­¥çš„ç­–ç•¥ï¼ŒæŒ‰åº“æ¥åŒæ­¥ã€‚å› ä¸ºåŒæ­¥å…¨é‡æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œå¯ä»¥åˆ†ä¸¤ç§å®šæ—¶åŒæ­¥ï¼š<br>\nç¬¬ä¸€ç§ä¸ºè·å–è¡¨ååˆ—è¡¨å¯¹æ¯”å·²åŒæ­¥çš„è€è¡¨ï¼Œåªé‡‡é›†æ–°è¡¨ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå¿«ï¼›<br>\nç¬¬äºŒç§ä¸ºè·å–å…¨é‡çš„è¡¨å’Œå­—æ®µç»“æ„å¯¹æ¯”ï¼Œæ–°å¢çš„åšinsertï¼Œä¿®æ”¹çš„åšupdateï¼›<br>\nåŒæ—¶ä¹Ÿä¿ç•™ä¸€ç§æ‰‹åŠ¨è§¦å‘æ–¹å¼ï¼Œå¯ä»¥è®©ç”¨æˆ·æ‰‹åŠ¨åŒæ­¥åº“æˆ–è¡¨ã€‚</li>\n</ul>\n<ul>\n<li>å¯¹äºè¡€ç¼˜ï¼Œçƒ­åº¦ï¼Œå…³è”å…³ç³»ç­‰ä¿¡æ¯ï¼Œç›®å‰æ¯”è¾ƒç›´æ¥çš„æ˜¯ä½¿ç”¨hiveHookã€‚<br>\nè¡€ç¼˜hiveHookç›´æ¥æœ‰LineageLoggerç±»å¯ä»¥ä½¿ç”¨è·å–åˆ°è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜ã€‚(ä¸è¿‡è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œå°±ä¼šæ¯”è¾ƒéš¾äºæ’æŸ¥)ï¼›çƒ­åº¦éœ€è¦sqlè§£æå‡ºè¡¨åå’Œå­—æ®µåï¼Œå¯¹ç”¨åˆ°çš„éƒ½è¿›è¡Œç»Ÿè®¡ï¼›å…³è”å…³ç³»æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™ç”¨æˆ·å¯¹è¡¨æˆ–å­—æ®µè¿›è¡Œäº†å…³è”;æ‹¿åˆ°è¿™äº›æ•°æ®åå¯ä»¥ç›´æ¥æ”¾åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—é‡Œï¼Œç„¶åèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å­˜æ•°æ®å’Œæä¾›æ¥å£ã€‚<br>\nå¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡yarnï¼Œhookï¼Œç¦»çº¿ä»»åŠ¡ï¼Œå³æ—¶æŸ¥è¯¢ç­‰çš„æ¥æºé‡‡é›†åˆ°æ¯å¤©è¿è¡Œsqlï¼Œä½¿ç”¨sqlè§£ææ¯”å¦‚antlr4å’Œ<a href=\"https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4\" target=\"_blank\" rel=\"noopener\">hiveè‡ªå¸¦çš„Hplsql.g4</a>è§£æå‡ºä¸Šé¢è¿™äº›ä¿¡æ¯ï¼Œç›´æ¥å­˜å‚¨è‡³åç«¯ï¼Œè§£ææ–‡ä»¶å¯ä»¥è‡ªè¡Œåšä¼˜åŒ–ã€‚</li>\n</ul>\n<ul>\n<li>å¯¹äºä¸šåŠ¡å…ƒæ•°æ®ï¼Œæ¯”å¦‚è¡¨è´Ÿè´£äººï¼Œå±‚çº§åˆ’åˆ†ï¼Œä¸šåŠ¡åˆ’åˆ†ï¼Œæ‰“æ ‡ç­¾ç­‰ã€‚<br>\nå› ä¸ºè¡¨å­—æ®µç­‰ä¿¡æ¯æ˜¯ä»hiveåŒæ­¥æ¥çš„ï¼Œä¸”åˆ›è¡¨äººä¸€èˆ¬éƒ½ä¸ºç³»ç»Ÿè´¦å·ï¼Œå› æ­¤è¡¨è´Ÿè´£äººæ¥æºä¸€ä¸ªä¸ºä»ç¦»çº¿ä»»åŠ¡åŒæ­¥è€Œæ¥ï¼Œå¦ä¸€ä¸ªä¸ºä»å»ºæ¨¡å·¥å…·åŒæ­¥è€Œæ¥ã€‚<br>\nå±‚çº§åˆ’åˆ†ä¸šåŠ¡åˆ’åˆ†ä¸€èˆ¬æ˜¯æŒ‰åº“åæˆ–è¡¨åçš„è§„åˆ™å°±å¯ä»¥åŒºåˆ†å¼€ï¼Œåœ¨é‡‡é›†çš„æ—¶å€™å°±åŠ ä¸Šï¼ŒåæœŸæœ‰è¯¯çš„è¯éœ€è¦äººå·¥ç»´æŠ¤ã€‚<br>\nå…¶ä»–ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®é‡‡å–æ‰¹é‡å¯¼å‡ºå¯¼å…¥å’Œé¡µé¢ä¸Šç»´æŠ¤ã€‚</li>\n</ul>\n<h2>å…ƒæ•°æ®å¹³å°</h2>\n<p>å…ƒæ•°æ®å¹³å°ä¸€èˆ¬ä½œä¸ºæ•°æ®åœ°å›¾ï¼Œé™¤äº†é‡‡é›†åˆ°å…ƒæ•°æ®ä»¥å¤–ï¼Œè¿˜è¦å¯¹å…ƒæ•°æ®è¿›è¡Œæ ¡æ­£ï¼Œå˜æ›´è®°å½•ï¼Œä½¿ç”¨è¯´æ˜ï¼Œç»Ÿè®¡ç­‰ã€‚<br>\nåœ¨é‡‡é›†è¡¨å­—æ®µç­‰å…ƒæ•°æ®æ—¶ï¼Œå¯¹å…ƒæ•°æ®çš„ä¿ç•™ä¸€ä»½å†å²ç‰ˆæœ¬ï¼Œå¯ä»¥åšå˜æ›´æŸ¥è¯¢ä¸æŠ¥è­¦ã€‚<br>\nåœ¨æ¥å£ä¸Šå®ç°å¯¹ä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®çš„æ ¡æ­£å’Œä½¿ç”¨è¯´æ˜ã€‚<br>\nå®šæ—¶ç»Ÿè®¡å…ƒæ•°æ®ï¼Œå±•ç¤ºä¸€äº›å…ƒæ•°æ®çš„å…¨å±€æ•°æ®ï¼Œæ€»è®¡ï¼Œtopæ¦œç­‰ã€‚</p>\n<p>å¹³å°ç•Œé¢ä¸Šï¼Œé™¤äº†å¯¹ä¸Šè¿°æ‰€æœ‰å…ƒæ•°æ®çš„å±•ç¤ºï¼ŒåŒæ—¶ä¹Ÿæœ‰å„ç±»å…ƒæ•°æ®çš„ç»Ÿè®¡å’Œå›¾è¡¨å±•ç¤ºï¼Œè¿˜æœ‰å„ç±»çš„æ“ä½œå¯ä»¥æ“ä½œä¸€äº›ä¸šåŠ¡å…ƒæ•°æ®ã€‚</p>\n<h2>å…ƒæ•°æ®åº”ç”¨</h2>\n<p>é™¤äº†å…ƒæ•°æ®å¹³å°ä¸Šçš„åŠŸèƒ½å¤–ï¼Œå…ƒæ•°æ®ä¹Ÿå¯ä»¥æœ‰å…¶ä»–å¾ˆå¤šçš„åº”ç”¨ã€‚<br>\næ¯”å¦‚å…ƒæ•°æ®çš„æŒ‡æ ‡å»ºè®¾ï¼Œå°†å­—æ®µå…ƒæ•°æ®ä¸æŒ‡æ ‡è¿›è¡Œç»‘å®šï¼Œä»è€Œè®©å…ƒæ•°æ®æ›´è´´è¿‘ä¸šåŠ¡ï¼›<br>\næ¯”å¦‚åœ¨æ§åˆ¶æ•°æ®æƒé™æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¡¨å­—æ®µçš„ç­–ç•¥ï¼›<br>\næ¯”å¦‚åœ¨å³æ—¶æŸ¥è¯¢æ—¶ç”¨æˆ·éœ€è¦æŸ¥çœ‹åº“è¡¨å­—æ®µä¿¡æ¯æ¥å®Œæˆsqlï¼›<br>\næ¯”å¦‚åœ¨æ•°æ®ç›‘æ§ä¸æ•°æ®è´¨é‡ä¸­ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å…ƒæ•°æ®ï¼›</p>\n<h2>å‚è€ƒå‹å†›</h2>\n<ul>\n<li><a href=\"https://tech.youzan.com/youzan-metadata/\" target=\"_blank\" rel=\"noopener\">æœ‰èµå…ƒæ•°æ®</a></li>\n<li><a href=\"https://dbaplus.cn/news-73-2143-1.html\" target=\"_blank\" rel=\"noopener\">é¥¿äº†ä¹ˆå…ƒæ•°æ®</a></li>\n<li><a href=\"https://www.zhihu.com/question/20679872/answer/54883263\" target=\"_blank\" rel=\"noopener\">çŸ¥ä¹ä¸€ä¸ªå…³äºå…ƒæ•°æ®çš„å›ç­”</a></li>\n</ul>\n"},{"title":"æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²[mac]","catalog":true,"date":"2000-03-31T08:27:54.000Z","subtitle":null,"header-img":null,"_content":"","source":"_posts/æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²-mac.md","raw":"---\ntitle: 'æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²[mac]'\ncatalog: true\ndate: 2000-03-31 16:27:54\nsubtitle:\nheader-img:\ntags:\n---\n","slug":"æœ¬åœ°hadoopä¸hiveçš„éƒ¨ç½²-mac","published":1,"updated":"2020-04-01T07:25:55.982Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck8ohfh7y000mpb0ju8bok1ag","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"åŸºäºantlr4å®ç°HQLçš„è§£æ[å…ƒæ•°æ®]","catalog":true,"date":"2020-04-07T07:24:40.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"\n## å‰è¨€\n\nåœ¨å¤§æ•°æ®åœºæ™¯ä¸­ï¼ŒHQLçš„ä½¿ç”¨æ¬¡æ•°å¾ˆå¤šï¼šç¦»çº¿ä»»åŠ¡ï¼ŒåŠæ—¶æŸ¥è¯¢ï¼Œæ•°ä»“å»ºæ¨¡ç­‰ã€‚ \n\nå…³äºHQLè§£æåœ¨hiveåº•å±‚ä¹Ÿæœ‰ä»–è‡ªå·±çš„HQLè§£æå®ç°ã€‚ä¸è¿‡åº•å±‚çš„å®ç°ç›´æ¥ç”¨ä¸èµ·æ¥ï¼Œè¿™è¾¹ä½¿ç”¨antlr4ç›´æ¥æ¥å®ç°HQLçš„è§£æã€‚\n\nHQLè§£æåœ¨å¾ˆå¤šåœºæ™¯èƒ½ç”¨åˆ°å¹¶å‘æŒ¥å¦‚è™æ·»ç¿¼çš„ä½œç”¨ï¼Œè¿™è¾¹å¼€ä¸ªæ–°å‘ï¼Œä¼šåˆ†å¥½å‡ ä¸ªæ–‡ç« æ¥è®²ä¸»è¦ç”¨åˆ°çš„ä¸€äº›åœºæ™¯å’Œå®ç°ã€‚  \n\næœ¬æ–‡ä¸»è¦è®²CREATEè¯­å¥è§£æå‡ºå…ƒæ•°æ®ã€‚ä¼šç”¨åˆ°çš„åœºæ™¯ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚å»ºæ¨¡çš„æ—¶å€™ï¼Œç¦»çº¿ä»»åŠ¡ä¸­çš„åˆ›è¡¨å’Œå…¶ä»–æœ‰ç”¨åˆ°ç±»ä¼¼å»ºè¡¨çš„åœ°æ–¹éƒ½å¯ä»¥è½¬æ¢ä¸ºHQLçš„äº¤äº’æ–¹å¼æ‹¿åˆ°æ•°æ®ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å¡«å†™è¡¨å•ã€‚\n\n## å‰æœŸå‡†å¤‡\n\n- antlr4å®‰è£…çœ‹[è¿™é‡Œå®˜æ–¹æ•™ç¨‹](https://www.antlr.org/) \n- ideaçš„æ’ä»¶ ANTLR v4 grammar plugin\n- sqlçš„è§£ææ–‡ä»¶ [Hplsql.g4](https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4)(è¿™ä¸ªæ–‡ä»¶å¤§éƒ¨åˆ†è§£æéƒ½æœ‰äº†ï¼Œä¸è¿‡è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„)\n\nèµ·ä¸ªjavaé¡¹ç›®ï¼ŒåŠ ä¸Šdependency antlr4-runtime å’Œ    \nplugin antlr4-maven-plugin(å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å°†g4\næ–‡ä»¶ç”Ÿæˆlexerå’Œparserç­‰æ–‡ä»¶)\n\n## å…·ä½“å®ç°\n\nantlr4æ”¯æŒä¸¤ç§æ ¼å¼listenerå’Œvisitoréå†æ¨¡å¼ã€‚ä¸¤ç§æ¨¡å¼çš„å…·ä½“ç”¨æ³•å’ŒåŒºåˆ«çœ‹[è¿™é‡Œ](https://abcdabcd987.com/notes-on-antlr4/)ã€‚  \nè¿™è¾¹ä»¥visitoræ¨¡å¼å®ç°ã€‚\n\n### g4åˆ†æ\n\nhplsql.g4æ–‡ä»¶ä¸­åˆ›è¡¨è¯­å¥ç›¸å…³çš„ä¸»è¦ä¸ºä¸‹é¢ä¸€äº›\n```\n// åˆ›è¡¨è¯­å¥å…¥å£ (create ... è¡¨å è¡¨æ¥æº)\ncreate_table_stmt :\n       T_CREATE (T_EXTERNAL)? T_TABLE (T_IF T_NOT T_EXISTS)? table_name create_table_definition\n     ;\n\n// åˆ›è¡¨æ¥æºï¼Œè¿™è¾¹ç”¨çš„æ˜¯æ˜¯å­—æ®µå’Œè¡¨å…¶ä»–é…ç½® \n// (... å­—æ®µ ... è¡¨é…ç½®)\ncreate_table_definition :\n      (T_AS? T_OPEN_P select_stmt T_CLOSE_P | T_AS? select_stmt | T_OPEN_P create_table_columns T_CLOSE_P | T_LIKE table_name) create_table_options?\n     ;\n\n// æ¯ä¸ªå­—æ®µ (å­—æ®µå ç±»å‹ é•¿åº¦ ... å¤‡æ³¨)\ncreate_table_columns_item :\n       column_name dtype dtype_len? dtype_attr* create_table_column_inline_cons* (T_COMMENT column_comment)?\n     | (T_CONSTRAINT ident)? create_table_column_cons\n     ;\n\n// è¡¨å…¶ä»–ç›¸å…³é…ç½® (å¤‡æ³¨ åˆ†åŒº è¡Œæ ¼å¼ å­˜å‚¨ç±»å‹ å­˜å‚¨\b\bä½ç½® è¡¨å±æ€§)\ncreate_table_options_hive_item :\n    (T_COMMENT string)?\n    create_table_hive_partitioned_by_clause?\n    create_table_hive_row_format?\n    create_table_hive_stored?\n    create_table_hive_location?\n    create_table_hive_tblproperties?\n     ;\n```\n\n### è¡¨å­—æ®µç›¸å…³å®šä¹‰\n\n``` java\npublic class HiveFieldMetadata {\n    /**\n     * å­—æ®µå\n     */\n    private String fieldName;\n\n    /**\n     * æ•°æ®ç±»å‹\n     */\n    private String dataType;\n\n    /**\n     * å­—æ®µå¤‡æ³¨\n     */\n    private String fieldComment;\n}\n```\n\nè¡¨ç›¸å…³å®šä¹‰\n\n``` java\npublic class HiveTableMetadata {\n    /**\n     * åº“å\n     */\n    private String dbName;\n\n    /**\n     * è¡¨å\n     */\n    private String tableName;\n\n    /**\n     * è¡¨ç±»å‹\n     */\n    private String tableType;\n\n    /**\n     * å¤‡æ³¨\n     */\n    private String tableComment;\n\n    /**\n     * åˆ†åŒº\n     */\n    private String partition;\n\n    /**\n     * è¡Œæ ¼å¼\n     */\n    private String rowFormat;\n\n    /**\n     * å­˜å‚¨æ ¼å¼\n     */\n    private String store;\n\n    /**\n     * å­˜å‚¨ä½ç½®\n     */\n    private String location;\n\n    /**\n     * å±æ€§(å‹ç¼©æ ¼å¼)\n     */\n    private String properties;\n\n    /**\n     * å­—æ®µ\n     */\n    private List<HiveFieldMetadata> fields;\n}\n```\n\n### æºç å®ç°è¯´æ˜\n\n``` java\npublic class HiveSQLTableMetadata extends HplsqlBaseVisitor {\n\n    private HiveTableMetadata tableMetadata = new HiveTableMetadata();\n\n    private String sourceSQL;\n\n    // ä¿å­˜åŸå§‹sql\n    public HiveSQLTableMetadata(String sql) {\n        this.sourceSQL = sql;\n    }\n\n    // æˆªå–åŸå§‹sql\n    private String subSourceSql(ParserRuleContext parserRuleContext) {\n        return sourceSQL.substring(\n                parserRuleContext.getStart().getStartIndex(),\n                parserRuleContext.getStop().getStopIndex() + 1);\n    }\n\n    // å¤„ç†å¤‡æ³¨ä¸­çš„å¼•å·\n    private String dealComment(String comment) {\n        if(comment != null && comment.length() >= 2\n                && comment.startsWith(\"\\'\") && comment.endsWith(\"\\'\")){\n            comment = comment.substring(1, comment.length()-1);\n        }\n        return comment;\n    }\n\n    // å¤„ç†è¡¨åå­—æ®µåä¸­çš„``\n    private String dealNameMark(String name) {\n        if(name.startsWith(\"`\") && name.endsWith(\"`\")) {\n            return name.substring(1, name.length()-1);\n        }else{\n            return name;\n        }\n    }\n\n    // è·å–åˆ°å­—æ®µä¿¡æ¯\n    private void setTableField(HplsqlParser.Create_table_stmtContext ctx) {\n        List<HplsqlParser.Create_table_columns_itemContext> itemContexts =\n                ctx.create_table_definition().create_table_columns().create_table_columns_item();\n        List<HiveFieldMetadata> fields = new ArrayList<>();\n        itemContexts.forEach(item -> {\n            HiveFieldMetadata field = new HiveFieldMetadata();\n            field.setFieldName(Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::column_name)\n                    .map(RuleContext::getText)\n                    .map(this::dealNameMark)\n                    .orElse(null));\n            String type = Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::dtype)\n                    .map(RuleContext::getText)\n                    .orElse(null);\n            String typeLen = Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::dtype_len)\n                    .map(RuleContext::getText)\n                    .orElse(\"\");\n            field.setDataType(type != null ? type + typeLen : null);\n            field.setFieldComment(Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::column_comment)\n                    .map(RuleContext::getText)\n                    .map(this::dealComment)\n                    .orElse(null));\n            fields.add(field);\n        });\n        tableMetadata.setFields(fields);\n    }\n\n    // è·å–è¡¨å…¶ä»–å±æ€§ä¿¡æ¯\n    private void setTableOption(HplsqlParser.Create_table_stmtContext ctx) {\n        HplsqlParser.Create_table_options_hive_itemContext tableOption =\n                ctx.create_table_definition().create_table_options().create_table_options_hive_item();\n        tableMetadata.setTableComment(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::string)\n                .map(RuleContext::getText)\n                .map(this::dealComment)\n                .orElse(null));\n        tableMetadata.setPartition(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_partitioned_by_clause)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setRowFormat(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_row_format)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setStore(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_stored)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setLocation(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_location)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setProperties(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_tblproperties)\n                .map(this::subSourceSql)\n                .orElse(null));\n    }\n\n    // æ‰§è¡Œå…¥å£ï¼Œé‡å†™visit createè¡¨\n    // è·å–åˆ°è¡¨ç›¸å…³ä¿¡æ¯\n    @Override\n    public Object visitCreate_table_stmt(HplsqlParser.Create_table_stmtContext ctx) {\n        List<ParseTree> tbNameTree = ctx.table_name().ident().children;\n        if(tbNameTree.size() == 3 && tbNameTree.get(1).getText().equals(\".\")) {\n            tableMetadata.setDbName(tbNameTree.get(0).getText());\n            tableMetadata.setTableName(dealNameMark(tbNameTree.get(2).getText()));\n        }else{\n            tableMetadata.setTableName(dealNameMark(tbNameTree.get(0).getText()));\n        }\n        tableMetadata.setTableType(Optional.of(ctx)\n                .map(HplsqlParser.Create_table_stmtContext::T_EXTERNAL)\n                .map(ParseTree::getText)\n                .orElse(null));\n        setTableField(ctx);\n        setTableOption(ctx);\n        return super.visitCreate_table_stmt(ctx);\n    }\n\n    // è·å–å…¨éƒ¨åˆ›è¡¨ä¿¡æ¯\n    public HiveTableMetadata getTableMetadata() {\n        return this.tableMetadata;\n    }\n\n}\n```\n\n### è°ƒç”¨å®ç°\n\n``` java\n// è·å–è§£ææ ‘\nprivate ParseTree getParseTree(String sourceSQL) {\n    CharStream input = CharStreams.fromString(sourceSQL);\n    HplsqlLexer lexer = new HplsqlLexer(input);\n    CommonTokenStream tokenStream = new CommonTokenStream(lexer);\n    HplsqlParser parser = new HplsqlParser(tokenStream);\n    return parser.program();\n}\n\n// è§£æ\npublic HiveTableMetadata getHiveTableMetadata() {\n    HiveSQLTableMetadata visitor = new HiveSQLTableMetadata(sourceSQL);\n    visitor.visit(getParseTree(sourceSQL));\n    return visitor.getTableMetadata();\n}\n```\n","source":"_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-å…ƒæ•°æ®.md","raw":"---\ntitle: 'åŸºäºantlr4å®ç°HQLçš„è§£æ[å…ƒæ•°æ®]'\ncatalog: true\ndate: 2020-04-07 15:24:40\nsubtitle: \nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- HQLè§£æ\n- å…ƒæ•°æ®\n- Java\n---\n\n## å‰è¨€\n\nåœ¨å¤§æ•°æ®åœºæ™¯ä¸­ï¼ŒHQLçš„ä½¿ç”¨æ¬¡æ•°å¾ˆå¤šï¼šç¦»çº¿ä»»åŠ¡ï¼ŒåŠæ—¶æŸ¥è¯¢ï¼Œæ•°ä»“å»ºæ¨¡ç­‰ã€‚ \n\nå…³äºHQLè§£æåœ¨hiveåº•å±‚ä¹Ÿæœ‰ä»–è‡ªå·±çš„HQLè§£æå®ç°ã€‚ä¸è¿‡åº•å±‚çš„å®ç°ç›´æ¥ç”¨ä¸èµ·æ¥ï¼Œè¿™è¾¹ä½¿ç”¨antlr4ç›´æ¥æ¥å®ç°HQLçš„è§£æã€‚\n\nHQLè§£æåœ¨å¾ˆå¤šåœºæ™¯èƒ½ç”¨åˆ°å¹¶å‘æŒ¥å¦‚è™æ·»ç¿¼çš„ä½œç”¨ï¼Œè¿™è¾¹å¼€ä¸ªæ–°å‘ï¼Œä¼šåˆ†å¥½å‡ ä¸ªæ–‡ç« æ¥è®²ä¸»è¦ç”¨åˆ°çš„ä¸€äº›åœºæ™¯å’Œå®ç°ã€‚  \n\næœ¬æ–‡ä¸»è¦è®²CREATEè¯­å¥è§£æå‡ºå…ƒæ•°æ®ã€‚ä¼šç”¨åˆ°çš„åœºæ™¯ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚å»ºæ¨¡çš„æ—¶å€™ï¼Œç¦»çº¿ä»»åŠ¡ä¸­çš„åˆ›è¡¨å’Œå…¶ä»–æœ‰ç”¨åˆ°ç±»ä¼¼å»ºè¡¨çš„åœ°æ–¹éƒ½å¯ä»¥è½¬æ¢ä¸ºHQLçš„äº¤äº’æ–¹å¼æ‹¿åˆ°æ•°æ®ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å¡«å†™è¡¨å•ã€‚\n\n## å‰æœŸå‡†å¤‡\n\n- antlr4å®‰è£…çœ‹[è¿™é‡Œå®˜æ–¹æ•™ç¨‹](https://www.antlr.org/) \n- ideaçš„æ’ä»¶ ANTLR v4 grammar plugin\n- sqlçš„è§£ææ–‡ä»¶ [Hplsql.g4](https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4)(è¿™ä¸ªæ–‡ä»¶å¤§éƒ¨åˆ†è§£æéƒ½æœ‰äº†ï¼Œä¸è¿‡è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„)\n\nèµ·ä¸ªjavaé¡¹ç›®ï¼ŒåŠ ä¸Šdependency antlr4-runtime å’Œ    \nplugin antlr4-maven-plugin(å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å°†g4\næ–‡ä»¶ç”Ÿæˆlexerå’Œparserç­‰æ–‡ä»¶)\n\n## å…·ä½“å®ç°\n\nantlr4æ”¯æŒä¸¤ç§æ ¼å¼listenerå’Œvisitoréå†æ¨¡å¼ã€‚ä¸¤ç§æ¨¡å¼çš„å…·ä½“ç”¨æ³•å’ŒåŒºåˆ«çœ‹[è¿™é‡Œ](https://abcdabcd987.com/notes-on-antlr4/)ã€‚  \nè¿™è¾¹ä»¥visitoræ¨¡å¼å®ç°ã€‚\n\n### g4åˆ†æ\n\nhplsql.g4æ–‡ä»¶ä¸­åˆ›è¡¨è¯­å¥ç›¸å…³çš„ä¸»è¦ä¸ºä¸‹é¢ä¸€äº›\n```\n// åˆ›è¡¨è¯­å¥å…¥å£ (create ... è¡¨å è¡¨æ¥æº)\ncreate_table_stmt :\n       T_CREATE (T_EXTERNAL)? T_TABLE (T_IF T_NOT T_EXISTS)? table_name create_table_definition\n     ;\n\n// åˆ›è¡¨æ¥æºï¼Œè¿™è¾¹ç”¨çš„æ˜¯æ˜¯å­—æ®µå’Œè¡¨å…¶ä»–é…ç½® \n// (... å­—æ®µ ... è¡¨é…ç½®)\ncreate_table_definition :\n      (T_AS? T_OPEN_P select_stmt T_CLOSE_P | T_AS? select_stmt | T_OPEN_P create_table_columns T_CLOSE_P | T_LIKE table_name) create_table_options?\n     ;\n\n// æ¯ä¸ªå­—æ®µ (å­—æ®µå ç±»å‹ é•¿åº¦ ... å¤‡æ³¨)\ncreate_table_columns_item :\n       column_name dtype dtype_len? dtype_attr* create_table_column_inline_cons* (T_COMMENT column_comment)?\n     | (T_CONSTRAINT ident)? create_table_column_cons\n     ;\n\n// è¡¨å…¶ä»–ç›¸å…³é…ç½® (å¤‡æ³¨ åˆ†åŒº è¡Œæ ¼å¼ å­˜å‚¨ç±»å‹ å­˜å‚¨\b\bä½ç½® è¡¨å±æ€§)\ncreate_table_options_hive_item :\n    (T_COMMENT string)?\n    create_table_hive_partitioned_by_clause?\n    create_table_hive_row_format?\n    create_table_hive_stored?\n    create_table_hive_location?\n    create_table_hive_tblproperties?\n     ;\n```\n\n### è¡¨å­—æ®µç›¸å…³å®šä¹‰\n\n``` java\npublic class HiveFieldMetadata {\n    /**\n     * å­—æ®µå\n     */\n    private String fieldName;\n\n    /**\n     * æ•°æ®ç±»å‹\n     */\n    private String dataType;\n\n    /**\n     * å­—æ®µå¤‡æ³¨\n     */\n    private String fieldComment;\n}\n```\n\nè¡¨ç›¸å…³å®šä¹‰\n\n``` java\npublic class HiveTableMetadata {\n    /**\n     * åº“å\n     */\n    private String dbName;\n\n    /**\n     * è¡¨å\n     */\n    private String tableName;\n\n    /**\n     * è¡¨ç±»å‹\n     */\n    private String tableType;\n\n    /**\n     * å¤‡æ³¨\n     */\n    private String tableComment;\n\n    /**\n     * åˆ†åŒº\n     */\n    private String partition;\n\n    /**\n     * è¡Œæ ¼å¼\n     */\n    private String rowFormat;\n\n    /**\n     * å­˜å‚¨æ ¼å¼\n     */\n    private String store;\n\n    /**\n     * å­˜å‚¨ä½ç½®\n     */\n    private String location;\n\n    /**\n     * å±æ€§(å‹ç¼©æ ¼å¼)\n     */\n    private String properties;\n\n    /**\n     * å­—æ®µ\n     */\n    private List<HiveFieldMetadata> fields;\n}\n```\n\n### æºç å®ç°è¯´æ˜\n\n``` java\npublic class HiveSQLTableMetadata extends HplsqlBaseVisitor {\n\n    private HiveTableMetadata tableMetadata = new HiveTableMetadata();\n\n    private String sourceSQL;\n\n    // ä¿å­˜åŸå§‹sql\n    public HiveSQLTableMetadata(String sql) {\n        this.sourceSQL = sql;\n    }\n\n    // æˆªå–åŸå§‹sql\n    private String subSourceSql(ParserRuleContext parserRuleContext) {\n        return sourceSQL.substring(\n                parserRuleContext.getStart().getStartIndex(),\n                parserRuleContext.getStop().getStopIndex() + 1);\n    }\n\n    // å¤„ç†å¤‡æ³¨ä¸­çš„å¼•å·\n    private String dealComment(String comment) {\n        if(comment != null && comment.length() >= 2\n                && comment.startsWith(\"\\'\") && comment.endsWith(\"\\'\")){\n            comment = comment.substring(1, comment.length()-1);\n        }\n        return comment;\n    }\n\n    // å¤„ç†è¡¨åå­—æ®µåä¸­çš„``\n    private String dealNameMark(String name) {\n        if(name.startsWith(\"`\") && name.endsWith(\"`\")) {\n            return name.substring(1, name.length()-1);\n        }else{\n            return name;\n        }\n    }\n\n    // è·å–åˆ°å­—æ®µä¿¡æ¯\n    private void setTableField(HplsqlParser.Create_table_stmtContext ctx) {\n        List<HplsqlParser.Create_table_columns_itemContext> itemContexts =\n                ctx.create_table_definition().create_table_columns().create_table_columns_item();\n        List<HiveFieldMetadata> fields = new ArrayList<>();\n        itemContexts.forEach(item -> {\n            HiveFieldMetadata field = new HiveFieldMetadata();\n            field.setFieldName(Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::column_name)\n                    .map(RuleContext::getText)\n                    .map(this::dealNameMark)\n                    .orElse(null));\n            String type = Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::dtype)\n                    .map(RuleContext::getText)\n                    .orElse(null);\n            String typeLen = Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::dtype_len)\n                    .map(RuleContext::getText)\n                    .orElse(\"\");\n            field.setDataType(type != null ? type + typeLen : null);\n            field.setFieldComment(Optional.of(item)\n                    .map(HplsqlParser.Create_table_columns_itemContext::column_comment)\n                    .map(RuleContext::getText)\n                    .map(this::dealComment)\n                    .orElse(null));\n            fields.add(field);\n        });\n        tableMetadata.setFields(fields);\n    }\n\n    // è·å–è¡¨å…¶ä»–å±æ€§ä¿¡æ¯\n    private void setTableOption(HplsqlParser.Create_table_stmtContext ctx) {\n        HplsqlParser.Create_table_options_hive_itemContext tableOption =\n                ctx.create_table_definition().create_table_options().create_table_options_hive_item();\n        tableMetadata.setTableComment(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::string)\n                .map(RuleContext::getText)\n                .map(this::dealComment)\n                .orElse(null));\n        tableMetadata.setPartition(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_partitioned_by_clause)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setRowFormat(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_row_format)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setStore(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_stored)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setLocation(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_location)\n                .map(this::subSourceSql)\n                .orElse(null));\n        tableMetadata.setProperties(Optional.ofNullable(tableOption)\n                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_tblproperties)\n                .map(this::subSourceSql)\n                .orElse(null));\n    }\n\n    // æ‰§è¡Œå…¥å£ï¼Œé‡å†™visit createè¡¨\n    // è·å–åˆ°è¡¨ç›¸å…³ä¿¡æ¯\n    @Override\n    public Object visitCreate_table_stmt(HplsqlParser.Create_table_stmtContext ctx) {\n        List<ParseTree> tbNameTree = ctx.table_name().ident().children;\n        if(tbNameTree.size() == 3 && tbNameTree.get(1).getText().equals(\".\")) {\n            tableMetadata.setDbName(tbNameTree.get(0).getText());\n            tableMetadata.setTableName(dealNameMark(tbNameTree.get(2).getText()));\n        }else{\n            tableMetadata.setTableName(dealNameMark(tbNameTree.get(0).getText()));\n        }\n        tableMetadata.setTableType(Optional.of(ctx)\n                .map(HplsqlParser.Create_table_stmtContext::T_EXTERNAL)\n                .map(ParseTree::getText)\n                .orElse(null));\n        setTableField(ctx);\n        setTableOption(ctx);\n        return super.visitCreate_table_stmt(ctx);\n    }\n\n    // è·å–å…¨éƒ¨åˆ›è¡¨ä¿¡æ¯\n    public HiveTableMetadata getTableMetadata() {\n        return this.tableMetadata;\n    }\n\n}\n```\n\n### è°ƒç”¨å®ç°\n\n``` java\n// è·å–è§£ææ ‘\nprivate ParseTree getParseTree(String sourceSQL) {\n    CharStream input = CharStreams.fromString(sourceSQL);\n    HplsqlLexer lexer = new HplsqlLexer(input);\n    CommonTokenStream tokenStream = new CommonTokenStream(lexer);\n    HplsqlParser parser = new HplsqlParser(tokenStream);\n    return parser.program();\n}\n\n// è§£æ\npublic HiveTableMetadata getHiveTableMetadata() {\n    HiveSQLTableMetadata visitor = new HiveSQLTableMetadata(sourceSQL);\n    visitor.visit(getParseTree(sourceSQL));\n    return visitor.getTableMetadata();\n}\n```\n","slug":"åŸºäºantlr4å®ç°HQLçš„è§£æ-å…ƒæ•°æ®","published":1,"updated":"2020-04-07T09:26:05.288Z","_id":"ck8ph5x270000qsso0jdnz51m","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>åœ¨å¤§æ•°æ®åœºæ™¯ä¸­ï¼ŒHQLçš„ä½¿ç”¨æ¬¡æ•°å¾ˆå¤šï¼šç¦»çº¿ä»»åŠ¡ï¼ŒåŠæ—¶æŸ¥è¯¢ï¼Œæ•°ä»“å»ºæ¨¡ç­‰ã€‚</p>\n<p>å…³äºHQLè§£æåœ¨hiveåº•å±‚ä¹Ÿæœ‰ä»–è‡ªå·±çš„HQLè§£æå®ç°ã€‚ä¸è¿‡åº•å±‚çš„å®ç°ç›´æ¥ç”¨ä¸èµ·æ¥ï¼Œè¿™è¾¹ä½¿ç”¨antlr4ç›´æ¥æ¥å®ç°HQLçš„è§£æã€‚</p>\n<p>HQLè§£æåœ¨å¾ˆå¤šåœºæ™¯èƒ½ç”¨åˆ°å¹¶å‘æŒ¥å¦‚è™æ·»ç¿¼çš„ä½œç”¨ï¼Œè¿™è¾¹å¼€ä¸ªæ–°å‘ï¼Œä¼šåˆ†å¥½å‡ ä¸ªæ–‡ç« æ¥è®²ä¸»è¦ç”¨åˆ°çš„ä¸€äº›åœºæ™¯å’Œå®ç°ã€‚</p>\n<p>æœ¬æ–‡ä¸»è¦è®²CREATEè¯­å¥è§£æå‡ºå…ƒæ•°æ®ã€‚ä¼šç”¨åˆ°çš„åœºæ™¯ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚å»ºæ¨¡çš„æ—¶å€™ï¼Œç¦»çº¿ä»»åŠ¡ä¸­çš„åˆ›è¡¨å’Œå…¶ä»–æœ‰ç”¨åˆ°ç±»ä¼¼å»ºè¡¨çš„åœ°æ–¹éƒ½å¯ä»¥è½¬æ¢ä¸ºHQLçš„äº¤äº’æ–¹å¼æ‹¿åˆ°æ•°æ®ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å¡«å†™è¡¨å•ã€‚</p>\n<h2 id=\"å‰æœŸå‡†å¤‡\">å‰æœŸå‡†å¤‡</h2>\n<ul>\n<li>antlr4å®‰è£…çœ‹<a href=\"https://www.antlr.org/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œå®˜æ–¹æ•™ç¨‹</a></li>\n<li>ideaçš„æ’ä»¶ ANTLR v4 grammar plugin</li>\n<li>sqlçš„è§£ææ–‡ä»¶ <a href=\"https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4\" target=\"_blank\" rel=\"noopener\">Hplsql.g4</a>(è¿™ä¸ªæ–‡ä»¶å¤§éƒ¨åˆ†è§£æéƒ½æœ‰äº†ï¼Œä¸è¿‡è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„)</li>\n</ul>\n<p>èµ·ä¸ªjavaé¡¹ç›®ï¼ŒåŠ ä¸Šdependency antlr4-runtime å’Œ<br>\nplugin antlr4-maven-plugin(å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å°†g4<br>\næ–‡ä»¶ç”Ÿæˆlexerå’Œparserç­‰æ–‡ä»¶)</p>\n<h2 id=\"å…·ä½“å®ç°\">å…·ä½“å®ç°</h2>\n<p>antlr4æ”¯æŒä¸¤ç§æ ¼å¼listenerå’Œvisitoréå†æ¨¡å¼ã€‚ä¸¤ç§æ¨¡å¼çš„å…·ä½“ç”¨æ³•å’ŒåŒºåˆ«çœ‹<a href=\"https://abcdabcd987.com/notes-on-antlr4/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>ã€‚<br>\nè¿™è¾¹ä»¥visitoræ¨¡å¼å®ç°ã€‚</p>\n<h3 id=\"g4åˆ†æ\">g4åˆ†æ</h3>\n<p>hplsql.g4æ–‡ä»¶ä¸­åˆ›è¡¨è¯­å¥ç›¸å…³çš„ä¸»è¦ä¸ºä¸‹é¢ä¸€äº›</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åˆ›è¡¨è¯­å¥å…¥å£ (create ... è¡¨å è¡¨æ¥æº)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_stmt </span>:</span><br><span class=\"line\">       T_CREATE (T_EXTERNAL)? T_TABLE (T_IF T_NOT T_EXISTS)? table_name create_table_definition</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ›è¡¨æ¥æºï¼Œè¿™è¾¹ç”¨çš„æ˜¯æ˜¯å­—æ®µå’Œè¡¨å…¶ä»–é…ç½® </span></span><br><span class=\"line\"><span class=\"comment\">// (... å­—æ®µ ... è¡¨é…ç½®)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_definition </span>:</span><br><span class=\"line\">      (T_AS? T_OPEN_P select_stmt T_CLOSE_P | T_AS? select_stmt | T_OPEN_P create_table_columns T_CLOSE_P | T_LIKE table_name) create_table_options?</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¯ä¸ªå­—æ®µ (å­—æ®µå ç±»å‹ é•¿åº¦ ... å¤‡æ³¨)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_columns_item </span>:</span><br><span class=\"line\">       column_name dtype dtype_len? dtype_attr* create_table_column_inline_cons* (T_COMMENT column_comment)?</span><br><span class=\"line\">     | (T_CONSTRAINT ident)? create_table_column_cons</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¡¨å…¶ä»–ç›¸å…³é…ç½® (å¤‡æ³¨ åˆ†åŒº è¡Œæ ¼å¼ å­˜å‚¨ç±»å‹ å­˜å‚¨\b\bä½ç½® è¡¨å±æ€§)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_options_hive_item </span>:</span><br><span class=\"line\">    (T_COMMENT string)?</span><br><span class=\"line\">    create_table_hive_partitioned_by_clause?</span><br><span class=\"line\">    create_table_hive_row_format?</span><br><span class=\"line\">    create_table_hive_stored?</span><br><span class=\"line\">    create_table_hive_location?</span><br><span class=\"line\">    create_table_hive_tblproperties?</span><br><span class=\"line\">     ;</span><br></pre></td></tr></table></figure>\n<h3 id=\"è¡¨å­—æ®µç›¸å…³å®šä¹‰\">è¡¨å­—æ®µç›¸å…³å®šä¹‰</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveFieldMetadata</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µå</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fieldName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String dataType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µå¤‡æ³¨</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fieldComment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¡¨ç›¸å…³å®šä¹‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveTableMetadata</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åº“å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String dbName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡¨å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡¨ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¤‡æ³¨</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableComment;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ†åŒº</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String partition;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡Œæ ¼å¼</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String rowFormat;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­˜å‚¨æ ¼å¼</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String store;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­˜å‚¨ä½ç½®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String location;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å±æ€§(å‹ç¼©æ ¼å¼)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String properties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;HiveFieldMetadata&gt; fields;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æºç å®ç°è¯´æ˜\">æºç å®ç°è¯´æ˜</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveSQLTableMetadata</span> <span class=\"keyword\">extends</span> <span class=\"title\">HplsqlBaseVisitor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> HiveTableMetadata tableMetadata = <span class=\"keyword\">new</span> HiveTableMetadata();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String sourceSQL;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜åŸå§‹sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">HiveSQLTableMetadata</span><span class=\"params\">(String sql)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.sourceSQL = sql;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æˆªå–åŸå§‹sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">subSourceSql</span><span class=\"params\">(ParserRuleContext parserRuleContext)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sourceSQL.substring(</span><br><span class=\"line\">                parserRuleContext.getStart().getStartIndex(),</span><br><span class=\"line\">                parserRuleContext.getStop().getStopIndex() + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†å¤‡æ³¨ä¸­çš„å¼•å·</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">dealComment</span><span class=\"params\">(String comment)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(comment != <span class=\"keyword\">null</span> &amp;&amp; comment.length() &gt;= <span class=\"number\">2</span></span><br><span class=\"line\">                &amp;&amp; comment.startsWith(<span class=\"string\">\"\\'\"</span>) &amp;&amp; comment.endsWith(<span class=\"string\">\"\\'\"</span>))&#123;</span><br><span class=\"line\">            comment = comment.substring(<span class=\"number\">1</span>, comment.length()-<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> comment;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†è¡¨åå­—æ®µåä¸­çš„``</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">dealNameMark</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(name.startsWith(<span class=\"string\">\"`\"</span>) &amp;&amp; name.endsWith(<span class=\"string\">\"`\"</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> name.substring(<span class=\"number\">1</span>, name.length()-<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–åˆ°å­—æ®µä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTableField</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;HplsqlParser.Create_table_columns_itemContext&gt; itemContexts =</span><br><span class=\"line\">                ctx.create_table_definition().create_table_columns().create_table_columns_item();</span><br><span class=\"line\">        List&lt;HiveFieldMetadata&gt; fields = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        itemContexts.forEach(item -&gt; &#123;</span><br><span class=\"line\">            HiveFieldMetadata field = <span class=\"keyword\">new</span> HiveFieldMetadata();</span><br><span class=\"line\">            field.setFieldName(Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::column_name)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .map(<span class=\"keyword\">this</span>::dealNameMark)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">            String type = Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::dtype)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">            String typeLen = Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::dtype_len)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .orElse(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            field.setDataType(type != <span class=\"keyword\">null</span> ? type + typeLen : <span class=\"keyword\">null</span>);</span><br><span class=\"line\">            field.setFieldComment(Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::column_comment)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .map(<span class=\"keyword\">this</span>::dealComment)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">            fields.add(field);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        tableMetadata.setFields(fields);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–è¡¨å…¶ä»–å±æ€§ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTableOption</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        HplsqlParser.Create_table_options_hive_itemContext tableOption =</span><br><span class=\"line\">                ctx.create_table_definition().create_table_options().create_table_options_hive_item();</span><br><span class=\"line\">        tableMetadata.setTableComment(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::string)</span><br><span class=\"line\">                .map(RuleContext::getText)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::dealComment)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setPartition(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_partitioned_by_clause)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setRowFormat(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_row_format)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setStore(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_stored)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setLocation(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_location)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setProperties(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_tblproperties)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œå…¥å£ï¼Œé‡å†™visit createè¡¨</span></span><br><span class=\"line\">    <span class=\"comment\">// è·å–åˆ°è¡¨ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">visitCreate_table_stmt</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;ParseTree&gt; tbNameTree = ctx.table_name().ident().children;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(tbNameTree.size() == <span class=\"number\">3</span> &amp;&amp; tbNameTree.get(<span class=\"number\">1</span>).getText().equals(<span class=\"string\">\".\"</span>)) &#123;</span><br><span class=\"line\">            tableMetadata.setDbName(tbNameTree.get(<span class=\"number\">0</span>).getText());</span><br><span class=\"line\">            tableMetadata.setTableName(dealNameMark(tbNameTree.get(<span class=\"number\">2</span>).getText()));</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            tableMetadata.setTableName(dealNameMark(tbNameTree.get(<span class=\"number\">0</span>).getText()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        tableMetadata.setTableType(Optional.of(ctx)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_stmtContext::T_EXTERNAL)</span><br><span class=\"line\">                .map(ParseTree::getText)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        setTableField(ctx);</span><br><span class=\"line\">        setTableOption(ctx);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.visitCreate_table_stmt(ctx);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å…¨éƒ¨åˆ›è¡¨ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> HiveTableMetadata <span class=\"title\">getTableMetadata</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.tableMetadata;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"è°ƒç”¨å®ç°\">è°ƒç”¨å®ç°</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è·å–è§£ææ ‘</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ParseTree <span class=\"title\">getParseTree</span><span class=\"params\">(String sourceSQL)</span> </span>&#123;</span><br><span class=\"line\">    CharStream input = CharStreams.fromString(sourceSQL);</span><br><span class=\"line\">    HplsqlLexer lexer = <span class=\"keyword\">new</span> HplsqlLexer(input);</span><br><span class=\"line\">    CommonTokenStream tokenStream = <span class=\"keyword\">new</span> CommonTokenStream(lexer);</span><br><span class=\"line\">    HplsqlParser parser = <span class=\"keyword\">new</span> HplsqlParser(tokenStream);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> parser.program();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è§£æ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> HiveTableMetadata <span class=\"title\">getHiveTableMetadata</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    HiveSQLTableMetadata visitor = <span class=\"keyword\">new</span> HiveSQLTableMetadata(sourceSQL);</span><br><span class=\"line\">    visitor.visit(getParseTree(sourceSQL));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> visitor.getTableMetadata();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2>å‰è¨€</h2>\n<p>åœ¨å¤§æ•°æ®åœºæ™¯ä¸­ï¼ŒHQLçš„ä½¿ç”¨æ¬¡æ•°å¾ˆå¤šï¼šç¦»çº¿ä»»åŠ¡ï¼ŒåŠæ—¶æŸ¥è¯¢ï¼Œæ•°ä»“å»ºæ¨¡ç­‰ã€‚</p>\n<p>å…³äºHQLè§£æåœ¨hiveåº•å±‚ä¹Ÿæœ‰ä»–è‡ªå·±çš„HQLè§£æå®ç°ã€‚ä¸è¿‡åº•å±‚çš„å®ç°ç›´æ¥ç”¨ä¸èµ·æ¥ï¼Œè¿™è¾¹ä½¿ç”¨antlr4ç›´æ¥æ¥å®ç°HQLçš„è§£æã€‚</p>\n<p>HQLè§£æåœ¨å¾ˆå¤šåœºæ™¯èƒ½ç”¨åˆ°å¹¶å‘æŒ¥å¦‚è™æ·»ç¿¼çš„ä½œç”¨ï¼Œè¿™è¾¹å¼€ä¸ªæ–°å‘ï¼Œä¼šåˆ†å¥½å‡ ä¸ªæ–‡ç« æ¥è®²ä¸»è¦ç”¨åˆ°çš„ä¸€äº›åœºæ™¯å’Œå®ç°ã€‚</p>\n<p>æœ¬æ–‡ä¸»è¦è®²CREATEè¯­å¥è§£æå‡ºå…ƒæ•°æ®ã€‚ä¼šç”¨åˆ°çš„åœºæ™¯ä¹Ÿå¾ˆå¤šï¼Œæ¯”å¦‚å»ºæ¨¡çš„æ—¶å€™ï¼Œç¦»çº¿ä»»åŠ¡ä¸­çš„åˆ›è¡¨å’Œå…¶ä»–æœ‰ç”¨åˆ°ç±»ä¼¼å»ºè¡¨çš„åœ°æ–¹éƒ½å¯ä»¥è½¬æ¢ä¸ºHQLçš„äº¤äº’æ–¹å¼æ‹¿åˆ°æ•°æ®ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„å¡«å†™è¡¨å•ã€‚</p>\n<h2>å‰æœŸå‡†å¤‡</h2>\n<ul>\n<li>antlr4å®‰è£…çœ‹<a href=\"https://www.antlr.org/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œå®˜æ–¹æ•™ç¨‹</a></li>\n<li>ideaçš„æ’ä»¶ ANTLR v4 grammar plugin</li>\n<li>sqlçš„è§£ææ–‡ä»¶ <a href=\"https://github.com/apache/hive/blob/master/hplsql/src/main/antlr4/org/apache/hive/hplsql/Hplsql.g4\" target=\"_blank\" rel=\"noopener\">Hplsql.g4</a>(è¿™ä¸ªæ–‡ä»¶å¤§éƒ¨åˆ†è§£æéƒ½æœ‰äº†ï¼Œä¸è¿‡è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„)</li>\n</ul>\n<p>èµ·ä¸ªjavaé¡¹ç›®ï¼ŒåŠ ä¸Šdependency antlr4-runtime å’Œ<br>\nplugin antlr4-maven-plugin(å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™å°†g4<br>\næ–‡ä»¶ç”Ÿæˆlexerå’Œparserç­‰æ–‡ä»¶)</p>\n<h2>å…·ä½“å®ç°</h2>\n<p>antlr4æ”¯æŒä¸¤ç§æ ¼å¼listenerå’Œvisitoréå†æ¨¡å¼ã€‚ä¸¤ç§æ¨¡å¼çš„å…·ä½“ç”¨æ³•å’ŒåŒºåˆ«çœ‹<a href=\"https://abcdabcd987.com/notes-on-antlr4/\" target=\"_blank\" rel=\"noopener\">è¿™é‡Œ</a>ã€‚<br>\nè¿™è¾¹ä»¥visitoræ¨¡å¼å®ç°ã€‚</p>\n<h3>g4åˆ†æ</h3>\n<p>hplsql.g4æ–‡ä»¶ä¸­åˆ›è¡¨è¯­å¥ç›¸å…³çš„ä¸»è¦ä¸ºä¸‹é¢ä¸€äº›</p>\n<figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// åˆ›è¡¨è¯­å¥å…¥å£ (create ... è¡¨å è¡¨æ¥æº)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_stmt </span>:</span><br><span class=\"line\">       T_CREATE (T_EXTERNAL)? T_TABLE (T_IF T_NOT T_EXISTS)? table_name create_table_definition</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åˆ›è¡¨æ¥æºï¼Œè¿™è¾¹ç”¨çš„æ˜¯æ˜¯å­—æ®µå’Œè¡¨å…¶ä»–é…ç½® </span></span><br><span class=\"line\"><span class=\"comment\">// (... å­—æ®µ ... è¡¨é…ç½®)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_definition </span>:</span><br><span class=\"line\">      (T_AS? T_OPEN_P select_stmt T_CLOSE_P | T_AS? select_stmt | T_OPEN_P create_table_columns T_CLOSE_P | T_LIKE table_name) create_table_options?</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æ¯ä¸ªå­—æ®µ (å­—æ®µå ç±»å‹ é•¿åº¦ ... å¤‡æ³¨)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_columns_item </span>:</span><br><span class=\"line\">       column_name dtype dtype_len? dtype_attr* create_table_column_inline_cons* (T_COMMENT column_comment)?</span><br><span class=\"line\">     | (T_CONSTRAINT ident)? create_table_column_cons</span><br><span class=\"line\">     ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¡¨å…¶ä»–ç›¸å…³é…ç½® (å¤‡æ³¨ åˆ†åŒº è¡Œæ ¼å¼ å­˜å‚¨ç±»å‹ å­˜å‚¨\b\bä½ç½® è¡¨å±æ€§)</span></span><br><span class=\"line\"><span class=\"attribute\">create_table_options_hive_item </span>:</span><br><span class=\"line\">    (T_COMMENT string)?</span><br><span class=\"line\">    create_table_hive_partitioned_by_clause?</span><br><span class=\"line\">    create_table_hive_row_format?</span><br><span class=\"line\">    create_table_hive_stored?</span><br><span class=\"line\">    create_table_hive_location?</span><br><span class=\"line\">    create_table_hive_tblproperties?</span><br><span class=\"line\">     ;</span><br></pre></td></tr></table></figure>\n<h3>è¡¨å­—æ®µç›¸å…³å®šä¹‰</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveFieldMetadata</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µå</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fieldName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ•°æ®ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String dataType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µå¤‡æ³¨</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fieldComment;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¡¨ç›¸å…³å®šä¹‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveTableMetadata</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åº“å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String dbName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡¨å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡¨ç±»å‹</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¤‡æ³¨</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tableComment;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ†åŒº</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String partition;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¡Œæ ¼å¼</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String rowFormat;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­˜å‚¨æ ¼å¼</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String store;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­˜å‚¨ä½ç½®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String location;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å±æ€§(å‹ç¼©æ ¼å¼)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String properties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å­—æ®µ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;HiveFieldMetadata&gt; fields;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3>æºç å®ç°è¯´æ˜</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HiveSQLTableMetadata</span> <span class=\"keyword\">extends</span> <span class=\"title\">HplsqlBaseVisitor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> HiveTableMetadata tableMetadata = <span class=\"keyword\">new</span> HiveTableMetadata();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String sourceSQL;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ä¿å­˜åŸå§‹sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">HiveSQLTableMetadata</span><span class=\"params\">(String sql)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.sourceSQL = sql;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æˆªå–åŸå§‹sql</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">subSourceSql</span><span class=\"params\">(ParserRuleContext parserRuleContext)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sourceSQL.substring(</span><br><span class=\"line\">                parserRuleContext.getStart().getStartIndex(),</span><br><span class=\"line\">                parserRuleContext.getStop().getStopIndex() + <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†å¤‡æ³¨ä¸­çš„å¼•å·</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">dealComment</span><span class=\"params\">(String comment)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(comment != <span class=\"keyword\">null</span> &amp;&amp; comment.length() &gt;= <span class=\"number\">2</span></span><br><span class=\"line\">                &amp;&amp; comment.startsWith(<span class=\"string\">\"\\'\"</span>) &amp;&amp; comment.endsWith(<span class=\"string\">\"\\'\"</span>))&#123;</span><br><span class=\"line\">            comment = comment.substring(<span class=\"number\">1</span>, comment.length()-<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> comment;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¤„ç†è¡¨åå­—æ®µåä¸­çš„``</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">dealNameMark</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(name.startsWith(<span class=\"string\">\"`\"</span>) &amp;&amp; name.endsWith(<span class=\"string\">\"`\"</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> name.substring(<span class=\"number\">1</span>, name.length()-<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–åˆ°å­—æ®µä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTableField</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;HplsqlParser.Create_table_columns_itemContext&gt; itemContexts =</span><br><span class=\"line\">                ctx.create_table_definition().create_table_columns().create_table_columns_item();</span><br><span class=\"line\">        List&lt;HiveFieldMetadata&gt; fields = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        itemContexts.forEach(item -&gt; &#123;</span><br><span class=\"line\">            HiveFieldMetadata field = <span class=\"keyword\">new</span> HiveFieldMetadata();</span><br><span class=\"line\">            field.setFieldName(Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::column_name)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .map(<span class=\"keyword\">this</span>::dealNameMark)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">            String type = Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::dtype)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">            String typeLen = Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::dtype_len)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .orElse(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            field.setDataType(type != <span class=\"keyword\">null</span> ? type + typeLen : <span class=\"keyword\">null</span>);</span><br><span class=\"line\">            field.setFieldComment(Optional.of(item)</span><br><span class=\"line\">                    .map(HplsqlParser.Create_table_columns_itemContext::column_comment)</span><br><span class=\"line\">                    .map(RuleContext::getText)</span><br><span class=\"line\">                    .map(<span class=\"keyword\">this</span>::dealComment)</span><br><span class=\"line\">                    .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">            fields.add(field);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        tableMetadata.setFields(fields);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–è¡¨å…¶ä»–å±æ€§ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setTableOption</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        HplsqlParser.Create_table_options_hive_itemContext tableOption =</span><br><span class=\"line\">                ctx.create_table_definition().create_table_options().create_table_options_hive_item();</span><br><span class=\"line\">        tableMetadata.setTableComment(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::string)</span><br><span class=\"line\">                .map(RuleContext::getText)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::dealComment)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setPartition(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_partitioned_by_clause)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setRowFormat(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_row_format)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setStore(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_stored)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setLocation(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_location)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        tableMetadata.setProperties(Optional.ofNullable(tableOption)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_options_hive_itemContext::create_table_hive_tblproperties)</span><br><span class=\"line\">                .map(<span class=\"keyword\">this</span>::subSourceSql)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œå…¥å£ï¼Œé‡å†™visit createè¡¨</span></span><br><span class=\"line\">    <span class=\"comment\">// è·å–åˆ°è¡¨ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">visitCreate_table_stmt</span><span class=\"params\">(HplsqlParser.Create_table_stmtContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;ParseTree&gt; tbNameTree = ctx.table_name().ident().children;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(tbNameTree.size() == <span class=\"number\">3</span> &amp;&amp; tbNameTree.get(<span class=\"number\">1</span>).getText().equals(<span class=\"string\">\".\"</span>)) &#123;</span><br><span class=\"line\">            tableMetadata.setDbName(tbNameTree.get(<span class=\"number\">0</span>).getText());</span><br><span class=\"line\">            tableMetadata.setTableName(dealNameMark(tbNameTree.get(<span class=\"number\">2</span>).getText()));</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            tableMetadata.setTableName(dealNameMark(tbNameTree.get(<span class=\"number\">0</span>).getText()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        tableMetadata.setTableType(Optional.of(ctx)</span><br><span class=\"line\">                .map(HplsqlParser.Create_table_stmtContext::T_EXTERNAL)</span><br><span class=\"line\">                .map(ParseTree::getText)</span><br><span class=\"line\">                .orElse(<span class=\"keyword\">null</span>));</span><br><span class=\"line\">        setTableField(ctx);</span><br><span class=\"line\">        setTableOption(ctx);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.visitCreate_table_stmt(ctx);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å…¨éƒ¨åˆ›è¡¨ä¿¡æ¯</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> HiveTableMetadata <span class=\"title\">getTableMetadata</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.tableMetadata;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3>è°ƒç”¨å®ç°</h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è·å–è§£ææ ‘</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> ParseTree <span class=\"title\">getParseTree</span><span class=\"params\">(String sourceSQL)</span> </span>&#123;</span><br><span class=\"line\">    CharStream input = CharStreams.fromString(sourceSQL);</span><br><span class=\"line\">    HplsqlLexer lexer = <span class=\"keyword\">new</span> HplsqlLexer(input);</span><br><span class=\"line\">    CommonTokenStream tokenStream = <span class=\"keyword\">new</span> CommonTokenStream(lexer);</span><br><span class=\"line\">    HplsqlParser parser = <span class=\"keyword\">new</span> HplsqlParser(tokenStream);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> parser.program();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è§£æ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> HiveTableMetadata <span class=\"title\">getHiveTableMetadata</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    HiveSQLTableMetadata visitor = <span class=\"keyword\">new</span> HiveSQLTableMetadata(sourceSQL);</span><br><span class=\"line\">    visitor.visit(getParseTree(sourceSQL));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> visitor.getTableMetadata();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"åŸºäºantlr4å®ç°HQLçš„è§£æ[æ ¼å¼åŒ–]","catalog":true,"date":"2000-03-31T08:24:56.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"","source":"_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-æ ¼å¼åŒ–.md","raw":"---\ntitle: 'åŸºäºantlr4å®ç°HQLçš„è§£æ[æ ¼å¼åŒ–]'\ncatalog: true\ndate: 2000-03-31 16:24:56\nsubtitle:\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- HQLè§£æ\n- Java\n---\n","slug":"åŸºäºantlr4å®ç°HQLçš„è§£æ-æ ¼å¼åŒ–","published":1,"updated":"2020-04-07T09:26:37.840Z","_id":"ck8pp8ua2000eqssohgbsuude","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"åŸºäºantlr4å®ç°hiveSQLçš„è§£æ[è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜]","catalog":true,"date":"2000-03-31T08:25:06.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"","source":"_posts/åŸºäºantlr4å®ç°HQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜.md","raw":"---\ntitle: 'åŸºäºantlr4å®ç°hiveSQLçš„è§£æ[è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜]'\ncatalog: true\ndate: 2000-03-31 16:25:06\nsubtitle:\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- HQLè§£æ\n---\n","slug":"åŸºäºantlr4å®ç°HQLçš„è§£æ-è¡¨è¡€ç¼˜å’Œå­—æ®µè¡€ç¼˜","published":1,"updated":"2020-04-07T09:26:47.419Z","_id":"ck8pp91pa000hqssodlnmdx1y","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"hiveserver2ä¸hiveSQLçš„æ‰§è¡Œ","catalog":true,"date":"2000-03-31T08:28:17.000Z","subtitle":null,"header-img":"/img/article_header/header.jpg","_content":"","source":"_posts/hiveserver2ä¸HQLçš„æ‰§è¡Œ.md","raw":"---\ntitle: hiveserver2ä¸hiveSQLçš„æ‰§è¡Œ\ncatalog: true\ndate: 2000-03-31 16:28:17\nsubtitle:\nheader-img: \"/img/article_header/header.jpg\"\ntags:\n- \n---\n","slug":"hiveserver2ä¸HQLçš„æ‰§è¡Œ","published":1,"updated":"2020-04-07T09:26:57.153Z","_id":"ck8pp9894000jqssox7k0g4hr","comments":1,"layout":"post","photos":[],"link":"","content":"","site":{"data":{}},"excerpt":"","more":""}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"ck8ohfh7e0007pb0jlnx9ufqa","tag_id":"ck8ohfh7j0009pb0j7v6axoyj","_id":"ck8ohfh7w000ipb0jnvtm3o99"},{"post_id":"ck8ohfh7e0007pb0jlnx9ufqa","tag_id":"ck8ohfh7t000dpb0jlnsgzoho","_id":"ck8ohfh7x000kpb0j0l4baf2i"},{"post_id":"ck8ohfh7w000hpb0j09gnep9k","tag_id":"ck8ohfh7v000gpb0j2v150vut","_id":"ck8ohfh7z000npb0j4u33jqa3"},{"post_id":"ck8ohfh7h0008pb0jhn6nijgg","tag_id":"ck8ohfh7v000gpb0j2v150vut","_id":"ck8ohfh7z000opb0ji1s9a4rr"},{"post_id":"ck8ohfh7s000cpb0j1k6imkye","tag_id":"ck8ohfh7y000lpb0jbx7j2ydu","_id":"ck8ohfh81000spb0jvtkja33j"},{"post_id":"ck8ohfh7s000cpb0j1k6imkye","tag_id":"ck8ohfh7z000ppb0jpw2zxmwt","_id":"ck8ohfh81000tpb0ja2bwepd7"},{"post_id":"ck8ohfh7s000cpb0j1k6imkye","tag_id":"ck8ohfh80000qpb0jl2jtr2oy","_id":"ck8ohfh82000vpb0jknjzyxmf"},{"post_id":"ck8ohfh7x000jpb0jm516j23j","tag_id":"ck8ohfh7y000lpb0jbx7j2ydu","_id":"ck8ohfh82000wpb0j21hv2oui"},{"post_id":"ck8ohfh7x000jpb0jm516j23j","tag_id":"ck8ohfh7z000ppb0jpw2zxmwt","_id":"ck8ohfh82000xpb0jscwe5myi"},{"post_id":"ck8ph5x270000qsso0jdnz51m","tag_id":"ck8ohfh7y000lpb0jbx7j2ydu","_id":"ck8ph71gr0002qsso7kukljjj"},{"post_id":"ck8ph5x270000qsso0jdnz51m","tag_id":"ck8pl393x0005qsso0aw40484","_id":"ck8pl393y0006qssohwh2l5bt"},{"post_id":"ck8ph5x270000qsso0jdnz51m","tag_id":"ck8pod83f0009qssojaddkc0m","_id":"ck8pod83g000aqsson0ydkkfq"},{"post_id":"ck8pp8ua2000eqssohgbsuude","tag_id":"ck8pl393x0005qsso0aw40484","_id":"ck8pp8ua3000fqssoofl8yb46"},{"post_id":"ck8pp8ua2000eqssohgbsuude","tag_id":"ck8pod83f0009qssojaddkc0m","_id":"ck8pp8ua3000gqssohhir09rp"},{"post_id":"ck8pp91pa000hqssodlnmdx1y","tag_id":"ck8pl393x0005qsso0aw40484","_id":"ck8pp91pb000iqsso2d0qhb3a"}],"Tag":[{"name":"Python","_id":"ck8ohfh7j0009pb0j7v6axoyj"},{"name":"è„šæœ¬","_id":"ck8ohfh7t000dpb0jlnsgzoho"},{"name":"Other","_id":"ck8ohfh7v000gpb0j2v150vut"},{"name":"å…ƒæ•°æ®","_id":"ck8ohfh7y000lpb0jbx7j2ydu"},{"name":"å¤§æ•°æ®","_id":"ck8ohfh7z000ppb0jpw2zxmwt"},{"name":"Mysql","_id":"ck8ohfh80000qpb0jl2jtr2oy"},{"name":"SQLè§£æ","_id":"ck8ph77x30003qssohnhc0zxa"},{"name":"HQLè§£æ","_id":"ck8pl393x0005qsso0aw40484"},{"name":"java","_id":"ck8pm6nyl0007qssoyenhcciw"},{"name":"Java","_id":"ck8pod83f0009qssojaddkc0m"}]}}